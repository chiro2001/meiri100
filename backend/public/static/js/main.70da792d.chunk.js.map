{"version":3,"sources":["utils/utils.js","data/action.js","api/api.js","Config.js","data/reducers.js","data/store.js","components/ListItemLink.js","pages/RemoteLogin.js","pages/Manage.js","components/LogsList.js","pages/Launch.js","components/ListInfo.js","pages/Settings.js","pages/Login.js","ErrorBondary.js","App.js","reportWebVitals.js","index.js"],"names":["parseTimePoint","time","moment","format","sleep","time_ms","Promise","accept","setTimeout","isIterator","obj","Symbol","iterator","deepCopy","data","undefined","d","i","length","push","k","objectUpdate","origin","update","now","Date","prototype","setDay","day","day_","this","getDay","setTime","getTime","toDateString","toISOString","slice","setConfig","dispatch","type","setUser","setDaemon","setErrorInfo","setMessage","api","host","window","location","href","includes","port","api_version","api_prefix","protocol","url","access_token","refresh_token","router","key","method","request","config","store","getState","api_token","get_token","console","log","set_token","refresh","access","headers","a","payload","mode","body","JSON","stringify","get_headers","Boolean","resp","fetch","error","status","code","statusText","js","json","message","resp2","js2","update_config","res","user","save","ITEM_NAME","Config","load","bind","theme_avaliable","createMuiTheme","palette","primary","main","teal","secondary","green","blueGrey","grey","data_default","debug","version_frontend","theme_name","settings_async","enable_email","theme","parse","localStorage","getItem","Error","e","warn","s","setItem","defaultState","account","daemon","errorInfo","types","combineReducers","state","action","createStore","reducers","applyMiddleware","thunk","updated","ListItemLink","props","icon","to","onClick","renderLink","React","useMemo","forwardRef","itemProps","ref","document","title","ListItem","button","component","ListItemIcon","ListItemText","require","CenterBox","children","style","Box","width","height","display","justifyContent","flexDirection","textAlign","alignItems","RemoteLogin","onFinish","forceLogin","stateDefault","loginDone","loginError","username","password","refUsername","createRef","refPassword","handleAction","setState","content","Paper","Typography","variant","Button","color","TextField","fullWidth","label","value","onChange","target","onKeyDown","current","querySelector","focus","Container","maxWidth","Component","AccountTag","onRefresh","enabled","created_at","ListItemSecondaryAction","IconButton","Manage","useState","requestingAccounts","dialogAddAccountOpen","dialogSetAccountOpen","addMode","setInnerState","accounts","useReducer","x","forceUpdate","then","List","map","LinearProgress","Grid","container","spacing","item","lg","sm","ListSubheader","disabled","Dialog","open","onClose","DialogTitle","DialogContent","DialogActions","autoFocus","LogsList","levels","调试","信息","警告","错误","致命错误","colors","10","20","30","40","50","level","limit","offset","requested","logs","text","Select","Object","keys","MenuItem","size","maxHeight","overflow","StateNow","fetched_task","unsubscribe","subscribe","enabled_count","Table","TableBody","TableRow","TableCell","align","Launch","Divider","ListInfo","keyNames","openChild","setOpenChild","child","setChild","childTitle","setChildTitle","v","showName","Settings","themeName","setThemeName","useRef","resetSettingsOpen","setResetSettingsOpen","openUser","setOpenUser","openVipCode","setOpenVipCode","usernameVipCode","setUsernameVipCode","emailOpen","setEmailOpen","profile","contact","email","setEmail","Checkbox","checked","clear","reload","FormControl","c","uid","nick","phone","updated_at","resetSettings","vip_code","LoginFrame","actionType","refEmail","refVipCode","actionLogin","Fade","in","timeout","exit","enter","Login","ErrorBoundary","requesting","info","hash","drawerWidth","locale","useStyles","makeStyles","root","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","flexGrow","appBarShift","marginLeft","enteringScreen","menuButton","marginRight","hide","flexShrink","whiteSpace","drawerOpen","drawerClose","overflowX","breakpoints","up","toolbar","padding","mixins","subscribers","last_data","subFunc","App","classes","useTheme","setOpen","errorDialogInfo","setErrorDialogInfo","myMessage","setMyMessage","useEffect","onWindowResize","innerWidth","addEventListener","removeEventListener","mainContent","utils","MomentUtils","CssBaseline","AppBar","position","className","clsx","Toolbar","aria-label","edge","noWrap","Drawer","paper","direction","pathname","path","exact","ThemeProvider","toString","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","Fragment","fontSize","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","cycle","load_from_config","ReactDOM","render","getElementById","startFunc","cycleFunc"],"mappings":"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","file":"static/js/main.70da792d.chunk.js","sourcesContent":["import moment from 'moment';\r\nimport 'moment/locale/zh-cn'\r\n\r\nexport function isMobileDevice() {\r\n  const sUserAgent = navigator.userAgent;\r\n  return (sUserAgent.indexOf('Android') > -1 || sUserAgent.indexOf('iPhone') > -1 || sUserAgent.indexOf('iPad') > -1 || sUserAgent.indexOf('iPod') > -1 || sUserAgent.indexOf('Symbian') > -1);\r\n}\r\n\r\n/** \r\n* param 将要转为URL参数字符串的对象 \r\n* key URL参数字符串的前缀 \r\n* encode true/false 是否进行URL编码,默认为true \r\n*  \r\n* return URL参数字符串 \r\n*/\r\nexport function urlEncode(param, key, encode) {\r\n  if (param == null) return '';\r\n  var paramStr = '';\r\n  var t = typeof (param);\r\n  if (t === 'string' || t === 'number' || t === 'boolean') {\r\n    paramStr += '&' + key + '=' + ((encode == null || encode) ? encodeURIComponent(param) : param);\r\n  } else {\r\n    for (var i in param) {\r\n      var k = key == null ? i : key + (param instanceof Array ? '[' + i + ']' : '.' + i);\r\n      paramStr += urlEncode(param[i], k, encode);\r\n    }\r\n  }\r\n  return paramStr;\r\n};\r\n\r\nexport function urlEncode2(obj) {\r\n  try {\r\n    return JSON.stringify(obj).replace(/:/g, \"=\").replace(/\"/g, '').replace(/,/g, '&').match(/\\{([^)]*)\\}/)[1];\r\n  } catch (e) {\r\n    console.error(e);\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport function parseTimePoint(time) {\r\n  return moment(time).format('LLLL');\r\n}\r\n\r\nexport function parseTimePeriod(time) {\r\n  return moment.duration(time).humanize();\r\n}\r\n\r\nexport function getTextFieldValue(el) {\r\n  return el.current.childNodes[el.current.childElementCount - 1].childNodes[0].value;\r\n}\r\n\r\nexport function sleep(time_ms) {\r\n  return new Promise(accept => {\r\n    setTimeout(accept, time_ms);\r\n  });\r\n}\r\n\r\n// 设置到本周的星期几\r\nDate.prototype.setDay = function (day) {\r\n  let day_ = this.getDay();\r\n  if (day_ === day) return this;\r\n  this.setTime(this.getTime() + 1000 * 60 * 60 * 24 * (day - day_));\r\n  return this;\r\n};\r\n\r\n// 获取 YYYY-MM-DD 格式\r\nDate.prototype.toDateString = function () {\r\n  return this.toISOString().slice(0, 10);\r\n};\r\n\r\n// export function cutString(str, length=10)\r\n\r\nexport function isIterator(obj) {\r\n  return obj != null && typeof obj[Symbol.iterator] === 'function';\r\n}\r\n\r\n// 下载文件方法\r\nexport function funDownload(content, filename) {\r\n  var eleLink = document.createElement('a');\r\n  eleLink.download = filename;\r\n  eleLink.style.display = 'none';\r\n  // 字符内容转变成blob地址\r\n  var blob = new Blob([content]);\r\n  eleLink.href = URL.createObjectURL(blob);\r\n  // 触发点击\r\n  document.body.appendChild(eleLink);\r\n  eleLink.click();\r\n  // 然后移除\r\n  document.body.removeChild(eleLink);\r\n};\r\n\r\n\r\nexport function deepCopy(data) {\r\n  if (data === null || data === undefined) {\r\n    return data;\r\n  } if (isIterator(data) && typeof (data) !== \"string\") {\r\n    let d = [];\r\n    for (let i = 0; i < data.length; i++) {\r\n      d.push(data[i]);\r\n    }\r\n    return d;\r\n  } else if (typeof (data) === \"object\") {\r\n    let d = {};\r\n    for (const k in data) {\r\n      d[k] = deepCopy(data[k]);\r\n    }\r\n    return d;\r\n  } else {\r\n    return data;\r\n  }\r\n}\r\n\r\nexport function objectUpdate(origin, update) {\r\n  if (!origin && !update) return null;\r\n  let now = deepCopy(origin);\r\n  if (!now) now = {};\r\n  for (const k in update) {\r\n    now[k] = update[k];\r\n  }\r\n  return now;\r\n}\r\n\r\n// https://www.jianshu.com/p/7407bd65b15d\r\nexport function isObjectValueEqual(a, b) {\r\n  var aProps = Object.getOwnPropertyNames(a);\r\n  var bProps = Object.getOwnPropertyNames(b);\r\n  if (aProps.length !== bProps.length) {\r\n    return false;\r\n  }\r\n  for (var i = 0; i < aProps.length; i++) {\r\n    var propName = aProps[i]\r\n\r\n    var propA = a[propName]\r\n    var propB = b[propName]\r\n    // 2020-11-18更新，这里忽略了值为undefined的情况\r\n    // 故先判断两边都有相同键名\r\n    if (!b.hasOwnProperty(propName)) return false\r\n    if ((propA instanceof Object)) {\r\n      if (isObjectValueEqual(propA, propB)) {\r\n        // return true     这里不能return ,后面的对象还没判断\r\n      } else {\r\n        return false\r\n      }\r\n    } else if (propA !== propB) {\r\n      return false\r\n    } else { }\r\n  }\r\n  return true\r\n}\r\n\r\n// Array.prototype.indexOf = function (val) {\r\n//   for (var i = 0; i < this.length; i++) {\r\n//     if (this[i] == val) return i;\r\n//   }\r\n//   return -1;\r\n// };\r\n\r\n// Array.prototype.remove = function (val) {\r\n//   var index = this.indexOf(val);\r\n//   if (index > -1) {\r\n//     this.splice(index, 1);\r\n//   }\r\n// };\r\n\r\n// Array.prototype.removeIndex = function (index) {\r\n//   this.splice(index, 1);\r\n// };\r\n\r\n// export function arrayRemove(array, data) {\r\n//   if (!isIterator(array)) return;\r\n//   const index = array.indexOf(data);\r\n//   if (index > -1) {\r\n//     array.slice(index, 1);\r\n//   }\r\n// }\r\n\r\nexport const timedeltaUnits = {\r\n  \"秒\": 1, \"分\": 60, \"时\": 60 * 60,\r\n  \"天\": 24 * 60 * 60, \"周\": 7 * 24 * 60 * 60\r\n};\r\n\r\n\r\nexport function getTimedeltaUnit(timedelta) {\r\n  if (typeof (timedelta) !== 'number') return null;\r\n  if (timedelta >= timedeltaUnits[Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1]])\r\n    return Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1];\r\n  for (let i = 1; i < Object.keys(timedeltaUnits).length; i++) {\r\n    if (timedelta < timedeltaUnits[Object.keys(timedeltaUnits)[i]]) {\r\n      return Object.keys(timedeltaUnits)[i - 1];\r\n    }\r\n  }\r\n  return Object.keys(timedeltaUnits)[0];\r\n}\r\n\r\nexport function getTimedeltaString(timedelta) {\r\n  if (typeof (timedelta) !== 'number') return \"\";\r\n  const unit = getTimedeltaUnit(timedelta);\r\n  if (unit === null) return \"\";\r\n  // console.log(\"unit\", unit);\r\n  return `${(timedelta / timedeltaUnits[unit]).toFixed(2)}${unit}`;\r\n}\r\n\r\nexport const weekDayList = ['日', '一', '二', '三', '四', '五', '六'];\r\n\r\nexport function isChinese(temp) {\r\n  var re = /[^\\u4E00-\\u9FA5]/;\r\n  if (re.test(temp)) return false;\r\n  return true;\r\n}\r\n\r\n\r\nexport function getNewNumberString(value) {\r\n  const newValue = value.length === 0 ? 0 : parseFloat(value);\r\n  if (isNaN(newValue)) return null;\r\n  return newValue;\r\n}\r\n\r\nexport function formatDateTime(value) {\r\n  return moment(value).format(\"YYYY-MM-DDTHH:mm:ss.SSSSSS+08:00\");\r\n}","import { objectUpdate } from \"../utils/utils\";\r\nimport store from \"./store\";\r\n\r\nexport function setConfig(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_CONFIG\", data: data });\r\n  };\r\n}\r\n\r\nexport function setAccounts(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_ACCOUNTS\", data: data });\r\n  };\r\n}\r\n\r\nexport function setUser(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_USER\", data: data });\r\n  };\r\n}\r\n\r\nexport function setDaemon(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_DAEMON\", data: data });\r\n  };\r\n}\r\n\r\nexport function setErrorInfo(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_ERROR_INFO\", data: data });\r\n  };\r\n}\r\n\r\nexport function setMessage(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_MESSAGE\", data: data });\r\n  };\r\n}\r\n\r\nexport function setTypes(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_TYPES\", data: data });\r\n  };\r\n}\r\n\r\n\r\nexport function updateTypes(type, typeData) {\r\n  return setTypes(objectUpdate(store.getState().types, { [type]: typeData }));\r\n}\r\n","import { setConfig, setDaemon, setErrorInfo, setUser } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { isIterator, urlEncode } from \"../utils/utils\"\r\n\r\n\r\nclass API {\r\n  constructor() {\r\n    // this.host = '127.0.0.1';\r\n    this.host = window.location.href.includes(\"localhost\") ? \"localhost\" : null;\r\n    // this.port = 8080;\r\n    this.port = 8088;\r\n    this.api_version = \"v1\";\r\n    this.api_prefix = `/api/${this.api_version}`;\r\n    this.protocol = 'http'\r\n    this.url = this.host ? `${this.protocol}://${this.host}:${this.port}${this.api_prefix}` : `${this.api_prefix}`;\r\n    this.access_token = '';\r\n    this.refresh_token = '';\r\n  }\r\n  set_token(access_token, refresh_token) {\r\n    // this.access_token = access_token || this.access_token;\r\n    // this.refresh_token = refresh_token || this.refresh_token;\r\n    if (access_token !== undefined)\r\n      this.access_token = access_token;\r\n    if (refresh_token !== undefined)\r\n      this.refresh_token = refresh_token;\r\n  }\r\n  get_token() {\r\n    return {\r\n      access_token: this.access_token === '' ? undefined : this.access_token, refresh_token: this.refresh_token === '' ? undefined : this.refresh_token\r\n    }\r\n  }\r\n  request_key(router, key, method = \"GET\", data) {\r\n    return this.request(`${router}/${key}`, method, data);\r\n  }\r\n  update_config() {\r\n    let config = store.getState().config;\r\n    config.data.api_token = this.get_token();\r\n    console.log('config.data.api_token', config.data.api_token)\r\n    // config.save();\r\n    store.dispatch(setConfig(config));\r\n  }\r\n  load_from_config() {\r\n    const config = store.getState().config;\r\n    this.set_token(config.data.api_token.access_token, config.data.api_token.refresh_token);\r\n  }\r\n  get_headers(refresh = false, access = true) {\r\n    let headers = {\r\n      'Content-Type': 'application/json',\r\n    };\r\n    if (refresh) {\r\n      headers['Refresh'] = this.refresh_token;\r\n    }\r\n    if (access) {\r\n      if (this.access_token !== '') headers['Authorization'] = this.access_token;\r\n    }\r\n    return headers;\r\n  }\r\n  async request(router, method = \"GET\", data) {\r\n    const payload = {\r\n      method: method,\r\n      mode: 'cors',\r\n      body: data ? JSON.stringify(data) : undefined,\r\n      // 注销的时候自带 refresh_token\r\n      headers: this.get_headers(Boolean(router === 'session' && method === 'DELETE')),\r\n    };\r\n    // console.log('request', router, method, data, payload);\r\n    // console.log(`${this.url}/${router}`);\r\n    let resp = null;\r\n    try {\r\n      resp = await fetch(`${this.url}/${router}`, payload);\r\n    } catch (e) {\r\n      console.error(e);\r\n      store.dispatch(setErrorInfo(e));\r\n      resp = { status: 433, error: \"Error when fetching internet\" };\r\n      return { code: resp.status, error: resp.statusText };\r\n    }\r\n    let js = null;\r\n    try { js = await resp.json(); } catch (e) {\r\n      console.error(e);\r\n      store.dispatch(setErrorInfo(e));\r\n      return { code: resp.status, error: resp.statusText };\r\n    }\r\n    console.log('raw js:', js);\r\n    if (!js) {\r\n      // console.log(await resp.json());\r\n      js = {};\r\n      js.message = resp.statusText;\r\n    }\r\n    if (js.code === undefined) js.code = resp.status;\r\n    if (js.code === 422) {\r\n      if (this.refresh_token === '') {\r\n        // 过期勒\r\n        return null;\r\n      }\r\n      // ac_token到期，准备更新\r\n      // console.log(this.get_headers(true));\r\n      const resp2 = await fetch(`${this.url}/session`, {\r\n        method: 'GET',\r\n        mode: 'cors',\r\n        headers: this.get_headers(true),\r\n        // body: JSON.stringify({ refresh_token: this.refresh_token })\r\n      });\r\n      try {\r\n        const js2 = await resp2.json();\r\n        // console.log('updating ac_token', js2);\r\n        if (js2.code === 200) {\r\n          this.set_token(js2.data.access_token, js2.data.refresh_token);\r\n          this.update_config();\r\n          // 更新user\r\n          const res = this.request('user', 'GET');\r\n          if (res.code === 200) {\r\n            store.dispatch(setUser(res.data.user));\r\n          }\r\n        }\r\n        else {\r\n          // 判定为 update_token 也过期，要求重新登录\r\n          store.dispatch(setErrorInfo(\"登录过期，请重新登录\"));\r\n          return null;\r\n        }\r\n      } catch (e) {\r\n        // console.error(e);\r\n        return { code: resp2.status, error: resp2.statusText };\r\n      }\r\n      return this.request(router, method, data);\r\n    } else if (js.code === 424) {\r\n      // 需要重新远程登录了\r\n      store.dispatch(setDaemon(null));\r\n      // store.dispatch(setUser(null));\r\n      await this.request(\"remote_login\", \"DELETE\");\r\n      const config = store.getState().config;\r\n      // this.set_token('', '');\r\n      config.save();\r\n      // window.location.reload();\r\n      store.dispatch(setConfig(config));\r\n      store.dispatch(setErrorInfo(\"远程登录失效，请重新登录美团账号\"));\r\n      return js;\r\n    } else if (js.code === 200) {\r\n      // 登录自动储存 JWT 数据\r\n      if (router === 'session' && method === 'POST') {\r\n        const { access_token, refresh_token } = js.data;\r\n        // console.log('jwt', access_token, refresh_token);\r\n        this.set_token(access_token, refresh_token);\r\n        this.update_config();\r\n      } else if (router === 'session' && method === 'DELETE') {\r\n        // 注销\r\n        // console.warn('注销');\r\n        this.set_token('', '');\r\n        this.update_config();\r\n      }\r\n    } else {\r\n      store.dispatch(setErrorInfo(js));\r\n    }\r\n    return js;\r\n  }\r\n}\r\n\r\nconst api = new API();\r\n\r\nexport { API, api };","import { createMuiTheme, makeStyles, ThemeProvider } from '@material-ui/core/styles';\r\nimport { orange, grey, blueGrey, teal, green } from '@material-ui/core/colors';\r\nimport { api } from \"./api/api\";\r\n\r\nconst ITEM_NAME = \"group_bying_config\";\r\n\r\nclass Config {\r\n  constructor() {\r\n    this.load = this.load.bind(this);\r\n    this.save = this.save.bind(this);\r\n    this.theme_avaliable = {\r\n      \"默认主题\": createMuiTheme({\r\n        palette: {\r\n          primary: {\r\n            main: teal[500]\r\n          }, \r\n          secondary: {\r\n            main: green[500]\r\n          }\r\n        }\r\n      }),\r\n      '黑暗模式': createMuiTheme({\r\n        palette: {\r\n          type: \"dark\",\r\n          primary: {\r\n            main: blueGrey[500],\r\n          },\r\n          secondary: {\r\n            main: grey[500],\r\n          },\r\n        },\r\n      }),\r\n    }\r\n    // 在构造函数执行的时候加载保存的数据\r\n    this.data_default = {\r\n      debug: false,\r\n      version_frontend: 0.1,\r\n      // 显示主题\r\n      // theme_name: \"黑暗模式\",\r\n      theme_name: \"默认主题\",\r\n      theme_avaliable: [\r\n        '默认主题',\r\n        '黑暗模式'\r\n      ],\r\n      // 设置同步\r\n      settings_async: true,\r\n      // // 远程登录服务器\r\n      // remote_login: {\r\n      //   server: \"ws://127.0.0.1:8081\"\r\n      // },\r\n      api_token: {},\r\n      enable_email: true\r\n    };\r\n    this.data = this.data_default;\r\n    this.theme = this.theme_avaliable[\"默认主题\"];\r\n    this.load();\r\n  }\r\n\r\n  load() {\r\n    console.log(\"Config: loading config...\");\r\n    if (this.data.debug) {\r\n      console.log(\"Config: load default config.\");\r\n      this.save();\r\n    }\r\n    try {\r\n      this.data = JSON.parse(localStorage.getItem(ITEM_NAME));\r\n      if (!this.data) throw new Error(\"Null data\");\r\n      console.log(\"Got data:\", this.data);\r\n      if (!this.data.version_frontend || this.data.version_frontend < this.data_default.version_frontend) {\r\n        // 版本升级，增量更新\r\n        console.log(`Config: update ${this.data.version_frontend} -> ${this.data_default.version_frontend}`);\r\n        this.data.version_frontend = this.data_default.version_frontend;\r\n        for (let k in this.data_default) {\r\n          if (!this.data[k]) {\r\n            console.log(`    Config: add value ${k}`);\r\n            this.data[k] = this.data_default[k];\r\n          }\r\n        }\r\n        this.save();\r\n      }\r\n    } catch (e) {\r\n      console.warn(`Can not find ${ITEM_NAME} in localStorage, use default config.`);\r\n      this.data = this.data_default;\r\n      this.save();\r\n    }\r\n    this.theme = this.theme_avaliable[this.data.theme_name];\r\n    if (!this.theme) this.theme = this.theme_avaliable[\"default\"];\r\n    api.set_token(this.data.api_token.access_token, this.data.api_token.refresh_token);\r\n  }\r\n\r\n  save() {\r\n    console.log(\"Config: saving config...\");\r\n    this.data.api_token = api.get_token();\r\n    const s = JSON.stringify(this.data);\r\n    localStorage.setItem(ITEM_NAME, s);\r\n    return s;\r\n  }\r\n\r\n  static clear() {\r\n    console.log(\"Config: clearing all data...\");\r\n    localStorage.setItem(ITEM_NAME, undefined);\r\n  }\r\n};\r\n\r\nexport default Config;","import { combineReducers } from 'redux'\r\nimport Config from \"../Config\"\r\n\r\nconst defaultState = {\r\n  config: new Config(),\r\n  account: [],\r\n  user: null,\r\n  daemon: null,\r\n  errorInfo: null,\r\n  message: null,\r\n  types: {},\r\n}\r\n\r\nfunction types(state = defaultState.types, action) {\r\n  switch (action.type) {\r\n    case \"SET_TYPES\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction config(state = defaultState.config, action) {\r\n  switch (action.type) {\r\n    case \"SET_CONFIG\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction user(state = defaultState.user, action) {\r\n  switch (action.type) {\r\n    case \"SET_USER\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction account(state = defaultState.account, action) {\r\n  switch (action.type) {\r\n    case \"SET_ACCOUNTS\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction daemon(state = defaultState.daemon, action) {\r\n  switch (action.type) {\r\n    case \"SET_DAEMON\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction errorInfo(state = defaultState.errorInfo, action) {\r\n  switch (action.type) {\r\n    case \"SET_ERROR_INFO\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction message(state = defaultState.message, action) {\r\n  switch (action.type) {\r\n    case \"SET_MESSAGE\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport default combineReducers({ config, errorInfo, message, daemon, user, account, types });\r\n","// applyMiddleware: redux通过该函数来使用中间件\r\n// createStore: 用于创建store实例\r\nimport { applyMiddleware, createStore } from 'redux';\r\n\r\n// 中间件，作用：如果不使用该中间件，当我们dispatch一个action时，需要给dispatch函数传入action        \r\n// 对象；但如果我们使用了这个中间件，那么就可以传入一个函数，这个函数接收两个参数:dispatch和    \r\n// getState。这个dispatch可以在将来的异步请求完成后使用，对于异步action很有用\r\nimport thunk from 'redux-thunk';\r\n\r\n// 引入reducer\r\nimport reducers from './reducers.js';\r\n\r\n// 创建store实例\r\nlet store = createStore(\r\n    reducers,\r\n    applyMiddleware(thunk)\r\n);\r\nexport default store;","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { ListItem, ListItemText, ListItemIcon } from '@material-ui/core';\r\nimport { Link as RouterLink } from \"react-router-dom\";\r\n\r\nlet updated = false;\r\n\r\nfunction ListItemLink(props) {\r\n  const { icon, primary, to, onClick } = props;\r\n\r\n  const renderLink = React.useMemo(\r\n    () => React.forwardRef((itemProps, ref) => <RouterLink to={to} ref={ref} {...itemProps} />),\r\n    [to],\r\n  );\r\n\r\n  if (!updated) {\r\n    updated = true;\r\n    document.title = `${primary} - 团购杀手`;\r\n  }\r\n\r\n  return (\r\n    <li>\r\n      <ListItem button component={renderLink} onClick={() => {\r\n        document.title = `${primary} - 团购杀手`;\r\n        onClick && onClick();\r\n      }}>\r\n        {icon ? <ListItemIcon>{icon}</ListItemIcon> : null}\r\n        <ListItemText primary={primary} />\r\n      </ListItem>\r\n    </li>\r\n  );\r\n}\r\n\r\nListItemLink.propTypes = {\r\n  icon: PropTypes.element,\r\n  primary: PropTypes.string.isRequired,\r\n  to: PropTypes.string.isRequired,\r\n};\r\n\r\nexport default ListItemLink;\r\n\r\n","import { Box, TextField, Button, Container, Paper, Typography } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { api } from '../api/api';\r\nimport Config from \"../Config\";\r\n// import { WebSocketAPI } from '../api/remote_login';\r\nimport { setConfig, setDaemon } from '../data/action';\r\nimport store from '../data/store';\r\nconst QRCode = require('qrcode.react');\r\n\r\nfunction CenterBox(props) {\r\n  const { children, style } = props;\r\n  return <Box style={style ? style : { width: '100%', height: '100%', display: \"flex\", justifyContent: \"center\", flexDirection: \"column\" }}>\r\n    <Box style={{ width: '100%', textAlign: \"center\", display: \"flex\", justifyContent: \"center\", flexDirection: \"column\", alignItems: \"center\" }}>\r\n      {children}\r\n    </Box>\r\n  </Box>;\r\n}\r\n\r\nexport default class RemoteLogin extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.onFinish = props.onFinish;\r\n    this.forceLogin = props.forceLogin;\r\n    this.stateDefault = {\r\n      // code: null,\r\n      loginDone: false,\r\n      loginError: null,\r\n      username: \"\",\r\n      password: \"\"\r\n    };\r\n    this.refUsername = React.createRef();\r\n    this.refPassword = React.createRef();\r\n\r\n    console.log('onFinish', this.onFinish);\r\n\r\n    this.state = this.stateDefault;\r\n    this.handleAction = this.handleAction.bind(this);\r\n    // this.ws_api = null;\r\n    // this.ws_running = false;\r\n    // this.unsubscribe = store.subscribe(async () => {\r\n    //   if (this.loginDone) return;\r\n    //   let state = store.getState();\r\n    //   if (state.daemon) {\r\n    //     this.setState({ loginDone: true });\r\n    //     if (this.ws_api) this.ws_api.close();\r\n    //   }\r\n    // });\r\n    // this.run_ws = async () => {\r\n    //   // debugger;\r\n    //   this.ws_running = true;\r\n    //   console.log(store.getState().daemon);\r\n    //   if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n    //   const res = await api.request('remote_login', \"PATCH\");\r\n    //   if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n    //   const server = res.data.server;\r\n    //   let config = store.getState().config;\r\n    //   config.data.remote_login.server = server;\r\n    //   store.dispatch(setConfig(config));\r\n    //   if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n    //   this.ws_api = new WebSocketAPI(server);\r\n    //   this.ws_api.oncode = code => {\r\n    //     // console.log('code', code);\r\n    //     if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n    //     this.setState({ code });\r\n    //   };\r\n    //   this.ws_api.oncookies = async cookies => {\r\n    //     const resp = await api.request('remote_login', \"POST\", { cookies });\r\n    //     if (resp.code !== 200) {\r\n    //       this.setState({ loginDone: true, loginError: resp.message });\r\n    //       return;\r\n    //     }\r\n    //     console.log('done', resp);\r\n    //     if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n    //     this.setState({ loginDone: true });\r\n    //     const daemon = await api.request('remote_login', 'GET');\r\n    //     if (daemon.code === 200 && daemon.data.uid) {\r\n    //       store.dispatch(setDaemon(daemon.data));\r\n    //     }\r\n    //     this.onFinish && this.onFinish();\r\n    //   }\r\n    //   if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n    //   this.ws_api.connect();\r\n    // };\r\n    // setTimeout(this.run_ws, 1000);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    // if (this.ws_api) this.ws_api.close();\r\n    // this.unsubscribe();\r\n  }\r\n  async handleAction() {\r\n    const resp = await api.request('remote_login', \"POST\", {\r\n      username: this.state.username,\r\n      password: this.state.password\r\n    });\r\n    if (resp.code !== 200) {\r\n      this.setState({ loginDone: true, loginError: resp.message });\r\n      return;\r\n    }\r\n    console.log('done remote_login', resp);\r\n\r\n    this.setState({ loginDone: true });\r\n\r\n    // 添加到被管理账户列表\r\n    const resp2 = await api.request('account', \"POST\", {\r\n      username: this.state.username,\r\n      password: this.state.password\r\n    });\r\n    if (resp2.code !== 200) {\r\n      this.setState({ loginDone: true, loginError: resp.message });\r\n      return;\r\n    }\r\n    console.log('done add account', resp2);\r\n\r\n    // const resp2 = await api.request('remote_login', \"POST\", {cookies: resp.data.remote_login_result.cookies});\r\n    // if (resp2.code !== 200) {\r\n    //   this.setState({ loginDone: true, loginError: resp.message });\r\n    //   return;\r\n    // }\r\n    // console.log('done remote_login post cookies', resp2);\r\n    // // if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n    // this.setState({ loginDone: true });\r\n    // const daemon = await api.request('remote_login', 'GET');\r\n    // if (daemon.code === 200 && daemon.data.uid) {\r\n    //   store.dispatch(setDaemon(daemon.data));\r\n    // }\r\n    // this.onFinish && this.onFinish();\r\n  }\r\n  // if(!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n  render() {\r\n    let content = null;\r\n    if (this.state.loginDone) {\r\n      if (!this.state.loginError)\r\n        content = <Paper style={{ width: 200, height: 200 }}>\r\n          <CenterBox>\r\n            <Typography variant=\"body1\">登录完成</Typography>\r\n            <Button variant=\"contained\" color=\"primary\" onClick={() => {\r\n              this.setState(this.stateDefault);\r\n            }}>继续添加</Button>\r\n            <Button variant=\"outlined\" color=\"secondary\" onClick={() => {\r\n              this.onFinish && this.onFinish();\r\n            }}>退出</Button>\r\n          </CenterBox>\r\n        </Paper>;\r\n      else content = <Paper style={{ width: 200, height: 200 }}>\r\n        <CenterBox>\r\n          <Typography variant=\"body1\">{this.state.loginError}</Typography>\r\n          <Button variant=\"outlined\" color=\"secondary\" onClick={() => {\r\n            // try { clearTimeout(this.run_ws); } catch (e) { console.error(e); }\r\n            // this.setState(this.stateDefault);\r\n            // try { if (this.ws_api) this.ws_api.connect(); } catch (e) { console.error(e); }\r\n            // this.ws_api = null;\r\n            // this.ws_running = false;\r\n            // setTimeout(this.run_ws, 1000);\r\n            this.setState(this.stateDefault);\r\n          }}>重试</Button>\r\n        </CenterBox>\r\n      </Paper>;\r\n    } else {\r\n      // content = this.state.code ? <QRCode value={JSON.stringify(this.state.code)} size={200} /> :\r\n      //   <Paper style={{ width: 200, height: 200 }}>\r\n      //     <CenterBox>正在加载...</CenterBox>\r\n      //   </Paper>;\r\n      content = <div><TextField fullWidth ref={this.refUsername} label=\"用户名\" value={this.state.username} onChange={e => {\r\n        this.setState({ username: e.target.value });\r\n      }} onKeyDown={e => {\r\n        if (e.code === \"Enter\") {\r\n          this.refPassword.current.querySelector(\"input\").focus();\r\n        }\r\n      }} />\r\n        <br /><br />\r\n        <TextField fullWidth ref={this.refPassword} label=\"密码\" value={this.state.password} type=\"password\" onChange={e => {\r\n          this.setState({ password: e.target.value });\r\n        }} onKeyDown={e => {\r\n          if (e.code === \"Enter\") {\r\n            this.handleAction();\r\n          }\r\n        }} /> <br /><br />\r\n        <Button fullWidth onClick={() => { this.handleAction(); }} variant=\"contained\" color=\"primary\">验证</Button></div>;\r\n    }\r\n    return (<Container maxWidth=\"xs\">\r\n      <CenterBox>\r\n        <Typography variant=\"h5\">添加被管理账号</Typography>\r\n        <br></br>\r\n        {content}\r\n        <br></br>\r\n        <Typography variant=\"body2\" color=\"textSecondary\">输入需要管理的账号和密码</Typography>\r\n        <Typography variant=\"body2\" color=\"textSecondary\">本程序将会帮助你抢到重要任务</Typography>\r\n        <br></br>\r\n        {/* <Button fullWidth onClick={() => {\r\n          Config.clear();\r\n          setTimeout(() => { window.location.reload(); }, 500);\r\n        }}>退出当前本网站账号</Button> */}\r\n      </CenterBox>\r\n    </Container>);\r\n  }\r\n}","\r\nimport { Box, Button, CircularProgress, Container, Dialog, DialogActions, DialogContent, DialogTitle, Grid, IconButton, LinearProgress, List, ListItem, ListItemSecondaryAction, ListItemText, ListSubheader, TextField, Typography } from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport { setConfig, setErrorInfo, setMessage, setAccounts, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { arrayRemove, deepCopy, isObjectValueEqual, objectUpdate, parseTimePoint } from \"../utils/utils\";\r\nimport RemoteLogin from \"./RemoteLogin\";\r\n\r\nfunction AccountTag(props) {\r\n  const { user, onRefresh, onClick } = props;\r\n  return <ListItem button onClick={async () => { onClick && onClick(user); }}>\r\n    <ListItemText>\r\n      <Box>\r\n        {user.enabled ? <><Typography variant=\"h5\" color=\"primary\">{`${user.username}`}</Typography></> :\r\n          <s><Typography variant=\"h5\" color=\"textSecondary\">{`${user.username}`}</Typography></s>}\r\n        {/* <Typography variant=\"h5\" color={user.enabled ? \"textPrimary\" : \"textSecondary\"}>{`${user.username}`}</Typography> */}\r\n      </Box>\r\n      <Box>\r\n        <Typography variant=\"body2\">{`${user.enabled ? \"管理已开启\" : \"管理已关闭\"};更新于: ${parseTimePoint(user.created_at)}`}</Typography>\r\n      </Box>\r\n    </ListItemText>\r\n    <ListItemSecondaryAction>\r\n      <IconButton onClick={async () => {\r\n        // DELETE Account\r\n        const resp = await api.request(`account?username=${user.username}`, \"DELETE\");\r\n        if (resp.code == 200)\r\n          onRefresh && onRefresh();\r\n      }}>\r\n        <DeleteIcon></DeleteIcon>\r\n      </IconButton>\r\n    </ListItemSecondaryAction>\r\n  </ListItem>\r\n}\r\n\r\nexport default function Manage(props) {\r\n  const [state, setInnerState] = React.useState({\r\n    requestingAccounts: false,\r\n    dialogAddAccountOpen: false,\r\n    dialogSetAccountOpen: false,\r\n    addMode: true,\r\n    account: null,\r\n  });\r\n  const accounts = store.getState().account;\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n\r\n  if (!state.requestingAccounts) {\r\n    setState({ requestingAccounts: true });\r\n    api.request(\"account\", \"GET\").then(resp => {\r\n      if (resp.code !== 200) {\r\n        store.dispatch(setErrorInfo(resp));\r\n        return;\r\n      }\r\n      // console.log('update', resp.data.accounts);\r\n      store.dispatch(setAccounts(resp.data.accounts));\r\n      forceUpdate();\r\n    });\r\n  }\r\n  // console.log('acconts', accounts);\r\n  const content = state.requestingAccounts ? ((!accounts) ? <div><LinearProgress /></div> :\r\n    <List>{accounts.map((d, i) => <AccountTag key={i} user={d} onRefresh={() => {\r\n      setState({ requestingAccounts: false });\r\n    }} onClick={async user => {\r\n      setState({ account: user, dialogSetAccountOpen: true });\r\n    }}></AccountTag>)}</List>\r\n  ) : null;\r\n\r\n  return <Container>\r\n    <Grid container spacing={3}>\r\n      <Grid item lg={8} sm={12}>\r\n        <Typography variant=\"h4\">被管理账号列表</Typography>\r\n        {content}\r\n      </Grid>\r\n      <Grid item lg={4} sm={12}>\r\n        <Container maxWidth=\"xs\">\r\n          <List>\r\n            <ListSubheader>新被管理账号</ListSubheader>\r\n            <ListItem>\r\n              <Button fullWidth variant=\"contained\" color=\"secondary\" onClick={() => {\r\n                setState({ dialogAddAccountOpen: true, addMode: true });\r\n              }}>添加新被管理账号</Button>\r\n            </ListItem>\r\n            <ListItem>\r\n              <Button fullWidth disabled variant=\"contained\">设置默认被管理账号</Button>\r\n            </ListItem>\r\n\r\n            <ListSubheader>全部被管理账号管理</ListSubheader>\r\n            <ListItem>\r\n              <Button fullWidth disabled={(accounts && accounts.length === 0) || (accounts === null)} variant=\"outlined\" onClick={async () => {\r\n                for (const account of accounts) {\r\n                  const resp = await api.request(`account?username=${account.username}`, \"DELETE\");\r\n                }\r\n                setState({ requestingAccounts: false });\r\n              }}>删除全部被管理账号</Button>\r\n            </ListItem>\r\n            <ListItem>\r\n              <Button fullWidth disabled={(accounts && accounts.length === 0) || (accounts === null)} variant=\"outlined\" onClick={async () => {\r\n                for (const account of accounts) {\r\n                  const resp = await api.request(`account?username=${account.username}&enabled=${0}`, \"PATCH\");\r\n                }\r\n                setState({ requestingAccounts: false });\r\n              }}>关闭全部被管理账号的管理</Button>\r\n            </ListItem>\r\n          </List>\r\n        </Container>\r\n      </Grid>\r\n    </Grid>\r\n    <Dialog open={state.dialogAddAccountOpen} onClose={() => { setState({ dialogAddAccountOpen: false }); }}>\r\n      <DialogTitle>添加新被管理账号</DialogTitle>\r\n      <DialogContent>\r\n        <RemoteLogin onFinish={() => {\r\n          setState({ dialogAddAccountOpen: false, requestingAccounts: false });\r\n          forceUpdate();\r\n        }}></RemoteLogin>\r\n      </DialogContent>\r\n    </Dialog>\r\n    <Dialog open={state.dialogSetAccountOpen} onClose={() => { setState({ dialogSetAccountOpen: false, account: null }); }}>\r\n      <DialogTitle>是否{(state.account && state.account.enabled) ? \"关闭管理\" : \"打开管理\"}？</DialogTitle>\r\n      <DialogActions>\r\n        <Button color=\"primary\" onClick={() => {\r\n          setState({ dialogSetAccountOpen: false, account: null });\r\n        }}>\r\n          取消\r\n        </Button>\r\n        <Button color=\"primary\" autoFocus onClick={async () => {\r\n          const resp = await api.request(`account?username=${state.account.username}&enabled=${state.account.enabled ? 0 : 1}`, \"PATCH\");\r\n          // console.log('resp:', resp);\r\n          if (resp.code == 200) {\r\n            setState({ dialogSetAccountOpen: false, account: null, requestingAccounts: false });\r\n            forceUpdate();\r\n          }\r\n        }}>\r\n          确定\r\n        </Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  </Container>;\r\n}","import React from 'react';\r\nimport { List, ListItem, ListItemSecondaryAction, Container, Button, Select, MenuItem, LinearProgress, ListItemText, Typography } from \"@material-ui/core\";\r\nimport { objectUpdate, parseTimePoint } from '../utils/utils';\r\nimport { api } from '../api/api';\r\n\r\nexport default function LogsList(props) {\r\n  // const levels = {\r\n  //   debug: 10, info: 20, warning: 30, error: 40, critical: 50\r\n  // };\r\n  const levels = {\r\n    调试: 10, 信息: 20, 警告: 30, 错误: 40, 致命错误: 50\r\n  };\r\n  const colors = {\r\n    10: \"textSecondary\", 20: \"textPrimary\", 30: \"primary\", 40: \"secondary\", 50: \"secondary\"\r\n  };\r\n  const stateDefault = {\r\n    level: levels.信息,\r\n    limit: 30,\r\n    offset: 0,\r\n    requested: false,\r\n    logs: []\r\n  };\r\n  const [state, setInnerState] = React.useState(stateDefault);\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n\r\n  let content = null;\r\n  if (!state.requested) {\r\n    api.request(`log?limit=${state.limit}&offset=${state.offset}&level=${state.level}`, \"GET\").then(resp => {\r\n      // console.log('log got', resp);\r\n      setState({ requested: true, logs: resp.data.logs });\r\n    });\r\n    content = <LinearProgress></LinearProgress>;\r\n  } else {\r\n    if (state.logs.length == 0) {\r\n      content = <Typography color=\"textSecondary\">列表为空。</Typography>\r\n    } else {\r\n      content = <List>\r\n        {state.logs.map((log, k) => <ListItem>\r\n          <ListItemText color={colors[log.level]} primary={`[${k}] ` + log.text}></ListItemText>\r\n          <ListItemSecondaryAction><Typography variant=\"body2\" color=\"textSecondary\">{parseTimePoint(log.created_at)}</Typography></ListItemSecondaryAction>\r\n        </ListItem>)}\r\n      </List>;\r\n    }\r\n  }\r\n\r\n  return <Container>\r\n    <span>设置日志查看等级<Select value={state.level} onChange={e => {\r\n      setState({ level: e.target.value, requested: false });\r\n    }}>\r\n      {Object.keys(levels).map((key, i) => <MenuItem key={i} value={levels[key]}>{key}</MenuItem>)}\r\n    </Select></span>\r\n    <span><Button size=\"small\" onClick={() => { setState({ requested: false }); }} color=\"primary\">刷新</Button></span>\r\n    <Container style={{ maxHeight: 360, overflow: \"auto\" }}>\r\n      {content}\r\n    </Container>\r\n  </Container>;\r\n}","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\n// import ReserveTables from \"../components/ReserveTables\";\r\nimport { Divider, Table, TableBody, TableCell, TableRow, Typography } from \"@material-ui/core\";\r\nimport store from \"../data/store\";\r\nimport Manage from \"./Manage\";\r\nimport LogsList from \"../components/LogsList\";\r\nimport { api } from \"../api/api\";\r\n\r\nclass StateNow extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = store.getState({\r\n      requested: false,\r\n      fetched_task: null,\r\n      account: []\r\n    });\r\n    this.unsubscribe = store.subscribe(() => {\r\n      // console.log(\"store update\", store.getState().account);\r\n      if (store.getState().account && store.getState().account.length > 0)\r\n        this.setState({\r\n          account: store.getState().account\r\n        });\r\n    });\r\n  }\r\n  componentWillUnmount() {\r\n    this.unsubscribe();\r\n  }\r\n  render() {\r\n    // console.log('launch: got account', this.state.account);\r\n    let enabled_count = 0;\r\n    for (const account of this.state.account) if (account.enabled) enabled_count++;\r\n    if (!this.state.requested) {\r\n      this.setState({ requested: true });\r\n      api.request('state', 'GET').then(resp => {\r\n        this.setState({ fetched_task: resp.data.state.fetched_task });\r\n      });\r\n    }\r\n    return (<Table>\r\n      <TableBody>\r\n        <TableRow>\r\n          <TableCell align=\"center\">被管理账号数量</TableCell>\r\n          <TableCell align=\"center\">已开启管理数量</TableCell>\r\n          <TableCell align=\"center\">已经抢到的任务数量</TableCell>\r\n        </TableRow>\r\n        <TableRow>\r\n          <TableCell align=\"center\">{this.state.account.length}个</TableCell>\r\n          <TableCell align=\"center\">{enabled_count}个</TableCell>\r\n          <TableCell align=\"center\">{this.state.fetched_task}个</TableCell>\r\n        </TableRow>\r\n      </TableBody>\r\n    </Table>);\r\n  }\r\n}\r\n\r\nfunction Launch(props) {\r\n  return (<Container>\r\n    <Typography variant=\"h5\">执行状态</Typography>\r\n    <Divider></Divider>\r\n    <StateNow></StateNow>\r\n    <LogsList></LogsList>\r\n    <br />\r\n    <Typography variant=\"h5\">账号管理</Typography>\r\n    <Divider></Divider>\r\n    <Manage></Manage>\r\n  </Container>);\r\n}\r\n\r\nexport default Launch;","import { Container, Dialog, DialogContent, DialogTitle, List, ListItem, ListItemSecondaryAction, ListItemText, Typography } from \"@material-ui/core\";\r\nimport React from \"react\";\r\n\r\nexport default function ListInfo(props) {\r\n  const { data, open, onClose, title, keyNames } = props;\r\n  const [openChild, setOpenChild] = React.useState(false);\r\n  const [child, setChild] = React.useState(null);\r\n  const [childTitle, setChildTitle] = React.useState(null);\r\n  // console.log(data);\r\n  // Object.keys(data).map((v, k) => { console.log(`v: ${v}, k: ${k}`) })\r\n\r\n  return <Dialog fullWidth open={open} onClose={onClose}>\r\n    <DialogTitle>{title}</DialogTitle>\r\n    <DialogContent>\r\n      <List style={{ width: \"100%\" }}>\r\n        {Object.keys(data).map((v, k) => {\r\n          const showName = keyNames ? (keyNames[v] || v) : (v);\r\n          if (!data[v]) return undefined;\r\n          if (typeof (data[v]) === 'object') {\r\n            return <ListItem key={v} button onClick={() => {\r\n              setChild(data[v]);\r\n              setChildTitle(showName);\r\n              setOpenChild(true);\r\n            }}>{showName}</ListItem>\r\n          } else {\r\n            const s = `${data[v]}`;\r\n            return <ListItem key={v}>\r\n              <ListItemText>{showName}</ListItemText>\r\n              <ListItemSecondaryAction>\r\n                <Typography variant=\"body1\">{s.slice(0, 20) + (s.length > 20 ? \"...\" : \"\")}</Typography>\r\n              </ListItemSecondaryAction>\r\n            </ListItem>\r\n          }\r\n        }\r\n        )}\r\n      </List>\r\n      {(child && childTitle) ? <ListInfo data={child} open={openChild} onClose={() => { setOpenChild(false); }} title={childTitle}></ListInfo> : undefined}\r\n    </DialogContent>\r\n  </Dialog>\r\n}","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport { Button, MenuItem, FormControl, TextField, InputLabel, List, ListItem, ListItemSecondaryAction, ListItemText, Select, ListSubheader, Switch, Dialog, DialogTitle, DialogContent, Typography, DialogActions, Box, IconButton, DialogContentText, Checkbox } from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport store from \"../data/store\";\r\nimport { setConfig, setErrorInfo, setMessage } from \"../data/action\";\r\nimport { funDownload } from \"../utils/utils\";\r\nimport ListInfo from \"../components/ListInfo\";\r\nimport { api } from \"../api/api\";\r\nimport Config from \"../Config\";\r\nimport RemoteLogin from \"./RemoteLogin\";\r\n\r\nfunction Settings(props) {\r\n  const [themeName, setThemeName] = React.useState(store.getState().config.data.theme_name);\r\n  const refConfigFileInput = React.useRef();\r\n  const [resetSettingsOpen, setResetSettingsOpen] = React.useState(false);\r\n  const [deleteDataOpen, setDeleteDataOpen] = React.useState(false);\r\n  const [openDaemon, setOpenDaemon] = React.useState(false);\r\n  const [openUser, setOpenUser] = React.useState(false);\r\n  const [openResetShop, setOpenResetShop] = React.useState(false);\r\n  const [openSelectShop, setOpenSelectShop] = React.useState(false);\r\n  const [openVipCode, setOpenVipCode] = React.useState(false);\r\n  const [usernameVipCode, setUsernameVipCode] = React.useState('');\r\n  const [emailOpen, setEmailOpen] = React.useState(false);\r\n  const [email, setEmail] = React.useState(store.getState().user.profile.contact.email);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n\r\n  const resetSettings = function () {\r\n    let c = store.getState().config;\r\n    c.data = c.data_default;\r\n    c.save();\r\n    c.load();\r\n    store.dispatch(setConfig(c));\r\n  }\r\n\r\n  const user = store.getState().user;\r\n\r\n  return (<Container maxWidth=\"md\">\r\n    <List>\r\n      <ListSubheader>用户账号</ListSubheader>\r\n      <ListItem>\r\n        <ListItemText primary=\"用户名\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          {user.username}\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => { setOpenUser(true); }}>\r\n        <ListItemText primary=\"详细信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => { setEmailOpen(true); }}>\r\n        <ListItemText primary=\"修改邮箱\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <Typography variant=\"body2\" color=\"textSecondary\">{email}</Typography>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"通过邮箱接收运行报告\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <Checkbox checked={store.getState().config.data.enable_email} onChange={(e) => {\r\n            let config = store.getState().config;\r\n            config.data.enable_email = !config.data.enable_email;\r\n            config.save();\r\n            store.dispatch(setConfig(config));\r\n            forceUpdate();\r\n          }}></Checkbox>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => {\r\n        Config.clear();\r\n        setTimeout(() => { window.location.reload(); }, 500);\r\n      }}>\r\n        <ListItemText primary=\"退出当前账号\"></ListItemText>\r\n      </ListItem>\r\n      <ListSubheader>外观</ListSubheader>\r\n      <ListItem>\r\n        <ListItemText primary=\"主题设置\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <FormControl>\r\n            {/* <InputLabel></InputLabel> */}\r\n            <Select value={themeName} onChange={e => {\r\n              setThemeName(e.target.value);\r\n              let c = store.getState().config;\r\n              c.data.theme_name = e.target.value;\r\n              c.theme = c.theme_avaliable[c.data.theme_name];\r\n              c.save();\r\n              store.dispatch(setConfig(c));\r\n              setTimeout(() => { window.location.reload(); }, 200);\r\n            }}>\r\n              {store.getState().config.data.theme_avaliable.map((v, k) => <MenuItem key={v} value={v}>{v}</MenuItem>)}\r\n            </Select>\r\n          </FormControl>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      {store.getState().user.uid === 1 ? <ListItem button onClick={() => { setOpenVipCode(true); }}>\r\n        <ListItemText primary=\"创建验证码\"></ListItemText>\r\n      </ListItem> : null}\r\n      {/* <ListSubheader>数据管理</ListSubheader>\r\n      <ListItem button onClick={() => {\r\n        funDownload(store.getState().config.save(), `配置数据(${new Date().toLocaleString()}).json`);\r\n      }}>\r\n        <ListItemText primary=\"数据导出\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => {\r\n        // console.log(refConfigFileInput)\r\n        refConfigFileInput.current.click();\r\n      }}>\r\n        <ListItemText primary=\"数据导入\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <input type=\"file\" accept=\".json\" hidden name=\"file-gbk-data\" ref={refConfigFileInput} onChange={e => {\r\n            // console.log(e);\r\n            let files = e.target.files;\r\n            if (files.length === 0) {\r\n              store.dispatch(setMessage(\"未选择文件\"));\r\n              return;\r\n            }\r\n            try {\r\n              let file = files[0];\r\n              let reader = new FileReader();\r\n              reader.readAsText(file, 'UTF-8');\r\n              reader.onload = evt => {\r\n                const fileData = evt.target.result;\r\n                try {\r\n                  const js = JSON.parse(fileData);\r\n                  if (!js.version_frontend) {\r\n                    store.dispatch(setMessage(\"文件类型错误或者文件已经损坏\"));\r\n                    return;\r\n                  }\r\n                  if (js.version_frontend > store.getState().config.data.version_frontend) {\r\n                    store.dispatch(setMessage(`存档文件版本(${js.version_frontend}高于当前版本${store.getState().config.data.version_frontend})，请更新到最新版`));\r\n                    return;\r\n                  }\r\n                  let c = store.getState().config;\r\n                  c.data = js;\r\n                  store.dispatch(setConfig(c));\r\n                  store.dispatch(setMessage(\"数据导入完成\"));\r\n                } catch (e) {\r\n                  store.dispatch(setErrorInfo(e));\r\n                }\r\n              };\r\n            } catch (e) {\r\n              store.dispatch(setErrorInfo(e));\r\n            }\r\n          }}></input>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"设置数据同步\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <Switch defaultChecked={store.getState().config.data.settings_async} onChange={e => {\r\n            let c = store.getState().config;\r\n            c.data.settings_async = e.target.checked;\r\n            c.save();\r\n            store.dispatch(setConfig(c));\r\n          }}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem> */}\r\n      <ListItem button onClick={() => setResetSettingsOpen(true)}>\r\n        <ListItemText primary=\"回到默认设置\"></ListItemText>\r\n      </ListItem>\r\n      {/* <ListItem button onClick={() => setDeleteDataOpen(true)}>\r\n        <ListItemText primary=\"删除所有数据\"></ListItemText>\r\n      </ListItem> */}\r\n    </List>\r\n    <ListInfo data={store.getState().user} open={openUser} keyNames={{\r\n      username: '用户名', nick: '昵称', phone: '用户手机号', profile: '详细信息', state: '用户状态', created_at: '创建于', updated_at: '更新于'\r\n    }} title=\"用户信息\" onClose={() => { setOpenUser(false); }}></ListInfo>\r\n    <Dialog open={resetSettingsOpen} onClose={() => setResetSettingsOpen(false)}>\r\n      <DialogTitle>\r\n        回到默认设置\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会清除所有设置数据，确认操作？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setResetSettingsOpen(false)}>取消</Button>\r\n        <Button onClick={() => {\r\n          resetSettings();\r\n          window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n    {/* <Dialog open={deleteDataOpen} onClose={() => setDeleteDataOpen(false)}>\r\n      <DialogTitle>\r\n        删除所有数据\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会清除软件数据，确认操作？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setDeleteDataOpen(false)}>取消</Button>\r\n        <Button onClick={() => {\r\n          resetSettings();\r\n          window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog> */}\r\n    <Dialog open={openVipCode} onClose={() => { setOpenVipCode(false); }}>\r\n      <DialogContent>\r\n        <TextField value={usernameVipCode} onChange={e => {\r\n          setUsernameVipCode(e.target.value);\r\n        }}></TextField>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => { setOpenVipCode(false); }}>关闭</Button>\r\n        <Button onClick={async () => {\r\n          const resp = await api.request(`vip_code?username=${usernameVipCode}`, \"GET\");\r\n          if (resp.code == 200) {\r\n            store.dispatch(setMessage(resp.data.vip_code));\r\n          }\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n    <Dialog open={emailOpen} onClose={() => { setEmailOpen(false); }}>\r\n      <DialogTitle>更新邮箱</DialogTitle>\r\n      <DialogContent>\r\n        <TextField value={email} onChange={e => {\r\n          setEmail(e.target.value);\r\n        }}></TextField>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button color=\"primary\" onClick={() => { setEmailOpen(false); }}>取消</Button>\r\n        <Button color=\"primary\" onClick={async () => {\r\n          const resp = await api.request(\"user_info\", \"POST\", { contact: { email } });\r\n          if (resp.code == 200)\r\n            window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n    {/* <Dialog open={openResetShop} onClose={() => { setOpenResetShop(false); }}>\r\n      <DialogTitle>解绑当前门店</DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会解除门店和<b>本网站</b>的数据绑定，需要<b>重新绑定</b>才能使用网站功能。是否继续？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => { setOpenResetShop(false); }}>取消</Button>\r\n        <Button onClick={async () => {\r\n          // const resp2 = await api.request(\"remote_login\", \"GET\");\r\n          // console.log(resp2);\r\n          const resp = await api.request(\"remote_login\", \"DELETE\");\r\n          console.log('delete cookies:', resp);\r\n          if (resp.code !== 200) {\r\n            store.dispatch(setErrorInfo(`删除失败: ${resp.code}, ${resp.message}, ${resp.error}`));\r\n          } else {\r\n            window.location.reload();\r\n            // setOpenResetShop(false);\r\n          }\r\n        }} color=\"secondary\">确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n    <Dialog open={openSelectShop} onClose={() => { setOpenSelectShop(false); }}>\r\n      <DialogTitle>选择一家门店</DialogTitle>\r\n      <DialogContent>\r\n        <List>\r\n          <ListItem>\r\n            <Typography variant=\"body2\" color=\"textSecondary\">注意，切换门店之后原有门店计划将停止执行。</Typography>\r\n          </ListItem>\r\n          {store.getState().daemon.shops ?\r\n            Object.keys(store.getState().daemon.shops).map((v, k) => {\r\n              const d = store.getState().daemon.shops[v];\r\n              return <ListItem button key={v} onClick={async () => {\r\n                console.log('switching to', d);\r\n                if (!d.cookies) return;\r\n                await api.request('remote_login', \"POST\", { cookies: d.cookies });\r\n                setOpenSelectShop(false);\r\n              }}>\r\n                <Box style={{ display: 'flex', flexDirection: \"row\" }}>\r\n                  <Box style={{ display: 'flex', flexDirection: \"column\" }}>\r\n                    <Typography variant=\"body1\">{`${d.shopName} - ${d.branchName}`}</Typography>\r\n                    <Typography variant=\"body2\" color=\"textSecondary\">{`${d.shopId}`}</Typography>\r\n                  </Box>\r\n                </Box>\r\n                <ListItemSecondaryAction>\r\n                  <IconButton onClick={async () => {\r\n                    console.log('to delete:', d);\r\n                    await api.request(\"remote_login\", \"DELETE\", { shop_id: d.shopId });\r\n                    if (store.getState().daemon.shop_info && d.shopId === store.getState().daemon.shop_info.shopId) window.location.reload();\r\n                  }}>\r\n                    <DeleteIcon></DeleteIcon>\r\n                  </IconButton>\r\n                </ListItemSecondaryAction>\r\n              </ListItem>;\r\n            })\r\n            : <ListItem><ListItemText>无门店数据</ListItemText></ListItem>}\r\n        </List>\r\n      </DialogContent>\r\n    </Dialog>\r\n    <Dialog open={openVipCode} onClose={() => { setOpenVipCode(false); }}>\r\n      <DialogContent>\r\n        <RemoteLogin forceLogin onFinish={() => {\r\n          console.log('onFinish');\r\n          setTimeout(() => { window.location.reload(); }, 3000);\r\n        }}></RemoteLogin>\r\n      </DialogContent>\r\n    </Dialog> */}\r\n  </Container>)\r\n}\r\n\r\nexport default Settings;","import { Box, Button, Container, Divider, TextField, Typography, Zoom, Fade } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { api } from '../api/api';\r\nimport { setMessage, setUser } from '../data/action';\r\nimport store from '../data/store';\r\nimport { objectUpdate } from '../utils/utils';\r\n\r\n\r\nfunction LoginFrame(props) {\r\n  const [state, setInnerState] = React.useState({\r\n    username: \"\",\r\n    password: \"\",\r\n    vip_code: \"\",\r\n    email: '',\r\n    actionType: 'login'\r\n  });\r\n  const refUsername = React.useRef();\r\n  const refPassword = React.useRef();\r\n  const refEmail = React.useRef();\r\n  const refVipCode = React.useRef();\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n  // style={{ display: \"flex\", justifyContent: 'center', alignItems: \"center\", flexDirection: \"column\", }}\r\n  const actionLogin = state.actionType === 'login' ? true : false;\r\n  const handleAction = async () => {\r\n    // console.log('handle', actionLogin);\r\n    if (actionLogin) {\r\n      const res = await api.request('session', 'POST', {\r\n        username: state.username, password: state.password\r\n      });\r\n      console.log(res);\r\n      if (res.code !== 200) return;\r\n      // 获取user\r\n      const user = await api.request('user', 'GET');\r\n      if (user.code !== 200) return;\r\n      console.log('user', user.data.user);\r\n      store.dispatch(setUser(user.data.user));\r\n    } else {\r\n      // 注册，注册成功则跳转登录\r\n      const res = await api.request('user', 'POST', {\r\n        username: state.username, password: state.password, vip_code: state.vip_code, email: state.email\r\n      });\r\n      console.log(res);\r\n      if (res.code === 200) {\r\n        // 弹窗\r\n        store.dispatch(setMessage(\"注册成功\"));\r\n        setState({ actionType: 'login' });\r\n      }\r\n    }\r\n  }\r\n\r\n  return (<Box>\r\n    <Typography variant=\"h4\">{actionLogin ? \"登录\" : \"注册\"}</Typography>\r\n    <br />\r\n    <Divider></Divider>\r\n    <br />\r\n    <TextField fullWidth ref={refUsername} label=\"用户名\" variant=\"outlined\" value={state.username} onChange={e => {\r\n      setState({ username: e.target.value });\r\n    }} onKeyDown={e => {\r\n      if (e.code === \"Enter\") {\r\n        refPassword.current.querySelector(\"input\").focus();\r\n      }\r\n    }} />\r\n    <br /><br />\r\n    <TextField fullWidth ref={refPassword} label=\"密码\" variant=\"outlined\" value={state.password} type=\"password\" onChange={e => {\r\n      setState({ password: e.target.value });\r\n    }} onKeyDown={e => {\r\n      if (e.code === \"Enter\") {\r\n        if (actionLogin) {\r\n          handleAction();\r\n        } else {\r\n          refEmail.current.querySelector(\"input\").focus();\r\n        }\r\n      }\r\n    }} />\r\n    <br /><br />\r\n    {actionLogin ? null : <>\r\n      <TextField fullWidth ref={refEmail} label=\"邮箱, 用于接收程序消息\" variant=\"outlined\" value={state.email} onChange={e => {\r\n        setState({ email: e.target.value });\r\n      }} onKeyDown={e => {\r\n        if (e.code === \"Enter\") {\r\n          refVipCode.current.querySelector(\"input\").focus();\r\n        }\r\n      }} /><br /><br />\r\n      <TextField fullWidth ref={refVipCode} label=\"验证码\" variant=\"outlined\" value={state.vip_code} onChange={e => {\r\n        setState({ vip_code: e.target.value });\r\n      }} onKeyDown={e => {\r\n        if (e.code === \"Enter\") {\r\n          handleAction();\r\n        }\r\n      }} /></>}\r\n    <Fade in={actionLogin} style={{ display: actionLogin ? \"block\" : \"none\" }} timeout={{ exit: 0, enter: 200 }}>\r\n      <Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"primary\" onClick={handleAction}>登录</Button>\r\n        </Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"secondary\" onClick={() => setState({ actionType: \"sign_in\" })}>注册</Button>\r\n        </Box>\r\n      </Box>\r\n    </Fade>\r\n    <Fade in={!actionLogin} style={{ display: !actionLogin ? \"block\" : \"none\" }} timeout={{ exit: 0, enter: 200 }}>\r\n      <Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"primary\" onClick={handleAction}>注册</Button>\r\n        </Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" onClick={() => setState({ actionType: 'login' })}>返回登录</Button>\r\n        </Box>\r\n      </Box>\r\n    </Fade>\r\n  </Box >);\r\n}\r\n\r\nexport default function Login(props) {\r\n  return <Container maxWidth=\"sm\">\r\n    <LoginFrame></LoginFrame>\r\n  </Container>\r\n}","import React from 'react';\r\nimport { api } from './api/api';\r\n\r\nexport default class ErrorBoundary extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      error: null,\r\n      requesting: false,\r\n      requested: false,\r\n    };\r\n  }\r\n\r\n  componentDidCatch(error, info) {\r\n    this.setState({ error: { error, info }, requesting: true });\r\n    // logErrorToMyService(error, info);\r\n    console.error('catched error', error);\r\n    console.error('catched info', info);\r\n    api.request('error_report', 'POST', { error: { error, info } }).then(resp => {\r\n      this.setState({ requested: true });\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.state.error) {\r\n      const content = (this.state.requesting && !this.state.requested) ?\r\n        <div style={{ color: 'orange' }}>正在收集数据并且上报开发者...</div> :\r\n        <div style={{ color: 'green' }}>错误数据上报完成！<div>\r\n          {window.location.hash === '#/' ? null : <div><br />你可以选择：<a href=\"/\">回到主页</a></div>}\r\n        </div>\r\n        </div>;\r\n      return <div>\r\n        <b><h3>很抱歉</h3></b>\r\n        <p>页面崩溃了！</p>\r\n        <hr />\r\n        {content}\r\n        <p>对您造成的困扰我们表示抱歉，如果有其他需要解决的问题，请联系：</p>\r\n        <p>开发者邮箱：<a href=\"mailto:chiro2001@163.com\">chiro2001@163.com</a> / 开发者微信：chiro2001</p>\r\n        <hr></hr>\r\n        <p>详细错误：</p>\r\n        <code>{JSON.stringify(this.state.error)}</code>\r\n      </div>;\r\n    }\r\n    return this.props.children;\r\n  }\r\n}","import React from 'react';\r\nimport \"@fontsource/roboto\";\r\nimport clsx from 'clsx';\r\nimport Container from '@material-ui/core/Container';\r\nimport { makeStyles, useTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport List from '@material-ui/core/List';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\r\nimport EqualizerIcon from '@material-ui/icons/Equalizer';\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport AssignmentIcon from '@material-ui/icons/Assignment';\r\nimport AlarmIcon from '@material-ui/icons/Alarm';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport StorageIcon from '@material-ui/icons/Storage';\r\nimport VerifiedUserIcon from '@material-ui/icons/VerifiedUser';\r\nimport PhonelinkIcon from '@material-ui/icons/Phonelink';\r\nimport SupervisorAccountIcon from '@material-ui/icons/SupervisorAccount';\r\nimport {\r\n  HashRouter as Router,\r\n  // BrowserRouter as Router,\r\n  Switch,\r\n  Route\r\n} from \"react-router-dom\";\r\nimport { TransitionGroup, CSSTransition } from \"react-transition-group\";\r\nimport { Provider } from 'react-redux'\r\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\r\nimport MomentUtils from '@date-io/moment';\r\nimport moment from 'moment';\r\nimport 'moment/locale/zh-cn';\r\nimport store from './data/store';\r\nimport { setConfig, setDaemon, setErrorInfo, setMessage, setReserveTableData, setRoomStockData, setShopInfo } from \"./data/action\";\r\n\r\nimport { isIterator, isMobileDevice, sleep } from \"./utils/utils\";\r\nimport { api } from \"./api/api\";\r\n\r\nimport ListItemLink from \"./components/ListItemLink\";\r\nimport Launch from \"./pages/Launch\";\r\nimport Settings from \"./pages/Settings\";\r\nimport './App.css';\r\nimport { Box, Button, Dialog, DialogActions, DialogContent, DialogTitle, ListItem, Snackbar } from '@material-ui/core';\r\nimport RemoteLogin from './pages/RemoteLogin';\r\nimport Login from './pages/Login';\r\n// import Tasks from \"./pages/Tasks\";\r\n// import Predicts from './pages/Predicts';\r\nimport Manage from './pages/Manage';\r\n// import User from './pages/User';\r\nimport ErrorBoundary from './ErrorBondary';\r\n\r\nconst drawerWidth = 240;\r\nmoment.locale('zh-cn');\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    display: 'flex',\r\n    width: '100%',\r\n    // overflowX: 'auto',\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n  },\r\n  title: {\r\n    flexGrow: 1\r\n  },\r\n  appBarShift: {\r\n    marginLeft: drawerWidth,\r\n    width: `calc(100% - ${drawerWidth}px)`,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  menuButton: {\r\n    marginRight: 36,\r\n  },\r\n  hide: {\r\n    display: 'none',\r\n  },\r\n  drawer: {\r\n    width: drawerWidth,\r\n    flexShrink: 0,\r\n    whiteSpace: 'nowrap',\r\n  },\r\n  drawerOpen: {\r\n    width: drawerWidth,\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  drawerClose: {\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n    overflowX: 'hidden',\r\n    width: theme.spacing(7) + 1,\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: theme.spacing(9),\r\n    },\r\n  },\r\n  toolbar: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-end',\r\n    padding: theme.spacing(0, 1),\r\n    // necessary for content to be below app bar\r\n    ...theme.mixins.toolbar,\r\n  },\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(3),\r\n    width: '100%',\r\n    overflowX: 'auto',\r\n  },\r\n}));\r\n\r\n// const api = new API();\r\n// const authApi = new AuthAPI();\r\n// api.get_shop_info().then(shopInfo => {\r\n//   console.log('shopInfo', shopInfo);\r\n//   if (shopInfo) store.dispatch(setShopInfo(shopInfo));\r\n// }).catch(e => {\r\n//   store.dispatch(setErrorInfo(e));\r\n// })\r\n\r\nlet subscribers = {};\r\n\r\nlet last_data = {\r\n  config: null,\r\n  user: null,\r\n  daemon: null\r\n};\r\n\r\nstore.subscribe(async () => {\r\n  let state = store.getState();\r\n  // console.log('redux update to', state);\r\n  // 保存 config\r\n  if (state.config.data) {\r\n    if (JSON.stringify(state.config.data) !== last_data.config) {\r\n      // console.log('Config will change:', state.config.data);\r\n      state.config.save();\r\n      if (store.getState().user && store.getState().config.data.settings_async) {\r\n        await api.request('sync', 'POST', { config: state.config.data });\r\n      }\r\n    } else {\r\n      // console.log('Not change:', state.config.data);\r\n    }\r\n    last_data.config = JSON.stringify(state.config.data);\r\n  }\r\n  for (let subFunc in subscribers) {\r\n    subscribers[subFunc](state);\r\n  }\r\n});\r\n\r\nconst getShopTitle = function () {\r\n  // if (!(store.getState().daemon && store.getState().daemon.shop_info && store.getState().daemon.shop_info.shopName)) return null;\r\n  // // console.log('getShopTitle', store.getState().daemon.shop_info);\r\n  // const title = `${store.getState().daemon.shop_info.shopName} - ${store.getState().daemon.shop_info.branchName}`;\r\n  // // console.log(title);\r\n  // return title;\r\n  return '众星计划任务管理程序';\r\n}\r\n\r\nexport default function App() {\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [errorDialogInfo, setErrorDialogInfo] = React.useState(false);\r\n  const [myMessage, setMyMessage] = React.useState(null);\r\n  const [hasLogin, setHasLogin] = React.useState(false);\r\n  const titleDefault = 'Title';\r\n  const [title, setTitle] = React.useState(getShopTitle() || titleDefault);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const [requestingRemote, setRequesingRemote] = React.useState(false);\r\n  const [openUser, setOpenUser] = React.useState(false);\r\n\r\n  // 拉大到800会打开，拉小到600关闭\r\n  const triggerWidthOpen = 800;\r\n  const triggerWidthClose = 600;\r\n\r\n  // 注册一个当遇到错误的时候调用的钩子吧，用来显示错误信息\r\n  subscribers['Error'] = function (state) {\r\n    if (state.errorInfo) {\r\n      console.log('Error Hook: ', state.errorInfo);\r\n      setErrorDialogInfo(state.errorInfo);\r\n      // 清空错误信息\r\n      store.dispatch(setErrorInfo(null));\r\n    }\r\n  };\r\n  // 注册一个消息钩子\r\n  subscribers['Message'] = function (state) {\r\n    if (state.message) {\r\n      console.log('message: ', state.message);\r\n      setMyMessage(state.message);\r\n      store.dispatch(setMessage(null));\r\n    }\r\n  };\r\n  subscribers['User'] = async function (state) {\r\n    if (state.user) {\r\n      if (JSON.stringify(state.user) != JSON.stringify(last_data.user)) {\r\n        forceUpdate();\r\n        // 登录信息完成，触发获取daemon\r\n        // if (!last_data.user) \r\n        if (!last_data.user) {\r\n          // store.dispatch(setDaemon(false));\r\n          // console.log('trigger');\r\n        }\r\n      }\r\n      last_data.user = state.user;\r\n    }\r\n  };\r\n  // subscribers['Daemon'] = async function (state) {\r\n  //   if (state.daemon) {\r\n  //     if (JSON.stringify(state.daemon) != JSON.stringify(last_data.daemon)) {\r\n  //       forceUpdate();\r\n  //     }\r\n  //     last_data.daemon = state.daemon;\r\n  //     if (state.daemon.shop_info) {\r\n  //       if (title === titleDefault) {\r\n  //         setTitle(getShopTitle());\r\n  //       }\r\n  //     }\r\n  //   }\r\n  // if (state.daemon === false) {\r\n  //   store.dispatch(setDaemon(null));\r\n  //   const daemon = await api.request('daemon', 'GET');\r\n  //   if (daemon.code === 200 && daemon.data.uid) {\r\n  //     store.dispatch(setDaemon(daemon.data));\r\n  //   } else store.dispatch(setDaemon(null));\r\n  // }\r\n  // };\r\n  // onMount & onUpdate\r\n  React.useEffect(() => {\r\n    const onWindowResize = () => {\r\n      let width = window.innerWidth;\r\n      // console.log(width);\r\n      if (!open && width >= triggerWidthOpen) setOpen(true);\r\n      if (open && width <= triggerWidthClose) setOpen(false);\r\n    };\r\n    window.addEventListener(\"load\", onWindowResize);\r\n    window.addEventListener('resize', onWindowResize);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"load\", onWindowResize);\r\n      window.removeEventListener(\"resize\", onWindowResize);\r\n    };\r\n  });\r\n\r\n\r\n  const handleClickAction = () => {\r\n    if (window.innerWidth < 600 || window.location.pathname === '/') {\r\n      setOpen(false);\r\n    }\r\n  };\r\n\r\n  const mainContent = <Router>\r\n    <MuiPickersUtilsProvider utils={MomentUtils} locale=\"zh-cn\">\r\n      <CssBaseline />\r\n      <AppBar\r\n        position=\"fixed\"\r\n        className={clsx(classes.appBar, {\r\n          [classes.appBarShift]: open,\r\n        })}\r\n      >\r\n        <Toolbar>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            aria-label=\"open drawer\"\r\n            onClick={() => { setOpen(true); }}\r\n            edge=\"start\"\r\n            className={clsx(classes.menuButton, {\r\n              [classes.hide]: open,\r\n            })}\r\n          >\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <Typography variant=\"h6\" noWrap className={classes.title}>\r\n            {title}\r\n          </Typography>\r\n          {/* <IconButton\r\n            color=\"inherit\"\r\n            onClick={() => { setOpenUser(true); }}\r\n          >\r\n            <AccountCircleIcon />\r\n          </IconButton> */}\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Drawer\r\n        variant=\"permanent\"\r\n        className={clsx(classes.drawer, {\r\n          [classes.drawerOpen]: open,\r\n          [classes.drawerClose]: !open,\r\n        })}\r\n        classes={{\r\n          paper: clsx({\r\n            [classes.drawerOpen]: open,\r\n            [classes.drawerClose]: !open,\r\n          }),\r\n        }}\r\n      >\r\n        <div className={classes.toolbar}>\r\n          <IconButton onClick={() => { setOpen(false); }}>\r\n            {theme.direction === 'rtl' ? <ChevronRightIcon /> : <ChevronLeftIcon />}\r\n          </IconButton>\r\n        </div>\r\n        <Divider />\r\n        <List onClick={handleClickAction}>\r\n          <ListItemLink to=\"/\" primary=\"启动页\" icon={<DashboardIcon />} />\r\n          <ListItemLink to=\"/manage\" primary=\"管理\" icon={<SupervisorAccountIcon />} />\r\n          <ListItemLink to=\"/settings\" primary=\"设置\" icon={<SettingsIcon />} />\r\n        </List>\r\n      </Drawer>\r\n      <main className={classes.content}>\r\n        <div className={classes.toolbar} />\r\n        <Switch>\r\n          <Route path={\"/\"} exact={true}>\r\n            <Launch />\r\n          </Route>\r\n          <Route path={\"/manage\"} exact={true}>\r\n            <Manage />\r\n          </Route>\r\n          <Route path={\"/settings\"} exact={true}>\r\n            <Settings />\r\n          </Route>\r\n        </Switch>\r\n      </main>\r\n    </MuiPickersUtilsProvider>\r\n  </Router>;\r\n\r\n  const user = store.getState().user;\r\n  const isNowLogining = !user && store.getState().config.data.api_token.access_token;\r\n  let content = isNowLogining ? <Box>正在登录...</Box> : (user ? mainContent : <Login></Login>);\r\n  // if ((!isNowLogining && user) && !store.getState().daemon) {\r\n  //   content = <Typography variant=\"body1\">获取账户信息...</Typography>;\r\n  //   if (!requestingRemote) {\r\n  //     setRequesingRemote(true);\r\n  //     const daemon = api.request('remote_login', 'GET').then(daemon => {\r\n  //       if (daemon.code === 200 && daemon.data.uid) {\r\n  //         store.dispatch(setDaemon(daemon.data));\r\n  //       } else if (daemon.code === 200 && !daemon.data.uid) {\r\n  //         store.dispatch(setDaemon({}));\r\n  //       }\r\n  //     });\r\n  //   }\r\n  // }\r\n  //  else if ((!isNowLogining && user) && store.getState().daemon && !store.getState().daemon.uid) {\r\n  //   content = <RemoteLogin></RemoteLogin>\r\n  // }\r\n  console.log('app.js user', user, 'content', content);\r\n\r\n  return (<div className={classes.root}>\r\n    <ErrorBoundary>\r\n      <ThemeProvider theme={store.getState().config.theme}>\r\n        {content}\r\n        <Dialog open={errorDialogInfo ? true : false} onClose={() => { setErrorDialogInfo(null); }}>\r\n          <DialogTitle>遇到错误</DialogTitle>\r\n          <DialogContent>\r\n            <Typography variant=\"body1\">错误信息</Typography>\r\n            <Box component=\"div\">\r\n              <Box component=\"div\">\r\n                {() => {\r\n                  if (isIterator(errorDialogInfo) && typeof (errorDialogInfo) !== 'string') {\r\n                    return <List>\r\n                      {errorDialogInfo.map((d, i) => <ListItem key={d}>\r\n                        <code>{JSON.stringify(d) === '{}' ? d.toString() : JSON.stringify(d)}</code>\r\n                      </ListItem>)}\r\n                    </List>;\r\n                  } else {\r\n                    return <code>{JSON.stringify(errorDialogInfo) === '{}' ? errorDialogInfo.toString() : JSON.stringify(errorDialogInfo)}</code>;\r\n                  }\r\n                }}\r\n              </Box>\r\n            </Box>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button color=\"primary\" onClick={() => { window.location.reload() }}>刷新</Button>\r\n            <Button color=\"primary\" onClick={() => { setErrorDialogInfo(null); }}>取消</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n        <Snackbar\r\n          anchorOrigin={{\r\n            vertical: 'bottom',\r\n            horizontal: 'right',\r\n          }}\r\n          open={myMessage !== null}\r\n          autoHideDuration={3000}\r\n          // onClose={(e) => { console.log(e); }}\r\n          message={myMessage}\r\n          action={\r\n            <React.Fragment>\r\n              <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={() => setMyMessage(null)}>\r\n                <CloseIcon fontSize=\"small\" />\r\n              </IconButton>\r\n            </React.Fragment>\r\n          }\r\n        />\r\n      </ThemeProvider>\r\n    </ErrorBoundary>\r\n  </div >);\r\n}\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport store from './data/store';\r\nimport { Provider } from 'react-redux';\r\nimport { api } from './api/api';\r\nimport { setConfig, setDaemon, setErrorInfo, setRoomStockPlans, setTimetableNodes, setTimetablePeriods, setUser } from './data/action';\r\nimport { sleep } from './utils/utils';\r\n\r\n// 循环执行函数\r\nasync function cycleFunc(cycle = 1000) {\r\n  while (true) {\r\n    try {\r\n\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    await sleep(cycle);\r\n  }\r\n}\r\n\r\n// 开始执行的函数\r\nasync function startFunc() {\r\n  setTimeout(async () => {\r\n    const user = store.getState().user;\r\n    const isNowLogining = !user && store.getState().config.data.api_token.access_token;\r\n    if (isNowLogining) {\r\n      api.load_from_config();\r\n      const res = await api.request('user', 'GET');\r\n      // console.log('index res', res)\r\n      if (res.code === 200) {\r\n        // console.log('saving user', res.data.user)\r\n        store.dispatch(setUser(res.data.user));\r\n        // const daemon = await api.request('daemon', 'GET');\r\n        // if (daemon.code === 200 && daemon.data.uid) {\r\n        //   store.dispatch(setDaemon(daemon.data));\r\n        // } else store.dispatch(setDaemon(null));\r\n      }\r\n    }\r\n    // let c = api.download_config();\r\n    // if (!c.settings_async) return;\r\n    // const config_frontend = await api.download_config();\r\n    // if (!config_frontend) {\r\n    //   store.dispatch(setErrorInfo(\"同步设置失败\"));\r\n    // }\r\n    // else store.dispatch(setConfig(config_frontend));\r\n  }, 0);\r\n}\r\n\r\nReactDOM.render(\r\n  // <React.StrictMode>\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  // </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\nstartFunc().then(() => {\r\n  cycleFunc();\r\n});\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}