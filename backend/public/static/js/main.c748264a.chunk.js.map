{"version":3,"sources":["utils/utils.js","data/action.js","api/api.js","Config.js","data/reducers.js","data/store.js","components/ListItemLink.js","components/ListEdit.js","components/ListInfo.js","components/Actions.js","components/Triggers.js","components/TaskDialog.js","pages/Tasks.js","components/ReserveTable.js","components/ReserveTables.js","pages/Launch.js","api/remote_login.js","pages/RemoteLogin.js","pages/Settings.js","pages/Login.js","pages/Predicts.js","pages/User.js","ErrorBondary.js","App.js","reportWebVitals.js","index.js"],"names":["sleep","time_ms","Promise","accept","setTimeout","isIterator","obj","Symbol","iterator","deepCopy","data","undefined","d","i","length","push","k","objectUpdate","origin","update","now","isObjectValueEqual","a","b","aProps","Object","getOwnPropertyNames","bProps","propName","propA","propB","hasOwnProperty","Date","prototype","setDay","day","day_","this","getDay","setTime","getTime","toDateString","toISOString","slice","timedeltaUnits","getTimedeltaString","timedelta","unit","keys","getTimedeltaUnit","toFixed","weekDayList","getNewNumberString","value","newValue","parseFloat","isNaN","formatDateTime","moment","format","setConfig","dispatch","type","setTasks","setUser","setDaemon","setErrorInfo","setMessage","updateTypes","typeData","store","getState","types","api","host","window","location","href","includes","port","api_version","api_prefix","protocol","url","access_token","refresh_token","router","key","method","request","config","api_token","get_token","console","log","set_token","refresh","access","headers","payload","mode","body","JSON","stringify","get_headers","Boolean","resp","fetch","error","status","code","statusText","js","json","message","resp2","js2","update_config","res","user","save","ITEM_NAME","Config","load","bind","theme_avaliable","createMuiTheme","palette","primary","main","blueGrey","secondary","grey","data_default","debug","version_frontend","theme_name","settings_async","remote_login","server","theme","parse","localStorage","getItem","Error","e","warn","s","setItem","defaultState","tasks","daemon","errorInfo","combineReducers","state","action","createStore","reducers","applyMiddleware","thunk","updated","ListItemLink","props","icon","to","onClick","renderLink","React","useMemo","forwardRef","itemProps","ref","document","title","ListItem","button","component","ListItemIcon","ListItemText","ActionData","onChange","onDelete","Box","Button","color","style","display","flexDirection","DateTimePicker","IconButton","ListEdit","defaultValue","open","onClose","keyNames","dataType","typeName","dismiss","onSave","useState","setInnerData","setData","openChild","setOpenChild","child","setChild","childTitle","setChildTitle","timedeltaUnit","setTimedeltaUnit","Dialog","fullWidth","DialogTitle","DialogContent","List","width","map","v","indexOf","args","editable","showName","actionData","startsWith","val","updateFixed","TextField","target","onBlur","Select","MenuItem","options","justifyItems","justifyContent","alignContent","ListItemSecondaryAction","DialogActions","height","Typography","variant","ListInfo","isActionModified","item","updateActionData","callback","then","actions","wrapAction","actionType","action_type","newActionData","getDataString","calendar","ActionTag","selectMode","targets","dialogOpen","setDialogOpen","roomItem","tmp","item_id","itemId","target_price","price","price_relative","actionTemp","toUse","setToUse","handleCloseDialog","handleClick","newAction","selected","Card","minWidth","margin","CardContent","name","desc","newData","CardActions","Actions","requesting","setRequesting","useReducer","x","forceUpdate","content","flexWrap","parent","periodDesc","roomName","roomType","date","updateTriggerData","triggers","isTriggerModified","getTriggerType","trigger","interval","run_date","wrapTrigger","triggerType","triggerData","newTriggerData","TriggerTag","newTrigger","Triggers","trigger_type","taskDialogUpdate","useStyles","makeStyles","nested","paddingLeft","spacing","centerText","alignItems","whiteSpace","setTaskDialogUpdate","roomItemUpdated","TaskDialog","classes","addMode","onRefresh","simpleMode","taskOld","baseTaskName","taskName","realDefaultTask","task_name","defaultTask","defaultCollapseOpen","timenode","cycle","stock","defaultOperations","dialogAddTaskOpen","dialogAddTriggerOpen","dialogAddActionOpen","dialogUpdateTrigger","task","requestingTaskData","defaultTid","useSimpleMode","collapseOpen","simpleData","timenodeTime","timenodePrice","cycleTime","cyclePrice","stockOperator","stockPrice","stockValue","setInnerState","setState","setCollapseToggle","taskData","task_data","tid","handleAddTask","resolve","reject","dialogContent","newTask","flexFlow","Checkbox","checked","className","Collapse","in","timeout","unmountOnExit","maxWidth","inputProps","textAlign","ListSubheader","splice","Grid","container","xs","lg","disabled","col","defaultData","adjust_price","operator","wrapTask","taskWrapped","TaskTag","onUpdate","taskOrigin","request_key","getTargetTasks","result","getTargetTasksMarks","TaskList","marks","Tasks","requestingTasks","Container","sm","tids","assign","table","foodDesc","overflow","contentOverflow","planButton","MyTableCell","styles","padding","noBorder","borderBottom","TableCell","align","colSpan","children","requestedDayData","setUpdateTimer","ReserveTable","requestingDaemon","setRequestingDaemon","requestingUpdate","setRequestingUpdate","dayData","setDayData","reserve_table","roomList","setRoomList","setDialogAddTaskOpen","dialogTasksListOpen","setDialogTasksListOpen","roomItemNow","setRoomItemNow","setRequestingTasks","LinearProgress","daemon_args","update_all","PeriodTable","periodIds","periodMap","periodList","period","periodId","id","room","roomMapItemName","roomMapItemEntry","rows","maxRows","index","notEmpty","getCenterTable","maxIndex","parseInt","position","top","periodData","row","planCount","Link","roomItemTmp","TableRow","updateData","reserveTableData","updateTaskData","tableHeaderCells","tableHeader","TableHead","roomCapacity","TableContainer","Paper","Table","stickyHeader","TableBody","isOk","TabPanel","other","role","hidden","aria-labelledby","root","overflowX","flexGrow","background","paper","formControl","selectEmpty","marginTop","ReserveTables","tabValue","setTableValue","showTable","setShowTable","fullShow","setFullShow","Tabs","indicatorColor","textColor","scrollButtons","aria-label","Tab","label","FormControl","InputLabel","event","float","innerWidth","fullScreen","edge","StateNow","unsubscribe","subscribe","timetableNodes","timetablePeriods","roomStockPlans","Component","Launch","WebSocketAPI","connect","ws","onopen","ondata","cmd","oncode","oncookies","onmessage","onerror","onclose","cookies","WebSocket","close","QRCode","require","CenterBox","RemoteLogin","onFinish","forceLogin","stateDefault","loginDone","loginError","ws_api","ws_running","run_ws","uid","clearTimeout","size","innerHeight","clear","reload","Settings","themeName","setThemeName","refConfigFileInput","useRef","resetSettingsOpen","setResetSettingsOpen","deleteDataOpen","setDeleteDataOpen","openDaemon","setOpenDaemon","openUser","setOpenUser","openResetShop","setOpenResetShop","openSelectShop","setOpenSelectShop","openNewShop","setOpenNewShop","resetSettings","c","username","shop_info","branchName","filename","eleLink","createElement","download","blob","Blob","URL","createObjectURL","appendChild","click","removeChild","funDownload","toLocaleString","current","files","file","reader","FileReader","readAsText","onload","evt","fileData","Switch","defaultChecked","nick","phone","profile","created_at","updated_at","solution_id","shops","shopName","shopId","shop_id","LoginFrame","password","captcha","refUsername","refPassword","actionLogin","handleAction","Divider","onKeyDown","querySelector","focus","Fade","exit","enter","Login","Predicts","useSpan","setUseSpan","openHelp","setOpenHelp","labels","labelShows","predictsResult","setPredictsResult","defaultValues","labelsTemp","labelValues","temp","inputValues","setInputValues","getTempValues","tempValues","items","FormControlLabel","control","predict_data","small","large","User","nickHead","test","Avatar","alt","ErrorBoundary","requested","info","hash","drawerWidth","locale","appBar","zIndex","drawer","transition","transitions","create","easing","sharp","duration","leavingScreen","appBarShift","marginLeft","enteringScreen","menuButton","marginRight","hide","flexShrink","drawerOpen","drawerClose","breakpoints","up","toolbar","mixins","subscribers","last_data","subFunc","getShopTitle","App","useTheme","setOpen","errorDialogInfo","setErrorDialogInfo","myMessage","setMyMessage","titleDefault","setTitle","requestingRemote","setRequesingRemote","useEffect","onWindowResize","addEventListener","removeEventListener","mainContent","utils","MomentUtils","CssBaseline","AppBar","clsx","Toolbar","noWrap","Drawer","direction","pathname","path","exact","isNowLogining","ThemeProvider","toString","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","Fragment","fontSize","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","load_from_config","ReactDOM","render","getElementById","startFunc","cycleFunc"],"mappings":"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","file":"static/js/main.c748264a.chunk.js","sourcesContent":["import moment from 'moment';\r\nimport 'moment/locale/zh-cn'\r\n\r\nexport function isMobileDevice() {\r\n  const sUserAgent = navigator.userAgent;\r\n  return (sUserAgent.indexOf('Android') > -1 || sUserAgent.indexOf('iPhone') > -1 || sUserAgent.indexOf('iPad') > -1 || sUserAgent.indexOf('iPod') > -1 || sUserAgent.indexOf('Symbian') > -1);\r\n}\r\n\r\n/** \r\n* param 将要转为URL参数字符串的对象 \r\n* key URL参数字符串的前缀 \r\n* encode true/false 是否进行URL编码,默认为true \r\n*  \r\n* return URL参数字符串 \r\n*/\r\nexport function urlEncode(param, key, encode) {\r\n  if (param == null) return '';\r\n  var paramStr = '';\r\n  var t = typeof (param);\r\n  if (t === 'string' || t === 'number' || t === 'boolean') {\r\n    paramStr += '&' + key + '=' + ((encode == null || encode) ? encodeURIComponent(param) : param);\r\n  } else {\r\n    for (var i in param) {\r\n      var k = key == null ? i : key + (param instanceof Array ? '[' + i + ']' : '.' + i);\r\n      paramStr += urlEncode(param[i], k, encode);\r\n    }\r\n  }\r\n  return paramStr;\r\n};\r\n\r\nexport function urlEncode2(obj) {\r\n  try {\r\n    return JSON.stringify(obj).replace(/:/g, \"=\").replace(/\"/g, '').replace(/,/g, '&').match(/\\{([^)]*)\\}/)[1];\r\n  } catch (e) {\r\n    console.error(e);\r\n    return \"\";\r\n  }\r\n}\r\n\r\nexport function parseTimePoint(time) {\r\n  return moment(time).format('LLLL');\r\n}\r\n\r\nexport function parseTimePeriod(time) {\r\n  return moment.duration(time).humanize();\r\n}\r\n\r\nexport function getTextFieldValue(el) {\r\n  return el.current.childNodes[el.current.childElementCount - 1].childNodes[0].value;\r\n}\r\n\r\nexport function sleep(time_ms) {\r\n  return new Promise(accept => {\r\n    setTimeout(accept, time_ms);\r\n  });\r\n}\r\n\r\n// 设置到本周的星期几\r\nDate.prototype.setDay = function (day) {\r\n  let day_ = this.getDay();\r\n  if (day_ === day) return this;\r\n  this.setTime(this.getTime() + 1000 * 60 * 60 * 24 * (day - day_));\r\n  return this;\r\n};\r\n\r\n// 获取 YYYY-MM-DD 格式\r\nDate.prototype.toDateString = function () {\r\n  return this.toISOString().slice(0, 10);\r\n};\r\n\r\n// export function cutString(str, length=10)\r\n\r\nexport function isIterator(obj) {\r\n  return obj != null && typeof obj[Symbol.iterator] === 'function';\r\n}\r\n\r\n// 下载文件方法\r\nexport function funDownload(content, filename) {\r\n  var eleLink = document.createElement('a');\r\n  eleLink.download = filename;\r\n  eleLink.style.display = 'none';\r\n  // 字符内容转变成blob地址\r\n  var blob = new Blob([content]);\r\n  eleLink.href = URL.createObjectURL(blob);\r\n  // 触发点击\r\n  document.body.appendChild(eleLink);\r\n  eleLink.click();\r\n  // 然后移除\r\n  document.body.removeChild(eleLink);\r\n};\r\n\r\n\r\nexport function deepCopy(data) {\r\n  if (data === null || data === undefined) {\r\n    return data;\r\n  } if (isIterator(data) && typeof (data) !== \"string\") {\r\n    let d = [];\r\n    for (let i = 0; i < data.length; i++) {\r\n      d.push(data[i]);\r\n    }\r\n    return d;\r\n  } else if (typeof (data) === \"object\") {\r\n    let d = {};\r\n    for (const k in data) {\r\n      d[k] = deepCopy(data[k]);\r\n    }\r\n    return d;\r\n  } else {\r\n    return data;\r\n  }\r\n}\r\n\r\nexport function objectUpdate(origin, update) {\r\n  if (!origin && !update) return null;\r\n  let now = deepCopy(origin);\r\n  if (!now) now = {};\r\n  for (const k in update) {\r\n    now[k] = update[k];\r\n  }\r\n  return now;\r\n}\r\n\r\n// https://www.jianshu.com/p/7407bd65b15d\r\nexport function isObjectValueEqual(a, b) {\r\n  var aProps = Object.getOwnPropertyNames(a);\r\n  var bProps = Object.getOwnPropertyNames(b);\r\n  if (aProps.length !== bProps.length) {\r\n    return false;\r\n  }\r\n  for (var i = 0; i < aProps.length; i++) {\r\n    var propName = aProps[i]\r\n\r\n    var propA = a[propName]\r\n    var propB = b[propName]\r\n    // 2020-11-18更新，这里忽略了值为undefined的情况\r\n    // 故先判断两边都有相同键名\r\n    if (!b.hasOwnProperty(propName)) return false\r\n    if ((propA instanceof Object)) {\r\n      if (isObjectValueEqual(propA, propB)) {\r\n        // return true     这里不能return ,后面的对象还没判断\r\n      } else {\r\n        return false\r\n      }\r\n    } else if (propA !== propB) {\r\n      return false\r\n    } else { }\r\n  }\r\n  return true\r\n}\r\n\r\n// Array.prototype.indexOf = function (val) {\r\n//   for (var i = 0; i < this.length; i++) {\r\n//     if (this[i] == val) return i;\r\n//   }\r\n//   return -1;\r\n// };\r\n\r\n// Array.prototype.remove = function (val) {\r\n//   var index = this.indexOf(val);\r\n//   if (index > -1) {\r\n//     this.splice(index, 1);\r\n//   }\r\n// };\r\n\r\n// Array.prototype.removeIndex = function (index) {\r\n//   this.splice(index, 1);\r\n// };\r\n\r\n// export function arrayRemove(array, data) {\r\n//   if (!isIterator(array)) return;\r\n//   const index = array.indexOf(data);\r\n//   if (index > -1) {\r\n//     array.slice(index, 1);\r\n//   }\r\n// }\r\n\r\nexport const timedeltaUnits = {\r\n  \"秒\": 1, \"分\": 60, \"时\": 60 * 60,\r\n  \"天\": 24 * 60 * 60, \"周\": 7 * 24 * 60 * 60\r\n};\r\n\r\n\r\nexport function getTimedeltaUnit(timedelta) {\r\n  if (typeof (timedelta) !== 'number') return null;\r\n  if (timedelta >= timedeltaUnits[Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1]])\r\n    return Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1];\r\n  for (let i = 1; i < Object.keys(timedeltaUnits).length; i++) {\r\n    if (timedelta < timedeltaUnits[Object.keys(timedeltaUnits)[i]]) {\r\n      return Object.keys(timedeltaUnits)[i - 1];\r\n    }\r\n  }\r\n  return Object.keys(timedeltaUnits)[0];\r\n}\r\n\r\nexport function getTimedeltaString(timedelta) {\r\n  if (typeof (timedelta) !== 'number') return \"\";\r\n  const unit = getTimedeltaUnit(timedelta);\r\n  if (unit === null) return \"\";\r\n  // console.log(\"unit\", unit);\r\n  return `${(timedelta / timedeltaUnits[unit]).toFixed(2)}${unit}`;\r\n}\r\n\r\nexport const weekDayList = ['日', '一', '二', '三', '四', '五', '六'];\r\n\r\nexport function isChinese(temp) {\r\n  var re = /[^\\u4E00-\\u9FA5]/;\r\n  if (re.test(temp)) return false;\r\n  return true;\r\n}\r\n\r\n\r\nexport function getNewNumberString(value) {\r\n  const newValue = value.length === 0 ? 0 : parseFloat(value);\r\n  if (isNaN(newValue)) return null;\r\n  return newValue;\r\n}\r\n\r\nexport function formatDateTime(value) {\r\n  return moment(value).format(\"YYYY-MM-DDTHH:mm:ss.SSSSSS+08:00\");\r\n}","import { objectUpdate } from \"../utils/utils\";\r\nimport store from \"./store\";\r\n\r\nexport function setConfig(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_CONFIG\", data: data });\r\n  };\r\n}\r\n\r\nexport function setTasks(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_TASKS\", data: data });\r\n  };\r\n}\r\n\r\nexport function setUser(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_USER\", data: data });\r\n  };\r\n}\r\n\r\nexport function setDaemon(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_DAEMON\", data: data });\r\n  };\r\n}\r\n\r\nexport function setErrorInfo(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_ERROR_INFO\", data: data });\r\n  };\r\n}\r\n\r\nexport function setMessage(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_MESSAGE\", data: data });\r\n  };\r\n}\r\n\r\nexport function setTypes(data) {\r\n  return dispatch => {\r\n    dispatch({ type: \"SET_TYPES\", data: data });\r\n  };\r\n}\r\n\r\n\r\nexport function updateTypes(type, typeData) {\r\n  return setTypes(objectUpdate(store.getState().types, { [type]: typeData }));\r\n}\r\n","import { setConfig, setDaemon, setErrorInfo, setUser } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { isIterator, urlEncode } from \"../utils/utils\"\r\n\r\n\r\nclass API {\r\n  constructor() {\r\n    // this.host = '127.0.0.1';\r\n    this.host = window.location.href.includes(\"localhost\") ? \"localhost\" : null;\r\n    // this.port = 8080;\r\n    this.port = 8880;\r\n    this.api_version = \"v2\";\r\n    this.api_prefix = `/api/${this.api_version}`;\r\n    this.protocol = 'http'\r\n    this.url = this.host ? `${this.protocol}://${this.host}:${this.port}${this.api_prefix}` : `${this.api_prefix}`;\r\n    this.access_token = '';\r\n    this.refresh_token = '';\r\n  }\r\n  set_token(access_token, refresh_token) {\r\n    // this.access_token = access_token || this.access_token;\r\n    // this.refresh_token = refresh_token || this.refresh_token;\r\n    if (access_token !== undefined)\r\n      this.access_token = access_token;\r\n    if (refresh_token !== undefined)\r\n      this.refresh_token = refresh_token;\r\n  }\r\n  get_token() {\r\n    return {\r\n      access_token: this.access_token === '' ? undefined : this.access_token, refresh_token: this.refresh_token === '' ? undefined : this.refresh_token\r\n    }\r\n  }\r\n  request_key(router, key, method = \"GET\", data) {\r\n    return this.request(`${router}/${key}`, method, data);\r\n  }\r\n  update_config() {\r\n    let config = store.getState().config;\r\n    config.data.api_token = this.get_token();\r\n    console.log('config.data.api_token', config.data.api_token)\r\n    // config.save();\r\n    store.dispatch(setConfig(config));\r\n  }\r\n  load_from_config() {\r\n    const config = store.getState().config;\r\n    this.set_token(config.data.api_token.access_token, config.data.api_token.refresh_token);\r\n  }\r\n  get_headers(refresh = false, access = true) {\r\n    let headers = {\r\n      'Content-Type': 'application/json',\r\n    };\r\n    if (refresh) {\r\n      headers['Refresh'] = this.refresh_token;\r\n    }\r\n    if (access) {\r\n      if (this.access_token !== '') headers['Authorization'] = this.access_token;\r\n    }\r\n    return headers;\r\n  }\r\n  async request(router, method = \"GET\", data) {\r\n    const payload = {\r\n      method: method,\r\n      mode: 'cors',\r\n      body: data ? JSON.stringify(data) : undefined,\r\n      // 注销的时候自带 refresh_token\r\n      headers: this.get_headers(Boolean(router === 'session' && method === 'DELETE')),\r\n    };\r\n    // console.log('request', router, method, data, payload);\r\n    // console.log(`${this.url}/${router}`);\r\n    let resp = null;\r\n    try {\r\n      resp = await fetch(`${this.url}/${router}`, payload);\r\n    } catch (e) {\r\n      console.error(e);\r\n      store.dispatch(setErrorInfo(e));\r\n      resp = { status: 433, error: \"Error when fetching internet\" };\r\n      return { code: resp.status, error: resp.statusText };\r\n    }\r\n    let js = null;\r\n    try { js = await resp.json(); } catch (e) {\r\n      console.error(e);\r\n      store.dispatch(setErrorInfo(e));\r\n      return { code: resp.status, error: resp.statusText };\r\n    }\r\n    console.log('raw js:', js);\r\n    if (!js) {\r\n      // console.log(await resp.json());\r\n      js = {};\r\n      js.message = resp.statusText;\r\n    }\r\n    if (js.code === undefined) js.code = resp.status;\r\n    if (js.code === 422) {\r\n      if (this.refresh_token === '') {\r\n        // 过期勒\r\n        return null;\r\n      }\r\n      // ac_token到期，准备更新\r\n      // console.log(this.get_headers(true));\r\n      const resp2 = await fetch(`${this.url}/session`, {\r\n        method: 'GET',\r\n        mode: 'cors',\r\n        headers: this.get_headers(true),\r\n        // body: JSON.stringify({ refresh_token: this.refresh_token })\r\n      });\r\n      try {\r\n        const js2 = await resp2.json();\r\n        // console.log('updating ac_token', js2);\r\n        if (js2.code === 200) {\r\n          this.set_token(js2.data.access_token, js2.data.refresh_token);\r\n          this.update_config();\r\n          // 更新user\r\n          const res = this.request('user', 'GET');\r\n          if (res.code === 200) {\r\n            store.dispatch(setUser(res.data.user));\r\n          }\r\n        }\r\n        else {\r\n          // 判定为 update_token 也过期，要求重新登录\r\n          store.dispatch(setErrorInfo(\"登录过期，请重新登录\"));\r\n          return null;\r\n        }\r\n      } catch (e) {\r\n        // console.error(e);\r\n        return { code: resp2.status, error: resp2.statusText };\r\n      }\r\n      return this.request(router, method, data);\r\n    } else if (js.code === 424) {\r\n      // 需要重新远程登录了\r\n      store.dispatch(setDaemon(null));\r\n      // store.dispatch(setUser(null));\r\n      await this.request(\"remote_login\", \"DELETE\");\r\n      const config = store.getState().config;\r\n      // this.set_token('', '');\r\n      config.save();\r\n      // window.location.reload();\r\n      store.dispatch(setConfig(config));\r\n      store.dispatch(setErrorInfo(\"远程登录失效，请重新登录美团账号\"));\r\n      return js;\r\n    } else if (js.code === 200) {\r\n      // 登录自动储存 JWT 数据\r\n      if (router === 'session' && method === 'POST') {\r\n        const { access_token, refresh_token } = js.data;\r\n        // console.log('jwt', access_token, refresh_token);\r\n        this.set_token(access_token, refresh_token);\r\n        this.update_config();\r\n      } else if (router === 'session' && method === 'DELETE') {\r\n        // 注销\r\n        // console.warn('注销');\r\n        this.set_token('', '');\r\n        this.update_config();\r\n      }\r\n    } else {\r\n      store.dispatch(setErrorInfo(js));\r\n    }\r\n    return js;\r\n  }\r\n}\r\n\r\nconst api = new API();\r\n\r\nexport { API, api };","import { createMuiTheme, makeStyles, ThemeProvider } from '@material-ui/core/styles';\r\nimport { orange, grey, blueGrey } from '@material-ui/core/colors';\r\nimport { api } from \"./api/api\";\r\n\r\nconst ITEM_NAME = \"group_bying_config\";\r\n\r\nclass Config {\r\n  constructor() {\r\n    this.load = this.load.bind(this);\r\n    this.save = this.save.bind(this);\r\n    this.theme_avaliable = {\r\n      \"默认主题\": createMuiTheme({}),\r\n      '黑暗模式': createMuiTheme({\r\n        palette: {\r\n          type: \"dark\",\r\n          primary: {\r\n            main: blueGrey[500],\r\n          },\r\n          secondary: {\r\n            main: grey[500],\r\n          },\r\n        },\r\n      }),\r\n    }\r\n    // 在构造函数执行的时候加载保存的数据\r\n    this.data_default = {\r\n      debug: false,\r\n      version_frontend: 0.1,\r\n      // 显示主题\r\n      // theme_name: \"黑暗模式\",\r\n      theme_name: \"默认主题\",\r\n      theme_avaliable: [\r\n        '默认主题',\r\n        '黑暗模式'\r\n      ],\r\n      // 设置同步\r\n      settings_async: true,\r\n      // 远程登录服务器\r\n      remote_login: {\r\n        server: \"ws://127.0.0.1:8081\"\r\n      },\r\n      api_token: {}\r\n    };\r\n    this.data = this.data_default;\r\n    this.theme = this.theme_avaliable[\"默认主题\"];\r\n    this.load();\r\n  }\r\n\r\n  load() {\r\n    console.log(\"Config: loading config...\");\r\n    if (this.data.debug) {\r\n      console.log(\"Config: load default config.\");\r\n      this.save();\r\n    }\r\n    try {\r\n      this.data = JSON.parse(localStorage.getItem(ITEM_NAME));\r\n      if (!this.data) throw new Error(\"Null data\");\r\n      console.log(\"Got data:\", this.data);\r\n      if (!this.data.version_frontend || this.data.version_frontend < this.data_default.version_frontend) {\r\n        // 版本升级，增量更新\r\n        console.log(`Config: update ${this.data.version_frontend} -> ${this.data_default.version_frontend}`);\r\n        this.data.version_frontend = this.data_default.version_frontend;\r\n        for (let k in this.data_default) {\r\n          if (!this.data[k]) {\r\n            console.log(`    Config: add value ${k}`);\r\n            this.data[k] = this.data_default[k];\r\n          }\r\n        }\r\n        this.save();\r\n      }\r\n    } catch (e) {\r\n      console.warn(`Can not find ${ITEM_NAME} in localStorage, use default config.`);\r\n      this.data = this.data_default;\r\n      this.save();\r\n    }\r\n    this.theme = this.theme_avaliable[this.data.theme_name];\r\n    if (!this.theme) this.theme = this.theme_avaliable[\"default\"];\r\n    api.set_token(this.data.api_token.access_token, this.data.api_token.refresh_token);\r\n  }\r\n\r\n  save() {\r\n    console.log(\"Config: saving config...\");\r\n    this.data.api_token = api.get_token();\r\n    const s = JSON.stringify(this.data);\r\n    localStorage.setItem(ITEM_NAME, s);\r\n    return s;\r\n  }\r\n\r\n  static clear() {\r\n    console.log(\"Config: clearing all data...\");\r\n    localStorage.setItem(ITEM_NAME, undefined);\r\n  }\r\n};\r\n\r\nexport default Config;","import { combineReducers } from 'redux'\r\nimport Config from \"../Config\"\r\n\r\nconst defaultState = {\r\n  config: new Config(),\r\n  tasks: [],\r\n  user: null,\r\n  daemon: null,\r\n  errorInfo: null,\r\n  message: null,\r\n  types: {},\r\n}\r\n\r\nfunction types(state = defaultState.types, action) {\r\n  switch (action.type) {\r\n    case \"SET_TYPES\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction config(state = defaultState.config, action) {\r\n  switch (action.type) {\r\n    case \"SET_CONFIG\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction user(state = defaultState.user, action) {\r\n  switch (action.type) {\r\n    case \"SET_USER\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction tasks(state = defaultState.tasks, action) {\r\n  switch (action.type) {\r\n    case \"SET_TASKS\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction daemon(state = defaultState.daemon, action) {\r\n  switch (action.type) {\r\n    case \"SET_DAEMON\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction errorInfo(state = defaultState.errorInfo, action) {\r\n  switch (action.type) {\r\n    case \"SET_ERROR_INFO\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction message(state = defaultState.message, action) {\r\n  switch (action.type) {\r\n    case \"SET_MESSAGE\":\r\n      return action.data;\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nexport default combineReducers({ config, errorInfo, message, daemon, user, tasks, types });\r\n","// applyMiddleware: redux通过该函数来使用中间件\r\n// createStore: 用于创建store实例\r\nimport { applyMiddleware, createStore } from 'redux'\r\n\r\n// 中间件，作用：如果不使用该中间件，当我们dispatch一个action时，需要给dispatch函数传入action        \r\n// 对象；但如果我们使用了这个中间件，那么就可以传入一个函数，这个函数接收两个参数:dispatch和    \r\n// getState。这个dispatch可以在将来的异步请求完成后使用，对于异步action很有用\r\nimport thunk from 'redux-thunk'\r\n\r\n// 引入reducer\r\nimport reducers from './reducers.js'\r\n\r\n// 创建store实例\r\nlet store = createStore(\r\n    reducers,\r\n    applyMiddleware(thunk)\r\n)\r\nexport default store","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { ListItem, ListItemText, ListItemIcon } from '@material-ui/core';\r\nimport { Link as RouterLink } from \"react-router-dom\";\r\n\r\nlet updated = false;\r\n\r\nfunction ListItemLink(props) {\r\n  const { icon, primary, to, onClick } = props;\r\n\r\n  const renderLink = React.useMemo(\r\n    () => React.forwardRef((itemProps, ref) => <RouterLink to={to} ref={ref} {...itemProps} />),\r\n    [to],\r\n  );\r\n\r\n  if (!updated) {\r\n    updated = true;\r\n    document.title = `${primary} - 团购杀手`;\r\n  }\r\n\r\n  return (\r\n    <li>\r\n      <ListItem button component={renderLink} onClick={() => {\r\n        document.title = `${primary} - 团购杀手`;\r\n        onClick && onClick();\r\n      }}>\r\n        {icon ? <ListItemIcon>{icon}</ListItemIcon> : null}\r\n        <ListItemText primary={primary} />\r\n      </ListItem>\r\n    </li>\r\n  );\r\n}\r\n\r\nListItemLink.propTypes = {\r\n  icon: PropTypes.element,\r\n  primary: PropTypes.string.isRequired,\r\n  to: PropTypes.string.isRequired,\r\n};\r\n\r\nexport default ListItemLink;\r\n\r\n","import { Select, Box, Button, Container, Dialog, DialogActions, DialogContent, DialogTitle, List, ListItem, ListItemSecondaryAction, ListItemText, TextField, Typography, MenuItem, IconButton } from \"@material-ui/core\";\r\nimport { DateTimePicker } from \"@material-ui/pickers\";\r\nimport React from \"react\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport store from \"../data/store\";\r\nimport { formatDateTime, getNewNumberString, isIterator, objectUpdate, timedeltaUnits } from \"../utils/utils\";\r\nimport moment from \"moment\";\r\n\r\nexport function ActionData(props) {\r\n  const { value, onChange, onDelete } = props;\r\n  return <Box>\r\n    {value === null || value === undefined || value === 'datetime|' ?\r\n      <Button color=\"secondary\" onClick={() => { onChange && onChange(null); }}>点击设置</Button> :\r\n      <Box style={{ display: \"flex\", flexDirection: \"row\" }}>\r\n        <DateTimePicker\r\n          value={value.slice(\"datetime|\".length)}\r\n          onChange={onChange}\r\n        ></DateTimePicker>\r\n        <IconButton onClick={onDelete}>\r\n          <DeleteIcon></DeleteIcon>\r\n        </IconButton>\r\n      </Box>}\r\n  </Box>;\r\n}\r\n\r\nexport default function ListEdit(props) {\r\n  const { defaultValue, open, onClose, title, keyNames, dataType, typeName } = props;\r\n  const dismiss = props.dismiss && isIterator(props.dismiss) ? props.dismiss : [];\r\n  const onSave = props.onSave ? props.onSave : null;\r\n  const [data, setInnerData] = React.useState(defaultValue);\r\n  const setData = (update) => setInnerData(objectUpdate(data, update));\r\n  const [openChild, setOpenChild] = React.useState(false);\r\n  const [child, setChild] = React.useState(null);\r\n  const [childTitle, setChildTitle] = React.useState(null);\r\n  const [timedeltaUnit, setTimedeltaUnit] = React.useState({});\r\n\r\n  const handleSave = () => {\r\n    onSave && onSave(data);\r\n  }\r\n\r\n  return <Dialog fullWidth open={open} onClose={onClose}>\r\n    <DialogTitle>{title}</DialogTitle>\r\n    <DialogContent>\r\n      <List style={{ width: \"100%\" }}>\r\n        {Object.keys(data).map((v, k) => {\r\n          if (dismiss.indexOf(v) >= 0) return null;\r\n          // console.log(\"store.getState().types\", store.getState().types);\r\n          // console.log(\"typeName\", typeName, \"dataType\", dataType);\r\n          const args = dataType && typeName && store.getState().types && store.getState().types[typeName] &&\r\n          store.getState().types[typeName][dataType] && store.getState().types[typeName][dataType].args &&\r\n          store.getState().types[typeName][dataType].args[v] ?\r\n            store.getState().types[typeName][dataType].args[v] : null;\r\n          // console.log('v', v, 'args', args);\r\n          if (dataType && typeName && args && !args.editable) return null;\r\n          const showName = keyNames ? (keyNames[v] || v) : (v);\r\n          // if (((typeof (data[v]) !== \"string\")) && !data[v]) return undefined;\r\n          let value = data[v];\r\n          if ((!value && typeof (value) !== \"number\") && dataType && typeName && args) {\r\n            value = `${args.type}|${args.value ? args.value : ''}`;\r\n          }\r\n          // console.log('v', v, 'args', args, 'value', value);\r\n          if (typeof (value) === 'object') {\r\n            return <ListItem key={v} button onClick={() => {\r\n              setChild(value);\r\n              setChildTitle(showName);\r\n              setOpenChild(true);\r\n            }}>{showName}</ListItem>\r\n          } else {\r\n            let actionData = null;\r\n            if (typeof (value) === \"string\" && value.startsWith(\"timezone|\")) {\r\n              // 时区暂时不可编辑\r\n              actionData = value.slice(\"timezone|\".length);\r\n            } else if (typeof (value) === \"string\" && value.startsWith(\"datetime|\")) {\r\n              // console.log('datetime:', value);\r\n              if (value === 'datetime|') {\r\n                actionData = <Button onClick={() => {\r\n                  setData({ [v]: `datetime|${new Date().toISOString()}` });\r\n                }}>点击设置</Button>;\r\n              } else {\r\n                actionData = <ActionData value={value} onChange={e => {\r\n                  console.log(\"e\", e);\r\n                  // 这里会改变到没有时区的类型\r\n                  console.log(`datetime|${formatDateTime(e)}`);\r\n                  setData({ [v]: `datetime|${formatDateTime(e)}` });\r\n                }} onDelete={() => {\r\n                  setData({ [v]: null });\r\n                }}></ActionData>\r\n              }\r\n            } else if (typeof (value) === \"string\" && value.startsWith(\"timedelta|\")) {\r\n              const val = value.slice(\"timedelta|\".length);\r\n              const unit = timedeltaUnit[v] ? timedeltaUnit[v] : Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1];\r\n              const updateFixed = () => {\r\n                // const unit2 = timedeltaUnit[v] ? timedeltaUnit[v] : Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1];\r\n                // const newValue2 = `timedelta|${parseFloat(('' + (parseFloat(data[v].slice(\"timedelta|\".length)) / timedeltaUnits[unit2]).toFixed(2) * timedeltaUnits[unit2]))}`\r\n                // console.log(\"newValue2\", newValue2);\r\n                // setData({ [v]: newValue2 });\r\n              };\r\n              actionData = <Box>\r\n                <TextField value={`${parseFloat(val) / timedeltaUnits[unit]}`} onChange={e => {\r\n                  let val = e.target.value;\r\n                  if (isNaN(parseFloat(val)))\r\n                    if (val.length > 0) return;\r\n                    else val = 0;\r\n                  const newValue = `timedelta|${parseFloat(val) * timedeltaUnits[unit]}`;\r\n                  setData({ [v]: newValue });\r\n                }} onBlur={updateFixed}></TextField>\r\n                <Select value={unit}\r\n                  onChange={e => {\r\n                    setTimedeltaUnit(objectUpdate(timedeltaUnit, { [v]: e.target.value }));\r\n                  }} onBlur={updateFixed}>\r\n                  {Object.keys(timedeltaUnits).map((key, k) => <MenuItem key={key} value={key}>\r\n                    {key}\r\n                  </MenuItem>)}\r\n                </Select>\r\n              </Box>\r\n            } else if (args && args.type === 'select' && args.options) {\r\n              actionData = <Box style={{ display: \"flex\", flexDirection: 'row', justifyItems: 'center', justifyContent: 'center', alignContent: 'center' }}>\r\n                <Box>设定值</Box>\r\n                <Select value={value} onChange={e => {\r\n                  setData({ [v]: e.target.value });\r\n                }}>\r\n                  {Object.keys(args.options).map(key => <MenuItem key={key} value={key}>{args.options[key]}</MenuItem>)}\r\n                </Select>\r\n                <Box>库存量</Box>\r\n              </Box>;\r\n            } else {\r\n              actionData = <TextField value={`${value}`} onChange={e => {\r\n                const newValue = typeof (value) === \"number\" ? getNewNumberString(e.target.value) : `${value}`;\r\n                if (newValue === null) return;\r\n                setData({ [v]: newValue });\r\n              }}></TextField>;\r\n            }\r\n            return <ListItem key={v}>\r\n              <ListItemText>{showName}</ListItemText>\r\n              <ListItemSecondaryAction>\r\n                {actionData}\r\n              </ListItemSecondaryAction>\r\n            </ListItem>;\r\n          }\r\n        }\r\n        )}\r\n      </List>\r\n      {(child && childTitle) ? <ListEdit defaultValue={child} open={openChild} onClose={() => { setOpenChild(false); }} title={childTitle}></ListEdit> : undefined}\r\n    </DialogContent>\r\n    {onSave ? <DialogActions>\r\n      <Button color=\"primary\" onClick={handleSave}>保存</Button>\r\n      <Button onClick={onClose}>取消</Button>\r\n    </DialogActions> : <DialogActions><Box style={{ width: \"100%\", height: \"100%\", display: \"flex\", justifyContent: \"center\" }}><Typography style={{ height: \"100%\" }} variant=\"body1\" color=\"secondary\">无法保存</Typography></Box></DialogActions>}\r\n  </Dialog>\r\n}","import { Container, Dialog, DialogContent, DialogTitle, List, ListItem, ListItemSecondaryAction, ListItemText, Typography } from \"@material-ui/core\";\r\nimport React from \"react\";\r\n\r\nexport default function ListInfo(props) {\r\n  const { data, open, onClose, title, keyNames } = props;\r\n  const [openChild, setOpenChild] = React.useState(false);\r\n  const [child, setChild] = React.useState(null);\r\n  const [childTitle, setChildTitle] = React.useState(null);\r\n  // console.log(data);\r\n  // Object.keys(data).map((v, k) => { console.log(`v: ${v}, k: ${k}`) })\r\n\r\n  return <Dialog fullWidth open={open} onClose={onClose}>\r\n    <DialogTitle>{title}</DialogTitle>\r\n    <DialogContent>\r\n      <List style={{ width: \"100%\" }}>\r\n        {Object.keys(data).map((v, k) => {\r\n          const showName = keyNames ? (keyNames[v] || v) : (v);\r\n          if (!data[v]) return undefined;\r\n          if (typeof (data[v]) === 'object') {\r\n            return <ListItem key={v} button onClick={() => {\r\n              setChild(data[v]);\r\n              setChildTitle(showName);\r\n              setOpenChild(true);\r\n            }}>{showName}</ListItem>\r\n          } else {\r\n            const s = `${data[v]}`;\r\n            return <ListItem key={v}>\r\n              <ListItemText>{showName}</ListItemText>\r\n              <ListItemSecondaryAction>\r\n                <Typography variant=\"body1\">{s.slice(0, 20) + (s.length > 20 ? \"...\" : \"\")}</Typography>\r\n              </ListItemSecondaryAction>\r\n            </ListItem>\r\n          }\r\n        }\r\n        )}\r\n      </List>\r\n      {(child && childTitle) ? <ListInfo data={child} open={openChild} onClose={() => { setOpenChild(false); }} title={childTitle}></ListInfo> : undefined}\r\n    </DialogContent>\r\n  </Dialog>\r\n}","import { Box, Grid, List, ListItem, Typography, Paper, Card, CardContent, CardActions, Button } from \"@material-ui/core\";\r\nimport moment from \"moment\";\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport { setTypes, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { deepCopy, isObjectValueEqual, objectUpdate } from \"../utils/utils\";\r\nimport ListEdit from \"./ListEdit\";\r\nimport ListInfo from \"./ListInfo\";\r\n\r\nconst keyNames = {\r\n  \"item_id\": \"目标项目ID\",\r\n  \"target_price\": \"目标价格\",\r\n  'price_relative': \"价格调整幅度(上调+x/下调-x元)\"\r\n};\r\n\r\nexport function isActionModified(item, type = \"actions\") {\r\n  try {\r\n    return !isObjectValueEqual(item.data, store.getState().types[type][item.type].data);\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n}\r\n\r\nexport function updateActionData(callback) {\r\n  return api.request(\"action\", 'GET').then(resp => {\r\n    // console.log(\"resp\", resp);\r\n    store.dispatch(updateTypes(\"actions\", resp.data.actions));\r\n    callback && callback(resp.data.actions);\r\n  });\r\n}\r\n\r\nexport async function wrapAction(action) {\r\n  const actionType = action.action_type;\r\n  let actionData = null;\r\n  if (!store.getState().types.actions || !store.getState().types.actions[actionType]) {\r\n    await updateActionData((newActionData) => { actionData = newActionData[actionType]; });\r\n  } else actionData = store.getState().types.actions[actionType];\r\n  if (!actionData) return null;\r\n  return objectUpdate(actionData, { data: action });\r\n}\r\n\r\n\r\nfunction getTimedeltaString(timedelta) {\r\n  if (typeof (timedelta) !== 'number') return \"\";\r\n  const timedeltaUnits = {\r\n    \"秒\": 1, \"分\": 60, \"时\": 60 * 60,\r\n    \"天\": 24 * 60 * 60, \"周\": 7 * 24 * 60 * 60\r\n  };\r\n  for (let i = 1; i < Object.keys(timedeltaUnits).length; i++) {\r\n    if (timedelta < timedeltaUnits[Object.keys(timedeltaUnits)[i]]) {\r\n      return `${(timedelta / timedeltaUnits[Object.keys(timedeltaUnits)[i - 1]]).toFixed(2)}${Object.keys(timedeltaUnits)[i - 1]}`;\r\n    }\r\n  }\r\n  return `${(timedelta / timedeltaUnits[Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1]]).toFixed(2)}${Object.keys(timedeltaUnits)[Object.keys(timedeltaUnits).length - 1]}`;\r\n}\r\n\r\nfunction getDataString(data, typeName, dataType) {\r\n  let res = \"\";\r\n  if (typeof (data) !== 'object') return;\r\n  for (const key in data) {\r\n    const showName = keyNames ? (keyNames[key] || key) : (key);\r\n    const args = dataType && typeName && store.getState().types && store.getState().types[typeName] &&\r\n      store.getState().types[typeName][dataType] && store.getState().types[typeName][dataType].args &&\r\n      store.getState().types[typeName][dataType].args[key] ?\r\n      store.getState().types[typeName][dataType].args[key] : null;\r\n    if (args && !args.editable) continue;\r\n    let value = data[key];\r\n    if (!value && typeof (value) !== 'number') continue;\r\n    if (typeof (value) === 'string') {\r\n      if (value.startsWith(\"datetime|\")) {\r\n        value = moment(value.slice('datetime|'.length)).calendar();\r\n      } else if (value.startsWith('timedelta|')) {\r\n        value = getTimedeltaString(parseFloat(value.slice('timedelta|'.length)));\r\n      }\r\n    }\r\n    res = `${(res.length === 0 ? '' : (res + '/'))}${showName}:${value}`\r\n  }\r\n  return res;\r\n}\r\n\r\nexport function ActionTag(props) {\r\n  let { action, selectMode, onClick, onSave, fullWidth, targets } = props;\r\n  const [dialogOpen, setDialogOpen] = React.useState(false);\r\n  // console.log('targets', targets);\r\n  console.log('action', action);\r\n  const [actionTemp, setActionTemp] = React.useState((() => {\r\n    if (action.data.action_type === \"adjust_price\" && targets && targets.roomItem) {\r\n      let tmp = deepCopy(action);\r\n      tmp.data.item_id = targets.roomItem.itemId;\r\n      tmp.data.target_price = targets.roomItem.price;\r\n      return tmp;\r\n    } else if (action.data.action_type === \"adjust_price_relative\" && targets && targets.roomItem) {\r\n      let tmp = deepCopy(action);\r\n      tmp.data.item_id = targets.roomItem.itemId;\r\n      tmp.data.price_relative = 0;\r\n      return tmp;\r\n    } else return action;\r\n  })());\r\n  const [toUse, setToUse] = React.useState(false);\r\n  onClick = onClick ? onClick : () => { };\r\n  if (!action) return null;\r\n  const handleCloseDialog = () => { setDialogOpen(false); };\r\n  const handleClick = newAction => {\r\n    let selected = deepCopy(newAction ? newAction : actionTemp);\r\n    console.log(\"selected action:\", selected);\r\n    onClick(selected, selectMode);\r\n  };\r\n\r\n  // console.log('To edit:', action, actionTemp);\r\n\r\n  return <Card style={{ minWidth: 200, margin: 10, width: (fullWidth ? \"100%\" : \"auto\") }}>\r\n    <CardContent onClick={selectMode ? () => { } : () => { handleClick(); }}>\r\n      <Typography variant=\"h5\">{action.name}</Typography>\r\n      {isActionModified(action, \"actions\") ?\r\n        getDataString(action.data, \"actions\", action.type) :\r\n        <Typography variant=\"body1\">{action.desc}</Typography>\r\n      }\r\n      <ListEdit\r\n        // dismiss={['version', 'timezone']}\r\n        keyNames={keyNames}\r\n        open={dialogOpen}\r\n        dataType={action.type}\r\n        typeName=\"actions\"\r\n        onClose={handleCloseDialog}\r\n        // defaultValue={action.data}\r\n        defaultValue={actionTemp.data}\r\n        onSave={newData => {\r\n          let newAction = deepCopy(action);\r\n          newAction.data = newData;\r\n          // if (action_type === 'adjust_price' && actions && actions.roomItem && targets.roomItem.parent) {\r\n          //   newAction.data.periodDesc = targets.roomItem.parent.periodDesc;\r\n          //   newAction.data.roomName = targets.roomItem.parent.roomType;\r\n          // }\r\n          console.log('newData', newData);\r\n          onSave && onSave(newAction);\r\n          handleCloseDialog();\r\n          if (toUse) handleClick(newAction);\r\n        }}></ListEdit>\r\n    </CardContent>\r\n    {selectMode ? <CardActions>\r\n      <Button color=\"primary\" onClick={selectMode ? () => { handleClick(); } : () => { }}>使用</Button>\r\n      <Button color=\"primary\" onClick={() => { setDialogOpen(true); setToUse(true); }}>修改设置并使用</Button>\r\n    </CardActions> : <CardActions>\r\n      <Button color={isActionModified(action, \"actions\") ? \"primary\" : \"secondary\"} onClick={() => { setDialogOpen(true); }}>修改设置</Button>\r\n    </CardActions>}\r\n  </Card>\r\n}\r\n\r\nexport default function Actions(props) {\r\n  let { selectMode, onClick, targets } = props;\r\n  onClick = onClick ? onClick : () => { };\r\n  const [requesting, setRequesting] = React.useState(false);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const actions = store.getState().types.actions;\r\n  console.log('targets', targets);\r\n  if (!actions && !requesting) {\r\n    setRequesting(true);\r\n    updateActionData().then(() => { forceUpdate(); });\r\n  }\r\n  // console.log('types', store.getState().types)\r\n  let content = null;\r\n  if (!actions) {\r\n    content = <Typography variant=\"body1\">正在加载Action类型...</Typography>\r\n  } else {\r\n    console.log(actions);\r\n    content = <Box style={{ display: \"flex\", flexDirection: \"row\", flexWrap: \"wrap\" }}>\r\n      {Object.keys(actions).map((action_type, k) => <ActionTag targets={targets} onClick={onClick} key={action_type} selectMode={selectMode} action={\r\n        (action_type.includes(\"adjust_price\") && targets && targets.roomItem && targets.roomItem.parent) ?\r\n          (() => {\r\n            let newAction = deepCopy(actions[action_type]);\r\n            newAction.data.periodDesc = targets.roomItem.parent.periodDesc;\r\n            newAction.data.roomName = targets.roomItem.roomType;\r\n            newAction.data.date = targets.roomItem.parent.date;\r\n            newAction.data.day = targets.roomItem.parent.day;\r\n            console.log('newAction', newAction);\r\n            return newAction;\r\n          })() : actions[action_type]}></ActionTag>)}\r\n    </Box>\r\n  }\r\n  return <Box>\r\n    {content}\r\n  </Box>\r\n}","import { Box, Grid, List, ListItem, Typography, Paper, Card, CardContent, CardActions, Button } from \"@material-ui/core\";\r\nimport moment from \"moment\";\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport { setTypes, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { deepCopy, getTimedeltaString, isObjectValueEqual, objectUpdate } from \"../utils/utils\";\r\nimport ListEdit from \"./ListEdit\";\r\nimport ListInfo from \"./ListInfo\";\r\n\r\nconst keyNames = {\r\n  'start_date': \"开始时间\",\r\n  'end_date': '结束时间',\r\n  \"interval\": \"间隔\",\r\n  \"run_date\": '运行时间',\r\n  'value': '设置值',\r\n  'operator': '比较方式'\r\n};\r\n\r\nexport function updateTriggerData(callback) {\r\n  return api.request(\"trigger\", 'GET').then(resp => {\r\n    // console.log(\"resp\", resp);\r\n    store.dispatch(updateTypes(\"triggers\", resp.data.triggers));\r\n    callback && callback(resp.data.triggers);\r\n  });\r\n}\r\n\r\nexport function isTriggerModified(item, type = \"triggers\") {\r\n  try {\r\n    return !isObjectValueEqual(item.data, store.getState().types[type][item.type].data);\r\n  } catch (e) {\r\n    return true;\r\n  }\r\n}\r\n\r\nexport function getTriggerType(trigger) {\r\n  if (trigger.interval) return 'interval';\r\n  if (trigger.run_date) return 'date';\r\n  return 'cron';\r\n}\r\n\r\nexport async function wrapTrigger(trigger) {\r\n  const triggerType = getTriggerType(trigger);\r\n  let triggerData = null;\r\n  if (!store.getState().types.triggers || !store.getState().types.triggers[triggerType]) {\r\n    await updateTriggerData((newTriggerData) => { triggerData = newTriggerData[triggerType] });\r\n  } else triggerData = store.getState().types.triggers[triggerType];\r\n  return objectUpdate(triggerData, { data: trigger });\r\n}\r\n\r\nfunction getDataString(data, typeName, dataType) {\r\n  let res = \"\";\r\n  if (typeof (data) !== 'object') return;\r\n  for (const key in data) {\r\n    const showName = keyNames ? (keyNames[key] || key) : (key);\r\n    const args = dataType && typeName && store.getState().types[typeName][dataType].args[key] ?\r\n      store.getState().types[typeName][dataType].args[key] : null;\r\n    if (args && !args.editable) continue;\r\n    let value = data[key];\r\n    if (!value) continue;\r\n    if (typeof(value) === 'string') {\r\n      if (value.startsWith(\"datetime|\")) {\r\n        value = moment(value.slice('datetime|'.length)).calendar();\r\n      } else if (value.startsWith('timedelta|')) {\r\n        value = getTimedeltaString(parseFloat(value.slice('timedelta|'.length)));\r\n      }\r\n    }\r\n    res = `${(res.length === 0 ? '' : (res + '/'))}${showName}:${value}`\r\n  }\r\n  return res;\r\n}\r\n\r\nexport function TriggerTag(props) {\r\n  let { trigger, selectMode, onClick, onSave, fullWidth } = props;\r\n  const [dialogOpen, setDialogOpen] = React.useState(false);\r\n  const [toUse, setToUse] = React.useState(false);\r\n  onClick = onClick ? onClick : () => { };\r\n  if (!trigger) return null;\r\n  const handleCloseDialog = () => { setDialogOpen(false); };\r\n  const handleClick = newTrigger => {\r\n    onClick(newTrigger ? newTrigger : trigger, selectMode);\r\n  };\r\n\r\n  console.log('bug trigger', trigger);\r\n  return <Card style={{ minWidth: 200, margin: 10, width: (fullWidth ? \"100%\" : \"auto\") }}>\r\n    <CardContent onClick={selectMode ? () => { } : () => { handleClick(); }}>\r\n      <Typography variant=\"h5\">{trigger.name}</Typography>\r\n      {isTriggerModified(trigger, \"triggers\") ?\r\n        getDataString(trigger.data, \"triggers\", trigger.type) :\r\n        <Typography variant=\"body1\">{trigger.desc}</Typography>\r\n      }\r\n      <ListEdit\r\n        dismiss={['version', 'timezone']}\r\n        keyNames={keyNames}\r\n        open={dialogOpen}\r\n        dataType={trigger.type}\r\n        typeName=\"triggers\"\r\n        onClose={handleCloseDialog}\r\n        defaultValue={trigger.data}\r\n        onSave={newData => {\r\n          let newTrigger = deepCopy(trigger);\r\n          newTrigger.data = newData;\r\n          console.log(newData);\r\n          onSave && onSave(newTrigger);\r\n          handleCloseDialog();\r\n          if (toUse) handleClick(newTrigger);\r\n        }}></ListEdit>\r\n    </CardContent>\r\n    {selectMode ? <CardActions>\r\n      <Button color=\"primary\" onClick={selectMode ? () => { handleClick(); } : () => { }}>使用</Button>\r\n      <Button color=\"primary\" onClick={() => { setDialogOpen(true); setToUse(true); }}>修改设置并使用</Button>\r\n    </CardActions> : <CardActions>\r\n      <Button color={isTriggerModified(trigger, \"triggers\") ? \"primary\" : \"secondary\"} onClick={() => { setDialogOpen(true); }}>修改设置</Button>\r\n    </CardActions>}\r\n  </Card>\r\n}\r\n\r\nexport default function Triggers(props) {\r\n  let { selectMode, onClick } = props;\r\n  onClick = onClick ? onClick : () => { };\r\n  const [requesting, setRequesting] = React.useState(false);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const triggers = store.getState().types.triggers;\r\n  if (!triggers && !requesting) {\r\n    setRequesting(true);\r\n    updateTriggerData().then(() => { forceUpdate(); });\r\n  }\r\n  console.log('types', store.getState().types)\r\n  let content = null;\r\n  if (!triggers) {\r\n    content = <Typography variant=\"body1\">正在加载触发器类型...</Typography>\r\n  } else {\r\n    content = <Box style={{ display: \"flex\", flexDirection: \"row\", flexWrap: \"wrap\" }}>\r\n      {Object.keys(triggers).map((trigger_type, k) => <TriggerTag onClick={onClick} key={trigger_type} selectMode={selectMode} trigger={triggers[trigger_type]}></TriggerTag>)}\r\n    </Box>\r\n  }\r\n  return <Box>\r\n    {content}\r\n  </Box>\r\n}","import { Select, Box, Button, Checkbox, Collapse, Container, Dialog, DialogActions, DialogContent, DialogTitle, Grid, IconButton, List, ListItem, ListItemSecondaryAction, ListItemText, ListSubheader, makeStyles, TextField, Typography, MenuItem } from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport moment from \"moment\";\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport Actions, { wrapAction } from \"../components/Actions\";\r\nimport { ActionTag, updateActionData, isActionModified } from \"../components/Actions\";\r\nimport Triggers, { updateTriggerData, wrapTrigger } from \"../components/Triggers\";\r\nimport { TriggerTag, isTriggerModified } from \"../components/Triggers\";\r\nimport { setErrorInfo, setMessage, setTasks, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { arrayRemove, deepCopy, formatDateTime, getNewNumberString, isObjectValueEqual, objectUpdate, timedeltaUnits } from \"../utils/utils\";\r\nimport { ActionData } from \"./ListEdit\";\r\n\r\nlet taskDialogUpdate = false;\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  nested: {\r\n    paddingLeft: theme.spacing(4),\r\n  },\r\n  centerText: {\r\n    display: 'flex',\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    // overflow: 'hidden',\r\n    whiteSpace: 'nowrap',\r\n  }\r\n}));\r\n\r\nexport function setTaskDialogUpdate(val) { taskDialogUpdate = val; }\r\n\r\nlet roomItemUpdated = false;\r\n\r\nexport default function TaskDialog(props) {\r\n  const classes = useStyles();\r\n  const { addMode, open, onClose, onRefresh, onSave, targets, simpleMode } = props;\r\n  const taskOld = props.taskOld === true ? null : props.taskOld;\r\n  console.log('targets', targets);\r\n  const baseTaskName = (targets && targets.taskName) ? targets.taskName : '未命名任务';\r\n  const realDefaultTask = {\r\n    task_name: baseTaskName,\r\n    triggers: [],\r\n    actions: [],\r\n  };\r\n  const defaultTask = addMode ? (props.defaultTask ? props.defaultTask : realDefaultTask) : taskOld ? taskOld : (props.defaultTask ? props.defaultTask : realDefaultTask);\r\n  const defaultCollapseOpen = {\r\n    timenode: false,\r\n    cycle: false,\r\n    stock: false\r\n  };\r\n  const defaultOperations = {\r\n    '>': '大于',\r\n    '<': '小于',\r\n    '==': \"等于\",\r\n    '>=': '大于等于',\r\n    '<=': \"小于等于\",\r\n    '!=': '不等于'\r\n  };\r\n  const [state, setInnerState] = React.useState({\r\n    dialogAddTaskOpen: false,\r\n    dialogAddTriggerOpen: false,\r\n    dialogAddActionOpen: false,\r\n    dialogUpdateTrigger: false,\r\n    task: defaultTask,\r\n    requestingTaskData: false,\r\n    defaultTid: null,\r\n    useSimpleMode: simpleMode,\r\n    collapseOpen: defaultCollapseOpen,\r\n    simpleData: {\r\n      timenodeTime: `datetime|${formatDateTime(new Date())}`,\r\n      timenodePrice: 100,\r\n      cycleTime: `timedelta|${timedeltaUnits[\"周\"]}`,\r\n      cyclePrice: 100,\r\n      stockOperator: '>',\r\n      stockPrice: 100,\r\n      stockValue: 5\r\n    }\r\n  });\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n  const setCollapseToggle = (name) => {\r\n    // setState({ collapseOpen: objectUpdate(state.collapseOpen, { [name]: !state.collapseOpen[name] }) });\r\n    setState({ collapseOpen: objectUpdate(defaultCollapseOpen, { [name]: !state.collapseOpen[name] }) });\r\n  }\r\n  // console.log('baseTaskName', baseTaskName, 'defaultTask', defaultTask);\r\n  // console.log('state', state);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const taskData = store.getState().types.task_data;\r\n  if (!roomItemUpdated && targets && targets.roomItem) {\r\n    roomItemUpdated = true;\r\n    try {\r\n      setState({\r\n        simpleData: objectUpdate(state.simpleData, {\r\n          timenodePrice: targets && targets.roomItem ? targets.roomItem.price : state.simpleData.timenodePrice,\r\n          cyclePrice: targets && targets.roomItem ? targets.roomItem.price : state.simpleData.cyclePrice\r\n        })\r\n      });\r\n    } catch (e) {\r\n      roomItemUpdated = false;\r\n      console.error(e);\r\n    }\r\n  }\r\n\r\n  // console.log('taskNow', state.task);\r\n  if (!addMode && (taskDialogUpdate || (isObjectValueEqual(state.task, realDefaultTask) && !isObjectValueEqual(defaultTask, realDefaultTask)))) {\r\n    taskDialogUpdate = false;\r\n    setState({ task: defaultTask });\r\n  } else if (taskDialogUpdate) {\r\n    taskDialogUpdate = false;\r\n    setState({ task: defaultTask });\r\n  }\r\n\r\n  if (!state.requestingTaskData && !taskData) {\r\n    setState({ requestingTaskData: true });\r\n    api.request(\"task\", 'PATCH').then(resp => {\r\n      // console.log(\"resp\", resp);\r\n      let taskData = resp.data.task_data;\r\n      taskData.tid = null;\r\n      store.dispatch(updateTypes(\"task_data\", taskData));\r\n      forceUpdate();\r\n    })\r\n  }\r\n\r\n  const handleAddTask = addMode ? () => {\r\n    // console.log('pass#2');\r\n    if (!taskData) {\r\n      setErrorInfo(\"Task数据为空。\");\r\n      console.error(\"Task数据为空。\");\r\n      return;\r\n    }\r\n    // const task = objectUpdate(taskData, { triggers: state.task.triggers, actions: state.task.actions, task_name: state.task.task_name, tid: null, });\r\n    const task = objectUpdate(taskData, state.task);\r\n    console.log('task', task);\r\n    return api.request('task', \"POST\", { task }).then(resp => {\r\n      // console.log('resp', resp);\r\n      if (resp.code !== 200) return;\r\n      const defaultTid = resp.data.tid ? (resp.data.tid + 1) : null;\r\n      setState({\r\n        defaultTid,\r\n        taskName: store.getState().types.task_data ? `${baseTaskName}${defaultTid ? defaultTid : \"\"}` : baseTaskName,\r\n      });\r\n      onRefresh && onRefresh();\r\n    });\r\n  } : () => {\r\n    if (!taskOld) return;\r\n    const task = objectUpdate(taskOld, state.task);\r\n    console.log('task', task);\r\n    if (onSave)\r\n      return onSave(task);\r\n    else return new Promise((resolve, reject) => { resolve(); });\r\n  };\r\n\r\n  const dialogContent = state.useSimpleMode ?\r\n    <List>\r\n      {simpleMode ? <ListItem>\r\n        <Button variant=\"outlined\" onClick={() => { setState({ useSimpleMode: !state.useSimpleMode }); }} fullWidth color=\"secondary\">高级模式</Button>\r\n      </ListItem> : null}\r\n      <ListItem>\r\n        <ListItemText primary=\"计划名称\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <TextField value={state.task.task_name} onChange={e => {\r\n            let newTask = deepCopy(state.task);\r\n            newTask.task_name = e.target.value;\r\n            setState({ task: newTask });\r\n          }}></TextField>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => {\r\n        setCollapseToggle('timenode');\r\n      }}>\r\n        <Box style={{ display: \"flex\", flexFlow: \"row\" }}>\r\n          <Checkbox checked={state.collapseOpen.timenode}></Checkbox>\r\n          <Box>\r\n            <Box className={classes.centerText} style={{ height: \"100%\" }}>在某一个时间点改变价格</Box>\r\n          </Box>\r\n        </Box>\r\n      </ListItem>\r\n      <Collapse in={state.collapseOpen.timenode} timeout=\"auto\" unmountOnExit className={classes.nested}>\r\n        <Box style={{ display: \"flex\", flexFlow: \"row\", justifyContent: \"space-between\" }}>\r\n          <Box className={classes.centerText}>在</Box>\r\n          <ActionData value={state.simpleData.timenodeTime} onChange={e => {\r\n            if (!e) setState({ simpleData: objectUpdate(state.simpleData, { timenodeTime: `datetime|${formatDateTime(new Date())}` }) });\r\n            else setState({ simpleData: objectUpdate(state.simpleData, { timenodeTime: `datetime|${formatDateTime(e)}` }) });\r\n          }} onDelete={() => { setState({ simpleData: objectUpdate(state.simpleData, { timenodeTime: \"datetime|\" }) }); }}></ActionData>\r\n          <Box className={classes.centerText}>调整价格到</Box>\r\n          <TextField style={{ maxWidth: 60 }} inputProps={{ style: { textAlign: \"center\" } }} value={`${state.simpleData.timenodePrice}`} onChange={e => {\r\n            const newValue = getNewNumberString(e.target.value);\r\n            if (newValue === null) return;\r\n            setState({ simpleData: objectUpdate(state.simpleData, { timenodePrice: newValue }) });\r\n          }}></TextField>\r\n        </Box>\r\n      </Collapse>\r\n      <ListItem button onClick={() => {\r\n        // setState({ collapseOpen: objectUpdate(state.collapseOpen, { cycle: !(!!state.collapseOpen.cycle) }) });\r\n        setCollapseToggle('cycle');\r\n      }}>\r\n        <Box style={{ display: \"flex\", flexFlow: \"row\" }}>\r\n          <Checkbox checked={state.collapseOpen.cycle}></Checkbox>\r\n          <Box>\r\n            <Box className={classes.centerText} style={{ height: \"100%\" }}>周期性改变价格</Box>\r\n          </Box>\r\n        </Box>\r\n      </ListItem>\r\n      <Collapse in={state.collapseOpen.cycle} timeout=\"auto\" unmountOnExit className={classes.nested}>\r\n        <Box style={{ display: \"flex\", flexFlow: \"row\", justifyContent: \"space-between\" }}>\r\n          <Box className={classes.centerText}>每隔</Box>\r\n          <TextField style={{ maxWidth: 60 }} inputProps={{ style: { textAlign: \"center\" } }} value={`${parseFloat(state.simpleData.cycleTime.slice('timedelta|'.length)) / timedeltaUnits['天']}`} onChange={e => {\r\n            const value = parseFloat(e.target.value);\r\n            console.log(value);\r\n            const newValue = getNewNumberString(`${value}`);\r\n            if (newValue === null) return;\r\n            setState({ simpleData: objectUpdate(state.simpleData, { cycleTime: `timedelta|${newValue * timedeltaUnits['天']}` }) });\r\n          }}></TextField>\r\n          <Box className={classes.centerText}>天，调整价格到</Box>\r\n          <TextField style={{ maxWidth: 60 }} inputProps={{ style: { textAlign: \"center\" } }} value={`${state.simpleData.cyclePrice}`} onChange={e => {\r\n            const newValue = getNewNumberString(e.target.value);\r\n            if (newValue === null) return;\r\n            setState({ simpleData: objectUpdate(state.simpleData, { cyclePrice: newValue }) });\r\n          }}></TextField>\r\n        </Box>\r\n      </Collapse>\r\n      <ListItem button onClick={() => {\r\n        setCollapseToggle('stock');\r\n      }}>\r\n        <Box style={{ display: \"flex\", flexFlow: \"row\" }}>\r\n          <Checkbox checked={state.collapseOpen.stock}></Checkbox>\r\n          <Box>\r\n            <Box className={classes.centerText} style={{ height: \"100%\" }}>根据库存改变价格</Box>\r\n          </Box>\r\n        </Box>\r\n      </ListItem>\r\n      <Collapse in={state.collapseOpen.stock} timeout=\"auto\" unmountOnExit className={classes.nested}>\r\n        <Box style={{ display: \"flex\", flexFlow: \"row\", justifyContent: \"space-between\" }}>\r\n          <Box className={classes.centerText}>在(设定值)</Box>\r\n          <TextField style={{ maxWidth: 60 }} inputProps={{ style: { textAlign: \"center\" } }} value={`${state.simpleData.stockValue}`} onChange={e => {\r\n            const newValue = getNewNumberString(e.target.value);\r\n            if (newValue === null) return;\r\n            setState({ simpleData: objectUpdate(state.simpleData, { stockValue: newValue }) });\r\n          }}></TextField>\r\n          <Select value={state.simpleData.stockOperator} onChange={e => {\r\n            setState({ simpleData: objectUpdate(state.simpleData, { stockOperator: e.target.value }) });\r\n          }}>\r\n            {Object.keys(defaultOperations).map(key => <MenuItem key={key} value={key}>{defaultOperations[key]}</MenuItem>)}\r\n          </Select>\r\n          <Box className={classes.centerText}>库存值的时候</Box>\r\n          <Box className={classes.centerText}>调整价格到</Box>\r\n          <TextField style={{ maxWidth: 60 }} inputProps={{ style: { textAlign: \"center\" } }} value={`${state.simpleData.stockPrice}`} onChange={e => {\r\n            const newValue = getNewNumberString(e.target.value);\r\n            if (newValue === null) return;\r\n            setState({ simpleData: objectUpdate(state.simpleData, { stockPrice: newValue }) });\r\n          }}></TextField>\r\n        </Box>\r\n      </Collapse>\r\n    </List> :\r\n    <List>\r\n      {simpleMode ? <ListItem>\r\n        <Button variant=\"outlined\" onClick={() => { setState({ useSimpleMode: !state.useSimpleMode }); }} fullWidth color=\"secondary\">简单模式</Button>\r\n      </ListItem> : null}\r\n      <ListSubheader>计划名称</ListSubheader>\r\n      <ListItem>\r\n        <TextField fullWidth value={state.task.task_name} onChange={e => {\r\n          let newTask = deepCopy(state.task);\r\n          newTask.task_name = e.target.value;\r\n          setState({ task: newTask });\r\n        }}></TextField>\r\n      </ListItem>\r\n      <ListSubheader>触发器列表</ListSubheader>\r\n      {state.task.triggers.map((trigger, k) => <ListItem key={trigger}>\r\n        <TriggerTag fullWidth trigger={trigger} onSave={data => {\r\n          console.log('saveing', data);\r\n          let newTask = deepCopy(state.task);\r\n          newTask.triggers[k] = data;\r\n          setState({ task: newTask });\r\n        }}></TriggerTag>\r\n        <ListItemSecondaryAction>\r\n          <IconButton onClick={() => {\r\n            let newTask = deepCopy(state.task);\r\n            newTask.triggers.splice(k, 1);\r\n            setState({ task: newTask });\r\n          }}>\r\n            <DeleteIcon></DeleteIcon>\r\n          </IconButton>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>)}\r\n      <ListSubheader>Actions列表</ListSubheader>\r\n      {state.task.actions.map((action, k) => <ListItem key={action}>\r\n        <ActionTag fullWidth action={action} onSave={data => {\r\n          console.log('saveing', data);\r\n          let newTask = deepCopy(state.task);\r\n          newTask.actions[k] = data;\r\n          setState({ task: newTask });\r\n        }}></ActionTag>\r\n        <ListItemSecondaryAction>\r\n          <IconButton onClick={() => {\r\n            let newTask = deepCopy(state.task);\r\n            newTask.actions.splice(k, 1);\r\n            setState({ task: newTask });\r\n          }}>\r\n            <DeleteIcon></DeleteIcon>\r\n          </IconButton>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>)}\r\n      <ListItem>\r\n        <Grid container spacing={5}>\r\n          <Grid item xs={12} lg={6}>\r\n            <Button fullWidth onClick={() => { setState({ dialogAddTriggerOpen: true }) }} color=\"primary\" variant=\"outlined\">添加触发器</Button>\r\n          </Grid>\r\n          <Grid item xs={12} lg={6}>\r\n            <Button fullWidth onClick={() => { setState({ dialogAddActionOpen: true }) }} color=\"primary\" variant=\"outlined\">添加Action</Button>\r\n          </Grid>\r\n        </Grid>\r\n      </ListItem>\r\n    </List>;\r\n\r\n  return <Dialog fullWidth open={open} onClose={() => { onClose && onClose(false) }}>\r\n    <DialogTitle>{addMode ? \"添加新任务\" : \"设置任务\"}</DialogTitle>\r\n    <DialogContent>\r\n      {dialogContent}\r\n      <Dialog open={state.dialogAddTriggerOpen} onClose={() => setState({ dialogAddTriggerOpen: false })}>\r\n        <DialogTitle>选择一个触发器</DialogTitle>\r\n        <DialogContent>\r\n          <Triggers targets={targets} onClick={trigger => {\r\n            console.log(\"trigger\", trigger);\r\n            let newTask = deepCopy(state.task);\r\n            newTask.triggers.push(trigger);\r\n            setState({ dialogAddTriggerOpen: false, task: newTask });\r\n          }} selectMode></Triggers>\r\n        </DialogContent>\r\n      </Dialog>\r\n      <Dialog open={state.dialogAddActionOpen} onClose={() => setState({ dialogAddActionOpen: false })}>\r\n        <DialogTitle>选择一个Action</DialogTitle>\r\n        <DialogContent>\r\n          <Actions targets={targets} onClick={action => {\r\n            console.log(\"action\", action);\r\n            let newTask = deepCopy(state.task);\r\n            newTask.actions.push(action);\r\n            setState({ dialogAddActionOpen: false, task: newTask });\r\n          }} selectMode></Actions>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </DialogContent>\r\n    <DialogActions>\r\n      <Button color=\"primary\" disabled={state.useSimpleMode ? (\r\n        (() => {\r\n          for (const col in state.collapseOpen) {\r\n            if (state.collapseOpen[col]) return false;\r\n          }\r\n          return true;\r\n        })()\r\n      ) : (state.task.triggers.length === 0 || state.task.actions.length === 0)} onClick={async () => {\r\n        if (!state.useSimpleMode) {\r\n          handleAddTask().then(() => {\r\n            setState({ task: defaultTask });\r\n            onClose && onClose(true);\r\n          });\r\n        } else {\r\n          if (!targets || (targets && !targets.roomItem)) {\r\n            console.warn('targets error');\r\n          }\r\n          // 生成对应的触发器和Actions\r\n          let triggers = [], actions = [];\r\n          // console.log(store.getState().types);\r\n          const defaultData = {\r\n            triggers: store.getState().types.triggers ?\r\n              store.getState().types.triggers :\r\n              await ((() => {\r\n                return new Promise((resolve, reject) => {\r\n                  updateTriggerData((d) => { resolve(d); });\r\n                })\r\n              })()),\r\n            actions: store.getState().types.actions ?\r\n              store.getState().types.actions :\r\n              await ((() => {\r\n                return new Promise((resolve, reject) => {\r\n                  updateActionData((d) => { resolve(d); });\r\n                })\r\n              })()),\r\n          }\r\n          for (const col in state.collapseOpen) {\r\n            if (state.collapseOpen[col]) {\r\n              if (col === 'timenode') {\r\n                // console.log(defaultData);\r\n                if (state.simpleData.timenodeTime === 'datetime|') {\r\n                  store.dispatch(setMessage(\"时间点未设置\"));\r\n                  return;\r\n                }\r\n                triggers.push(objectUpdate(defaultData.triggers.date,\r\n                  { data: objectUpdate(defaultData.triggers.date.data, { run_date: state.simpleData.timenodeTime }) }));\r\n                actions.push(objectUpdate(defaultData.actions.adjust_price,\r\n                  {\r\n                    data: objectUpdate(defaultData.actions.adjust_price.data,\r\n                      { target_price: state.simpleData.timenodePrice, item_id: targets.roomItem.itemId })\r\n                  }));\r\n              } else if (col === 'cycle') {\r\n                triggers.push(objectUpdate(defaultData.triggers.interval,\r\n                  { data: objectUpdate(defaultData.triggers.interval.data, { interval: state.simpleData.cycleTime }) }));\r\n                actions.push(objectUpdate(defaultData.actions.adjust_price,\r\n                  {\r\n                    data: objectUpdate(defaultData.actions.adjust_price.data,\r\n                      { target_price: state.simpleData.timenodePrice, item_id: targets.roomItem.itemId })\r\n                  }));\r\n              } else if (col === 'stock') {\r\n                triggers.push(objectUpdate(defaultData.triggers.stock,\r\n                  { data: objectUpdate(defaultData.triggers.stock.data, { value: state.simpleData.stockValue, operator: state.simpleData.stockOperator }) }));\r\n                actions.push(objectUpdate(defaultData.actions.adjust_price,\r\n                  {\r\n                    data: objectUpdate(defaultData.actions.adjust_price.data,\r\n                      { target_price: state.simpleData.timenodePrice, item_id: targets.roomItem.itemId })\r\n                  }));\r\n              }\r\n            }\r\n          }\r\n          if (triggers.length === 0 || actions.length === 0) {\r\n            console.warn(\"Must select actions / triggers\");\r\n            return;\r\n          }\r\n          const newTask = objectUpdate(state.task, { triggers, actions });\r\n          // console.log(newTask);\r\n          await api.request('task', \"POST\", { task: newTask });\r\n          onClose && onClose(true);\r\n        }\r\n      }}>确定</Button>\r\n      <Button onClick={() => { onClose && onClose(false); }}>取消</Button>\r\n    </DialogActions>\r\n  </Dialog >;\r\n}","import { Box, Button, Container, Dialog, DialogActions, DialogContent, DialogTitle, Grid, IconButton, List, ListItem, ListItemSecondaryAction, ListItemText, ListSubheader, TextField, Typography } from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport React from \"react\";\r\nimport { api } from \"../api/api\";\r\nimport Actions, { wrapAction } from \"../components/Actions\";\r\nimport { ActionTag, isActionModified } from \"../components/Actions\";\r\nimport TaskDialog, { setTaskDialogUpdate } from \"../components/TaskDialog\";\r\nimport Triggers, { wrapTrigger } from \"../components/Triggers\";\r\nimport { TriggerTag, isTriggerModified } from \"../components/Triggers\";\r\nimport { setErrorInfo, setTasks, updateTypes } from \"../data/action\";\r\nimport store from \"../data/store\";\r\nimport { arrayRemove, deepCopy, isObjectValueEqual, objectUpdate } from \"../utils/utils\";\r\n\r\n\r\nasync function wrapTask(task) {\r\n  const taskData = store.getState().types.task_data;\r\n  if (!taskData) return;\r\n  let taskWrapped = objectUpdate(taskData, task);\r\n  // taskWrapped.triggers = taskWrapped.triggers.map(async trigger => await wrapTrigger(trigger));\r\n  for (let i = 0; i < taskWrapped.triggers.length; i++)\r\n    taskWrapped.triggers[i] = await wrapTrigger(taskWrapped.triggers[i]);\r\n  // taskWrapped.actions = taskWrapped.actions.map(async action => await wrapAction(action));\r\n  for (let i = 0; i < taskWrapped.actions.length; i++)\r\n    taskWrapped.actions[i] = await wrapAction(taskWrapped.actions[i]);\r\n  if (taskWrapped.triggers.includes(null) || taskWrapped.actions.includes(null)) return null;\r\n  return taskWrapped;\r\n}\r\n\r\n\r\nfunction TaskTag(props) {\r\n  const { task, onUpdate, onClick } = props;\r\n  // return <code>{JSON.stringify(task)}</code>;\r\n  return <ListItem button onClick={async () => {\r\n    if (!onClick) return;\r\n    let taskOrigin = deepCopy(task);\r\n    console.log('task before', taskOrigin);\r\n    try {\r\n      // TODO: fix 任务修改界面\r\n      const taskWrapped = await wrapTask(taskOrigin);\r\n      console.log('task after', taskWrapped);\r\n      taskWrapped && onClick && onClick(taskWrapped);\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }}>\r\n    <ListItemText>\r\n      <Box>\r\n        <Typography variant=\"h5\">{task.task_name}</Typography>\r\n      </Box>\r\n      <Box>\r\n        <Typography variant=\"body2\">{`tid:${task.tid}/触发器:${task.triggers.length}/Action:${task.actions.length}`}</Typography>\r\n      </Box>\r\n    </ListItemText>\r\n    <ListItemSecondaryAction>\r\n      <IconButton onClick={() => {\r\n        api.request_key(\"task\", task.tid, \"DELETE\").then(resp => {\r\n          if (resp.code !== 200) store.dispatch(setErrorInfo(resp));\r\n          onUpdate && onUpdate();\r\n        });\r\n      }}>\r\n        <DeleteIcon></DeleteIcon>\r\n      </IconButton>\r\n    </ListItemSecondaryAction>\r\n  </ListItem>\r\n}\r\n\r\nexport function getTargetTasks(targets) {\r\n  const tasks = store.getState().tasks;\r\n  if (!targets || !targets.roomItem || (targets.roomItem && JSON.stringify(targets.roomItem) === \"{}\")) return tasks;\r\n  let result = [];\r\n  for (const task of tasks) {\r\n    for (const action of task.actions) {\r\n      if (!action) return [];\r\n      const target = action.data ? action.data : action;\r\n      // console.log('target', target, 'require', targets);\r\n      if (target.action_type.includes(\"adjust_price\")) {\r\n        // console.log(targets.roomItem, target);\r\n        if (targets.roomItem && target.item_id === targets.roomItem.itemId) {\r\n          result.push(task);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  // if (result.length > 0) {\r\n  //   console.log(\"getTargetTasks\", result, targets, tasks);\r\n  //   // debugger;\r\n  // }\r\n  return result;\r\n}\r\n\r\nexport function getTargetTasksMarks(targets) {\r\n  // if (targets) console.log(targets);\r\n  const tasks = store.getState().tasks;\r\n  const marks = tasks.map((task, k) => {\r\n    for (const action of task.actions) {\r\n      const target = action.data ? action.data : action;\r\n      // console.log('search', target);\r\n      if (target.action_type.includes(\"adjust_price\")) {\r\n        if (targets && targets.roomItem && target.item_id === targets.roomItem.itemId) {\r\n          // console.log('found', task);\r\n          return true;\r\n        } else if (!targets) return true;\r\n      }\r\n    }\r\n    return false;\r\n  });\r\n  // if (!targets || !targets.roomItem || (targets.roomItem && JSON.stringify(targets.roomItem) === \"{}\")) return tasks;\r\n  // let result = [];\r\n  // for (const task of tasks) {\r\n  //   for (const action of task.actions) {\r\n  //     const target = action.data ? action.data : action;\r\n  //     if (target.action_type === \"adjust_price\") {\r\n  //       if (targets.roomItem && target.item_id === targets.roomItem.itemId) {\r\n  //         result.push(task);\r\n  //         break;\r\n  //       }\r\n  //     }\r\n  //   }\r\n  // }\r\n  // if (result.length > 0)\r\n  //   console.log(\"getTargetTasks\", result, targets, tasks);\r\n  // return result;\r\n  return marks;\r\n}\r\n\r\nexport function TaskList(props) {\r\n  const { onClick, onUpdate, targets, fullWidth } = props;\r\n  // const tasks = getTargetTasks(targets);\r\n  const tasks = props.tasks ? props.tasks : store.getState().tasks;\r\n  const marks = props.tasks ? getTargetTasksMarks(null) : getTargetTasksMarks(targets);\r\n  // if (targets && targets.roomItem && JSON.stringify(targets.roomItem) !== \"{}\") console.log('tasks', targets, tasks);\r\n  // if (tasks.length > 0) console.log(tasks, marks, props.tasks);\r\n  return tasks.length > 0 ? <List>\r\n    {tasks.map((task, k) => marks[k] ? <TaskTag onClick={onClick} onUpdate={onUpdate} key={task} task={task}></TaskTag> : null)}\r\n    {/* {tasks.map((task, k) => <TaskTag onClick={onClick} onUpdate={onUpdate} key={task} task={task}></TaskTag>)} */}\r\n  </List> : <List style={{ width: fullWidth ? \"100%\" : null }}>\r\n    <ListItem>\r\n      <Typography variant=\"body1\" color=\"textSecondary\">空列表</Typography>\r\n    </ListItem>\r\n  </List>\r\n}\r\n\r\nexport default function Tasks(props) {\r\n  const [state, setInnerState] = React.useState({\r\n    requestingTasks: false,\r\n    dialogAddTaskOpen: false,\r\n    addMode: true,\r\n    task: null,\r\n  });\r\n  const tasks = store.getState().tasks;\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n\r\n  if (!state.requestingTasks) {\r\n    setState({ requestingTasks: true });\r\n    api.request(\"task\", \"GET\").then(resp => {\r\n      if (resp.code !== 200) {\r\n        store.dispatch(setErrorInfo(resp));\r\n        return;\r\n      }\r\n      store.dispatch(setTasks(resp.data.tasks));\r\n      forceUpdate();\r\n    });\r\n  }\r\n\r\n  return <Container>\r\n    <Grid container spacing={3}>\r\n      <Grid item lg={8} sm={12}>\r\n        <Typography variant=\"h4\">任务列表</Typography>\r\n        {/* {tasks.length > 0 ? <List>\r\n          {tasks.map((task, k) => <TaskTag onClick={task => {\r\n            console.log('Task: onClick', task);\r\n            setTaskDialogUpdate(true);\r\n            setState({ dialogAddTaskOpen: true, addMode: false, task });\r\n          }} onUpdate={() => { setState({ requestingTasks: false }); }} key={v} task={task}></TaskTag>)}\r\n        </List> : <List>\r\n          <ListItem>\r\n            <Typography variant=\"body1\" color=\"textSecondary\">空列表</Typography>\r\n          </ListItem>\r\n        </List>} */}\r\n        <TaskList onClick={task => {\r\n          console.log('Task: onClick', task);\r\n          setTaskDialogUpdate(true);\r\n          setState({ dialogAddTaskOpen: true, addMode: false, task });\r\n        }} onUpdate={() => { setState({ requestingTasks: false }); }}></TaskList>\r\n      </Grid>\r\n      <Grid item lg={4} sm={12}>\r\n        <Container maxWidth=\"xs\">\r\n          <List>\r\n            <ListSubheader>新任务</ListSubheader>\r\n            <ListItem>\r\n              <Button fullWidth variant=\"contained\" color=\"secondary\" onClick={() => {\r\n                setTaskDialogUpdate(true);\r\n                setState({ dialogAddTaskOpen: true, addMode: true });\r\n              }}>添加新任务</Button>\r\n            </ListItem>\r\n            <ListItem>\r\n              <Button fullWidth variant=\"contained\">设置默认任务</Button>\r\n            </ListItem>\r\n\r\n            <ListSubheader>全部任务管理</ListSubheader>\r\n            <ListItem>\r\n              <Button fullWidth disabled={tasks.length === 0} variant=\"outlined\" onClick={() => {\r\n                let tids = {};\r\n                tasks.map(task => { tids = Object.assign(tids, { [task.tid]: task.tid }); return null; });\r\n                api.request(\"task\", \"DELETE\", { tids }).then(resp => {\r\n                  // forceUpdate();\r\n                  setState({ requestingTasks: false });\r\n                });\r\n              }}>删除全部任务</Button>\r\n            </ListItem>\r\n          </List>\r\n        </Container>\r\n      </Grid>\r\n    </Grid>\r\n    <TaskDialog taskOld={state.task}\r\n      addMode={state.addMode}\r\n      open={state.dialogAddTaskOpen}\r\n      onRefresh={() => { setState({ requestingTasks: false }); }}\r\n      onClose={() => { setState({ dialogAddTaskOpen: false }); }}\r\n      onSave={task => {\r\n        return api.request_key('task', task.tid, \"POST\", { task }).then(resp => {\r\n          setState({ requestingTasks: false });\r\n        });\r\n      }}\r\n    ></TaskDialog>\r\n  </Container >\r\n}","import React from 'react';\r\nimport { Box, Container, LinearProgress, Button, Dialog, Link, List, ListItemText, DialogTitle, DialogContent, ListItem, Typography, DialogActions } from '@material-ui/core';\r\nimport CircularProgress from '@material-ui/core/CircularProgress';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport { api } from '../api/api';\r\nimport store from '../data/store';\r\nimport { setDaemon, setErrorInfo, setTasks } from '../data/action';\r\nimport TaskDialog, { setTaskDialogUpdate } from \"./TaskDialog\";\r\nimport { deepCopy, weekDayList } from '../utils/utils';\r\nimport { getTargetTasks, TaskList } from '../pages/Tasks';\r\n\r\nconst useStyles = makeStyles({\r\n  table: {\r\n    minWidth: 1500,\r\n  },\r\n  foodDesc: {\r\n    overflow: 'hidden',\r\n    whiteSpace: 'nowrap',\r\n    contentOverflow: 'ellipsis',\r\n    maxWidth: 160\r\n  },\r\n  planButton: {\r\n    overflow: 'hidden',\r\n    whiteSpace: 'nowrap',\r\n    contentOverflow: 'ellipsis',\r\n    maxWidth: 160\r\n  }\r\n});\r\n\r\nfunction MyTableCell(props) {\r\n  let styles = Object.assign((props.style ? props.style : {}), { padding: 3 });\r\n  // console.log('props.noBorder', props.noBorder);\r\n  if (props.noBorder) styles.borderBottom = \"0\";\r\n  // return <TableCell align={props.align} colSpan={props.colSpan} style={styles}>{props.content}</TableCell>\r\n  return <TableCell align={props.align} colSpan={props.colSpan} style={styles}>{props.children}</TableCell>\r\n}\r\n\r\n// 容易subscribe到已经卸载的component上面...\r\n// store.subscribe(() => {\r\n//   console.log('(tables) redux update to', store.getState());\r\n// });\r\n\r\nlet requestedDayData = null;\r\n// let roomItemNow = {};\r\nlet setUpdateTimer = null;\r\n\r\nfunction ReserveTable(props) {\r\n  const classes = useStyles();\r\n  // console.log('daemon', store.getState().daemon);\r\n  const [requestingDaemon, setRequestingDaemon] = React.useState(false);\r\n  const [requestingUpdate, setRequestingUpdate] = React.useState(false);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const { day, data } = props;\r\n  const date = new Date().setDay(day).toDateString();\r\n  // const [dayData, setDayData] = React.useState(data ? data : store.getState().daemon.reserve_table[date]);\r\n  const [dayData, setDayData] = React.useState(data);\r\n  const [roomList, setRoomList] = React.useState((store.getState().daemon &&\r\n    store.getState().daemon.reserve_table &&\r\n    store.getState().daemon.reserve_table[date]) ? store.getState().daemon.reserve_table[date].roomList : []);\r\n  const [dialogAddTaskOpen, setDialogAddTaskOpen] = React.useState(null);\r\n  const [dialogTasksListOpen, setDialogTasksListOpen] = React.useState(null);\r\n  const [roomItemNow, setRoomItemNow] = React.useState({});\r\n  const [requestingTasks, setRequestingTasks] = React.useState(false);\r\n\r\n  if (!requestingTasks && (!store.getState().tasks || (store.getState().tasks || store.getState().tasks.length === 0))) {\r\n    setRequestingTasks(true);\r\n    api.request(\"task\", \"GET\").then(resp => {\r\n      if (resp.code !== 200) return;\r\n      store.dispatch(setTasks(resp.data.tasks));\r\n      forceUpdate();\r\n    });\r\n  }\r\n\r\n  if (!store.getState().daemon) {\r\n    if (!requestingDaemon) {\r\n      setRequestingDaemon(true);\r\n      api.request(\"daemon\", \"GET\").then(resp => {\r\n        if (resp.code !== 200) return;\r\n        store.dispatch(setDaemon(resp.data));\r\n      });\r\n    }\r\n    return <LinearProgress></LinearProgress>;\r\n  }\r\n  if (!store.getState().daemon.reserve_table) {\r\n    if (!requestingUpdate) {\r\n      setRequestingUpdate(true);\r\n      api.request(\"daemon\", \"POST\", { daemon_args: { update_all: true } }).then(resp => {\r\n        if (resp.code !== 200) return;\r\n        store.dispatch(setDaemon(resp.data));\r\n      });\r\n    }\r\n    return <LinearProgress></LinearProgress>;\r\n  }\r\n\r\n  requestedDayData = JSON.stringify(store.getState().daemon.reserve_table[date]) !== '{}' && JSON.stringify(store.getState().daemon.reserve_table[date]) !== undefined;\r\n  // console.log('requested', requestedDayData);\r\n  // console.log('date', date);\r\n\r\n  const PeriodTable = function (props) {\r\n    const classes = useStyles();\r\n    const { data, roomList } = props;\r\n    // console.log(\"data\", data);\r\n    let table = {};\r\n    let periodIds = [];\r\n    let periodMap = {};\r\n    for (const period of data.periodList) {\r\n      table[period.periodId] = {};\r\n      periodMap[period.periodId] = period;\r\n      periodIds.push({ id: period.periodId, desc: period.periodDesc });\r\n      for (const room of roomList) {\r\n        table[period.periodId][room.roomName] = [];\r\n      }\r\n      for (const roomMapItemName in period.roomMapItemEntry) {\r\n        if (!table[period.periodId][roomMapItemName]) table[period.periodId][roomMapItemName] = [];\r\n        for (const roomItem of period.roomMapItemEntry[roomMapItemName]) {\r\n          table[period.periodId][roomMapItemName].push(roomItem);\r\n        }\r\n      }\r\n    }\r\n    // console.log('table', table);\r\n    let rows = [];\r\n    let maxRows = {};\r\n    // let key = 1;\r\n    for (const periodData of periodIds) {\r\n      const periodId = periodData.id;\r\n      if (!table[periodId]) continue;\r\n      let index = 0;\r\n      while (true) {\r\n        let notEmpty = false;\r\n        for (const room of roomList) {\r\n          if (!table[periodId][room.roomName] || !(table[periodId][room.roomName] && table[periodId][room.roomName][index])) {\r\n            continue;\r\n          }\r\n          notEmpty = true;\r\n        }\r\n        if (!notEmpty) break;\r\n        index++;\r\n      }\r\n      maxRows[periodId] = index;\r\n    }\r\n    const getCenterTable = (index, maxIndex, content, key) => {\r\n      return index == (parseInt(maxIndex / 2)) ? (maxIndex % 2 === 1 ? (index === maxIndex - 1 ? <MyTableCell key={key} align=\"center\" colSpan={1}>{content}</MyTableCell> :\r\n        <MyTableCell key={key} align=\"center\" noBorder colSpan={1}>{content}</MyTableCell>) :\r\n        (index === maxIndex - 1 ? <MyTableCell key={key} align=\"center\" colSpan={1}><Box style={{ position: \"relative\", top: -15 }}>{content}</Box></MyTableCell> :\r\n          <MyTableCell key={key} align=\"center\" noBorder colSpan={1}><Box style={{ position: \"relative\", top: -15 }}>{content}</Box></MyTableCell>)) :\r\n        (index === maxIndex - 1 ? <MyTableCell key={key} align=\"center\" colSpan={1}></MyTableCell> :\r\n          <MyTableCell key={key} align=\"center\" colSpan={1} noBorder></MyTableCell>);\r\n    };\r\n    for (const periodData of periodIds) {\r\n      const periodId = periodData.id;\r\n      if (!table[periodId]) continue;\r\n      let index = 0;\r\n      while (true) {\r\n        let notEmpty = false;\r\n        const maxIndex = maxRows[periodId] ? maxRows[periodId] : 1;\r\n        // let row = [getCenterTable(index, maxIndex, periodData.id, key++),];\r\n        let row = [getCenterTable(index, maxIndex, <Box component=\"div\" className={classes.foodDesc}>\r\n          {periodData.desc}\r\n        </Box>, periodId),];\r\n        for (const room of roomList) {\r\n          if (!table[periodId][room.roomName] || !(table[periodId][room.roomName] && table[periodId][room.roomName][index])) {\r\n            for (const i of [0, 1, 2, 3]) {\r\n              row.push(<MyTableCell key={`${periodId}${room.roomName}${index}-blank-${i}`} colSpan={1}></MyTableCell>);\r\n            }\r\n            continue;\r\n          }\r\n          notEmpty = true;\r\n          const roomItem = table[periodId][room.roomName][index];\r\n          // console.log(\"roomItem\", roomItem);\r\n          // 价格\r\n          row.push(<MyTableCell key={`${periodId}${room.roomName}${index}-price`} align=\"center\" colSpan={1}>{'￥' + roomItem.price}</MyTableCell>);\r\n          // 说明\r\n          row.push(<MyTableCell key={`${periodId}${room.roomName}${index}-foodDesc`} align=\"center\" colSpan={1}>\r\n            <Box component=\"div\" className={classes.foodDesc}>\r\n              {roomItem.foodDesc}\r\n            </Box>\r\n          </MyTableCell>);\r\n          // 库存\r\n          row.push(getCenterTable(index, table[periodId][room.roomName] ? table[periodId][room.roomName].length : maxIndex, `${roomItem.stock}间`, `${periodId}${room.roomName}${index}-stock`));\r\n          // 计划\r\n          // row.push(<MyTableCell key={key} align=\"center\" colSpan={1}><Link className={classes.planButton}>计划</Link></MyTableCell>);\r\n          row.push(<MyTableCell key={`${periodId}${room.roomName}${index}-plan`} align=\"center\" colSpan={1}>{\r\n            (() => {\r\n              let planCount = getTargetTasks({ roomItem }).length;\r\n              return (<Link onClick={planCount === 0 ? () => {\r\n                let parent = periodMap[periodId];\r\n                parent.date = date;\r\n                parent.day = day;\r\n                console.log('day', day, 'date', date);\r\n                let roomItemTmp = deepCopy(roomItem);\r\n                roomItemTmp.parent = parent;\r\n                setRoomItemNow(roomItemTmp);\r\n                setTaskDialogUpdate(true);\r\n                setDialogAddTaskOpen(true);\r\n              } : () => {\r\n                const tasks = getTargetTasks({ roomItem });\r\n                console.log('got tasks', tasks);\r\n                const parent = periodMap[periodId];\r\n                parent.date = date;\r\n                parent.day = day;\r\n                console.log('- day', day, 'date', date);\r\n                let roomItemTmp = deepCopy(roomItem);\r\n                roomItemTmp.parent = parent;\r\n                setRoomItemNow(roomItemTmp);\r\n                setDialogTasksListOpen(tasks);\r\n              }} className={classes.planButton}>计划{planCount > 0 ? (`(${planCount})`) : ''}</Link>);\r\n            })()\r\n          }</MyTableCell>);\r\n        }\r\n        if (!notEmpty) break;\r\n        rows.push(row);\r\n        index++;\r\n      }\r\n    }\r\n    return rows.map((v, k) => <TableRow style={{ height: 30 }} key={k}>{v}</TableRow>);\r\n  };\r\n\r\n  if (!setUpdateTimer) {\r\n    setUpdateTimer = true;\r\n    // 每分钟更新数据\r\n    setTimeout(() => {\r\n      if (!updateData) return;\r\n      updateData();\r\n    }, 60 * 1000);\r\n  }\r\n\r\n  const updateData = () => {\r\n    // console.log('updating daemon!');\r\n    if (!requestedDayData) {\r\n      requestedDayData = true;\r\n      api.request(\"daemon\", \"POST\", { daemon_args: { reserve_table: { date } } }).then(resp => {\r\n        if (resp.code !== 200) return;\r\n        store.dispatch(setDaemon(resp.data));\r\n        requestedDayData = false;\r\n        forceUpdate();\r\n      });\r\n    } else {\r\n      let reserveTableData = store.getState().daemon.reserve_table[date];\r\n      // console.log('got from redux:', reserveTableData);\r\n      if (reserveTableData) {\r\n        setDayData(reserveTableData);\r\n        setRoomList(reserveTableData.roomList);\r\n        // 也是要请求一遍的\r\n        api.request(\"daemon\", \"POST\", { daemon_args: { reserve_table: { date } } }).then(resp => {\r\n          if (resp.code !== 200) return;\r\n          store.dispatch(setDaemon(resp.data));\r\n          requestedDayData = false;\r\n          forceUpdate();\r\n        });\r\n      } else {\r\n        // console.warn('got empty reserveTableData', dayData, store.getState().daemon.reserve_table, date, JSON.stringify(store.getState().daemon.reserve_table[date]));\r\n      }\r\n    }\r\n  };\r\n\r\n  const updateTaskData = () => {\r\n    // 更新Task数据\r\n    updateData();\r\n    api.request(\"task\", \"GET\").then(resp => {\r\n      if (resp.code !== 200) return;\r\n      store.dispatch(setTasks(resp.data.tasks));\r\n      setDialogTasksListOpen(null);\r\n      forceUpdate();\r\n    });\r\n  };\r\n\r\n  if (!dayData) {\r\n    updateData();\r\n    return (<Container>\r\n      <LinearProgress></LinearProgress>\r\n    </Container>);\r\n  }\r\n  let tableHeaderCells = [<TableCell key=\"time\" align=\"center\" colSpan={1}>时间</TableCell>,];\r\n  roomList.map((d, i) => {\r\n    tableHeaderCells.push(<TableCell key={'a' + d + i} align=\"center\" colSpan={2}>售卖内容</TableCell>);\r\n    tableHeaderCells.push(<TableCell key={'b' + d + i} align=\"center\" colSpan={1}>库存</TableCell>);\r\n    tableHeaderCells.push(<TableCell key={'c' + d + i} align=\"center\" colSpan={1}>计划</TableCell>);\r\n    // tableHeaderCells.push(<TableCell key={'d' + d + i} align=\"center\" colSpan={1}>临时下线</TableCell>);\r\n  });\r\n  const tableHeader = <TableHead>\r\n    <TableRow>\r\n      <TableCell align=\"center\" colSpan={1}>[{date.slice(date.length - 2, date.length)}日{'周' + [\"日\", '一', '二', '三', '四', '五', '六'][day]}]</TableCell>\r\n      {roomList.map((d, i) =>\r\n        <TableCell align=\"center\" key={i} colSpan={4}>{d.roomName}({d.roomCapacity})</TableCell>\r\n      )}\r\n    </TableRow>\r\n    <TableRow>\r\n      {tableHeaderCells}\r\n    </TableRow>\r\n  </TableHead>;\r\n  if (!dayData || !dayData.periodList) {\r\n    // console.log('no data!', dayData, typeof (dayData));\r\n    return (<Container>\r\n      <header></header>\r\n      <LinearProgress></LinearProgress>\r\n    </Container>);\r\n  }\r\n  // console.log(\"roomItemNow\", roomItemNow);\r\n  return (\r\n    <Container>\r\n      <TableContainer component={Paper}>\r\n        <Table stickyHeader className={classes.table}>\r\n          {tableHeader}\r\n          <TableBody>\r\n            {/* {dayData.periodList.map((d, i) =>\r\n              <Period key={'period' + i} data={d} roomList={roomList}></Period>\r\n            )} */}\r\n            <PeriodTable data={dayData} roomList={roomList}></PeriodTable>\r\n          </TableBody>\r\n        </Table>\r\n      </TableContainer>\r\n      <Dialog open={!!dialogTasksListOpen} onClose={() => { setDialogTasksListOpen(null); }}>\r\n        <DialogTitle>任务列表</DialogTitle>\r\n        <DialogContent>\r\n          {/* {roomItemNow && JSON.stringify(roomItemNow) !== \"{}\" ?  */}\r\n          {dialogTasksListOpen ? <TaskList fullWidth tasks={dialogTasksListOpen}\r\n            // onClick={task => {\r\n            //   console.log('click task', task);\r\n            //   setDialogAddTaskOpen(task);\r\n            // }}\r\n            onUpdate={() => {\r\n              api.request(\"task\", \"GET\").then(resp => {\r\n                if (resp.code !== 200) return;\r\n                store.dispatch(setTasks(resp.data.tasks));\r\n                forceUpdate();\r\n              });\r\n            }}></TaskList> : null\r\n            // <code>{`${console.log(roomItemNow, dialogTasksListOpen)}`}</code>\r\n          }\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button color=\"primary\" onClick={() => {\r\n            setTaskDialogUpdate(true);\r\n            setDialogAddTaskOpen(true);\r\n          }}>添加任务</Button>\r\n          <Button color=\"primary\" onClick={() => { setDialogTasksListOpen(null); }}>取消</Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n      <TaskDialog\r\n        simpleMode\r\n        taskOld={dialogAddTaskOpen}\r\n        addMode={dialogAddTaskOpen === true}\r\n        targets={{ roomItem: roomItemNow, taskName: (roomItemNow && JSON.stringify(roomItemNow) !== \"{}\") ? `${roomItemNow.roomType}周${weekDayList[new Date().getDay()]}${roomItemNow.parent.periodDesc}` : null }}\r\n        open={!!dialogAddTaskOpen && (roomItemNow && JSON.stringify(roomItemNow) !== '{}')}\r\n        onRefresh={() => {\r\n          updateTaskData();\r\n        }}\r\n        onClose={(isOk) => {\r\n          setDialogAddTaskOpen(null);\r\n          if (isOk) updateTaskData();\r\n        }}\r\n        onSave={task => {\r\n          console.log(\"post task\", task);\r\n          return api.request_key('task', task.tid, \"POST\", { task }).then(resp => {\r\n            // setState({ requestingTasks: false });\r\n            console.log(\"update task done\");\r\n          });\r\n        }}\r\n      ></TaskDialog>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default ReserveTable;","import React from 'react'\r\nimport { LinearProgress, Button, Container, Dialog, DialogTitle, IconButton } from '@material-ui/core';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport InputLabel from '@material-ui/core/InputLabel';\r\nimport MenuItem from '@material-ui/core/MenuItem';\r\nimport FormControl from '@material-ui/core/FormControl';\r\nimport Select from '@material-ui/core/Select';\r\nimport PropTypes from 'prop-types';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Tabs from '@material-ui/core/Tabs';\r\nimport Tab from '@material-ui/core/Tab';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Box from '@material-ui/core/Box';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport VisibilityIcon from '@material-ui/icons/Visibility';\r\nimport FullscreenIcon from '@material-ui/icons/Fullscreen';\r\nimport FullscreenExitIcon from '@material-ui/icons/FullscreenExit';\r\nimport ReserveTable from './ReserveTable';\r\nimport { weekDayList } from '../utils/utils';\r\n\r\nfunction TabPanel(props) {\r\n  const { children, value, index, ...other } = props;\r\n\r\n  return (\r\n    <div\r\n      role=\"tabpanel\"\r\n      hidden={value !== index}\r\n      id={`scrollable-auto-tabpanel-${index}`}\r\n      aria-labelledby={`scrollable-auto-tab-${index}`}\r\n      {...other}\r\n    >\r\n      {value === index && (\r\n        <Box>\r\n          {/* <Typography>{children}</Typography> */}\r\n          {children}\r\n        </Box>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nTabPanel.propTypes = {\r\n  children: PropTypes.node,\r\n  index: PropTypes.any.isRequired,\r\n  value: PropTypes.any.isRequired,\r\n};\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    overflowX: 'auto',\r\n    display: 'block',\r\n    width: '100%',\r\n    flexGrow: 1,\r\n    width: '100%',\r\n    backgroundColor: theme.palette.background.paper,\r\n  },\r\n  formControl: {\r\n    margin: theme.spacing(1),\r\n    minWidth: 120,\r\n  },\r\n  selectEmpty: {\r\n    marginTop: theme.spacing(2),\r\n  },\r\n}));\r\n\r\nfunction a11yProps(index) {\r\n  return {\r\n    id: `scrollable-auto-tab-${index}`,\r\n    'aria-controls': `scrollable-auto-tabpanel-${index}`,\r\n  };\r\n}\r\n\r\nexport default function ReserveTables(props) {\r\n  const classes = useStyles();\r\n  const [tabValue, setTableValue] = React.useState(new Date().getDay());\r\n  const [showTable, setShowTable] = React.useState(false);\r\n  const [fullShow, setFullShow] = React.useState(false);\r\n  const handleChange = (event) => {\r\n    setTableValue(event.target.value);\r\n  };\r\n  const table = <div className={classes.root}>\r\n    <Tabs\r\n      value={tabValue}\r\n      onChange={(e, val) => setTableValue(val)}\r\n      indicatorColor=\"primary\"\r\n      textColor=\"primary\"\r\n      variant=\"scrollable\"\r\n      scrollButtons=\"auto\"\r\n      aria-label=\"scrollable auto tabs example\"\r\n    >\r\n      {[\"日\", '一', '二', '三', '四', '五', '六'].map((d, i) => {\r\n        return (<Tab label={'周' + d} key={d} {...a11yProps(i)} />);\r\n      })}\r\n    </Tabs>\r\n    {[0, 1, 2, 3, 4, 5, 6].map((d, i) => <TabPanel key={d} value={tabValue} index={d}>\r\n      <ReserveTable day={tabValue}></ReserveTable>\r\n    </TabPanel>)}\r\n  </div>;\r\n  return (\r\n    // <Container className={classes.root}>\r\n    <div>\r\n      <FormControl className={classes.formControl}>\r\n        <InputLabel>选择日期</InputLabel>\r\n        <Select\r\n          value={tabValue}\r\n          onChange={handleChange}\r\n        >\r\n          {weekDayList.map((d, i) => <MenuItem key={d} value={i}>{'周' + d}</MenuItem>)}\r\n        </Select>\r\n      </FormControl>\r\n      <IconButton style={{ float: 'right' }} variant=\"contained\" onClick={() => {\r\n        setShowTable(true);\r\n        setFullShow(true);\r\n      }}><FullscreenIcon /></IconButton>\r\n      { window.innerWidth >= 600 ? table : <Button fullWidth variant=\"contained\" onClick={() => { setShowTable(!showTable); }}>点击{showTable ? \"隐藏\" : \"显示\"}表格</Button>}\r\n      <Dialog fullScreen={fullShow} onClose={() => { setShowTable(false); }} open={showTable}>\r\n        <DialogTitle>\r\n          <Box component=\"span\">周{weekDayList[tabValue]}({new Date().setDay(tabValue).toDateString()})数据</Box>\r\n          {fullShow ? <IconButton edge=\"end\" style={{ float: 'right' }} onClick={() => {\r\n            setFullShow(false);\r\n            setShowTable(false);\r\n          }}><FullscreenExitIcon /></IconButton> : <IconButton style={{ float: 'right' }} variant=\"contained\" onClick={() => {\r\n            setShowTable(true);\r\n            setFullShow(true);\r\n          }}><FullscreenIcon /></IconButton>}</DialogTitle>\r\n        {table}\r\n      </Dialog>\r\n      {/* </Container > */}\r\n    </div>\r\n  );\r\n\r\n}\r\n\r\n","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport ReserveTables from \"../components/ReserveTables\";\r\nimport { Divider, Table, TableBody, TableCell, TableRow, Typography } from \"@material-ui/core\";\r\nimport store from \"../data/store\";\r\n\r\nclass StateNow extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = store.getState();\r\n    this.unsubscribe = store.subscribe(() => {\r\n      this.setState({\r\n        timetableNodes: store.getState().timetableNodes,\r\n        timetablePeriods: store.getState().timetablePeriods,\r\n        roomStockPlans: store.getState().roomStockPlans\r\n      });\r\n    });\r\n  }\r\n  componentWillUnmount() {\r\n    this.unsubscribe();\r\n  }\r\n  render() {\r\n    return (<Table>\r\n      <TableBody>\r\n        <TableRow>\r\n          <TableCell align=\"center\">任务数量</TableCell>\r\n          <TableCell align=\"center\">LABLE1</TableCell>\r\n          <TableCell align=\"center\">LABLE2</TableCell>\r\n        </TableRow>\r\n        <TableRow>\r\n          <TableCell align=\"center\">{store.getState().tasks.length}个</TableCell>\r\n          <TableCell align=\"center\">VALUE1</TableCell>\r\n          <TableCell align=\"center\">VALUE2</TableCell>\r\n        </TableRow>\r\n      </TableBody>\r\n    </Table>);\r\n  }\r\n}\r\n\r\nfunction Launch() {\r\n  return (<Container style={{ overflowX: 'auto', width: '100%' }}>\r\n    <Typography variant=\"h5\">执行状态</Typography>\r\n    <StateNow></StateNow>\r\n    <br />\r\n    <Typography variant=\"h5\">数据总览</Typography>\r\n    <ReserveTables />\r\n  </Container>);\r\n}\r\n\r\nexport default Launch;","import store from \"../data/store\";\r\n\r\n\r\nclass WebSocketAPI {\r\n  constructor(url) {\r\n    this.connect = this.connect.bind(this);\r\n    this.url = url || store.getState().config.data.remote_login.server || \"ws://127.0.0.1:8081\";\r\n    this.ws = null;\r\n    this.onopen = () => {\r\n      console.log('Connection started');\r\n    };\r\n    this.ondata = e => {\r\n      if (e.cmd === 'code') {\r\n        this.oncode(e.data);\r\n      } else if (e.cmd === 'cookies') {\r\n        this.oncookies(e.data);\r\n      }\r\n    };\r\n    this.onmessage = e => {\r\n      // console.log('onmessage', e);\r\n      this.ondata(JSON.parse(e.data));\r\n    };\r\n    this.onerror = e => {\r\n      console.error(e);\r\n    };\r\n    this.onclose = () => {\r\n      console.log('Connection closed');\r\n    };\r\n    this.oncode = code => { console.log('code', code); }\r\n    this.oncookies = cookies => { console.log('cookies', cookies); }\r\n  }\r\n  connect() {\r\n    this.ws = this.ws || new WebSocket(this.url);\r\n    this.ws.onopen = this.onopen;\r\n    this.ws.onclose = this.onclose;\r\n    this.ws.onerror = this.onerror;\r\n    this.ws.onmessage = this.onmessage;\r\n  }\r\n  close() {\r\n    if (this.ws) this.ws.close();\r\n  }\r\n}\r\n\r\nexport { WebSocketAPI };","import { Box, Button, Container, Paper, Typography } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { api } from '../api/api';\r\nimport Config from \"../Config\";\r\nimport { WebSocketAPI } from '../api/remote_login';\r\nimport { setConfig, setDaemon } from '../data/action';\r\nimport store from '../data/store';\r\nconst QRCode = require('qrcode.react');\r\n\r\nfunction CenterBox(props) {\r\n  const { children, style } = props;\r\n  return <Box style={style ? style : { width: '100%', height: '100%', display: \"flex\", justifyContent: \"center\", flexDirection: \"column\" }}>\r\n    <Box style={{ width: '100%', textAlign: \"center\", display: \"flex\", justifyContent: \"center\", flexDirection: \"column\", alignItems: \"center\" }}>\r\n      {children}\r\n    </Box>\r\n  </Box>;\r\n}\r\n\r\nexport default class RemoteLogin extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.onFinish = props.onFinish;\r\n    this.forceLogin = props.forceLogin;\r\n    this.stateDefault = {\r\n      code: null,\r\n      loginDone: false,\r\n      loginError: null,\r\n    };\r\n    this.state = this.stateDefault;\r\n    this.ws_api = null;\r\n    this.ws_running = false;\r\n    // this.unsubscribe = store.subscribe(async () => {\r\n    //   if (this.loginDone) return;\r\n    //   let state = store.getState();\r\n    //   if (state.daemon) {\r\n    //     this.setState({ loginDone: true });\r\n    //     if (this.ws_api) this.ws_api.close();\r\n    //   }\r\n    // });\r\n    this.run_ws = async () => {\r\n      // debugger;\r\n      this.ws_running = true;\r\n      console.log(store.getState().daemon);\r\n      if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n      const res = await api.request('remote_login', \"PATCH\");\r\n      if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n      const server = res.data.server;\r\n      let config = store.getState().config;\r\n      config.data.remote_login.server = server;\r\n      store.dispatch(setConfig(config));\r\n      if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n      this.ws_api = new WebSocketAPI(server);\r\n      this.ws_api.oncode = code => {\r\n        // console.log('code', code);\r\n        if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n        this.setState({ code });\r\n      };\r\n      this.ws_api.oncookies = async cookies => {\r\n        const resp = await api.request('remote_login', \"POST\", { cookies });\r\n        if (resp.code !== 200) {\r\n          this.setState({ loginDone: true, loginError: resp.message });\r\n          return;\r\n        }\r\n        console.log('done', resp);\r\n        if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n        this.setState({ loginDone: true });\r\n        const daemon = await api.request('remote_login', 'GET');\r\n        if (daemon.code === 200 && daemon.data.uid) {\r\n          store.dispatch(setDaemon(daemon.data));\r\n        }\r\n        this.onFinish && this.onFinish();\r\n      }\r\n      if (!this.forceLogin && ((store.getState().daemon && store.getState().daemon.cookies) || this.state.loginDone)) { this.ws_running = false; return; }\r\n      this.ws_api.connect();\r\n    };\r\n    setTimeout(this.run_ws, 1000);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this.ws_api) this.ws_api.close();\r\n    // this.unsubscribe();\r\n  }\r\n  render() {\r\n    let content = null;\r\n    if (this.state.loginDone) {\r\n      if (!this.state.loginError)\r\n        content = <Paper style={{ width: 200, height: 200 }}>\r\n          <CenterBox>登录完成</CenterBox>\r\n        </Paper>;\r\n      else content = <Paper style={{ width: 200, height: 200 }}>\r\n        <CenterBox>\r\n          <Typography variant=\"body1\">{this.state.loginError}</Typography>\r\n          <Button variant=\"outlined\" color=\"secondary\" onClick={() => {\r\n            try { clearTimeout(this.run_ws); } catch (e) { console.error(e); }\r\n            this.setState(this.stateDefault);\r\n            try { if (this.ws_api) this.ws_api.connect(); } catch (e) { console.error(e); }\r\n            this.ws_api = null;\r\n            this.ws_running = false;\r\n            setTimeout(this.run_ws, 1000);\r\n          }}>重试</Button>\r\n        </CenterBox>\r\n      </Paper>;\r\n    } else {\r\n      content = this.state.code ? <QRCode value={JSON.stringify(this.state.code)} size={200} /> :\r\n        <Paper style={{ width: 200, height: 200 }}>\r\n          <CenterBox>正在加载二维码...</CenterBox>\r\n        </Paper>;\r\n    }\r\n    return (<Container maxWidth=\"xs\" style={{ height: window.innerHeight * 0.6 }}>\r\n      <CenterBox>\r\n        <Typography variant=\"h5\">扫码登录以继续</Typography>\r\n        <br></br>\r\n        {content}\r\n        <br></br>\r\n        <Typography variant=\"body2\" color=\"textSecondary\">请使用美团开店宝/点评管家扫码登录</Typography>\r\n        <Typography variant=\"body2\" color=\"textSecondary\">点击软件右下角\"我的\"→右上角扫码图标</Typography>\r\n        <br></br>\r\n        <Button fullWidth onClick={() => {\r\n          Config.clear();\r\n          setTimeout(() => { window.location.reload(); }, 500);\r\n        }}>退出当前账号</Button>\r\n      </CenterBox>\r\n    </Container>);\r\n  }\r\n}","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport { Button, MenuItem, FormControl, InputLabel, List, ListItem, ListItemSecondaryAction, ListItemText, Select, ListSubheader, Switch, Dialog, DialogTitle, DialogContent, Typography, DialogActions, Box, IconButton, DialogContentText } from \"@material-ui/core\";\r\nimport DeleteIcon from '@material-ui/icons/Delete';\r\nimport store from \"../data/store\";\r\nimport { setConfig, setErrorInfo, setMessage } from \"../data/action\";\r\nimport { funDownload } from \"../utils/utils\";\r\nimport ListInfo from \"../components/ListInfo\";\r\nimport { api } from \"../api/api\";\r\nimport Config from \"../Config\";\r\nimport RemoteLogin from \"./RemoteLogin\";\r\n\r\nfunction Settings(props) {\r\n  const [themeName, setThemeName] = React.useState(store.getState().config.data.theme_name);\r\n  const refConfigFileInput = React.useRef();\r\n  const [resetSettingsOpen, setResetSettingsOpen] = React.useState(false);\r\n  const [deleteDataOpen, setDeleteDataOpen] = React.useState(false);\r\n  const [openDaemon, setOpenDaemon] = React.useState(false);\r\n  const [openUser, setOpenUser] = React.useState(false);\r\n  const [openResetShop, setOpenResetShop] = React.useState(false);\r\n  const [openSelectShop, setOpenSelectShop] = React.useState(false);\r\n  const [openNewShop, setOpenNewShop] = React.useState(false);\r\n\r\n  const resetSettings = function () {\r\n    let c = store.getState().config;\r\n    c.data = c.data_default;\r\n    c.save();\r\n    c.load();\r\n    store.dispatch(setConfig(c));\r\n  }\r\n\r\n  const user = store.getState().user;\r\n\r\n  return (<Container maxWidth=\"md\">\r\n    <List>\r\n      <ListSubheader>用户账号</ListSubheader>\r\n      <ListItem>\r\n        <ListItemText primary=\"用户名\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          {user.username}\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => { setOpenUser(true); }}>\r\n        <ListItemText primary=\"详细信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button>\r\n        <ListItemText primary=\"修改信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => {\r\n        Config.clear();\r\n        setTimeout(() => { window.location.reload(); }, 500);\r\n      }}>\r\n        <ListItemText primary=\"退出当前账号\"></ListItemText>\r\n      </ListItem>\r\n      <ListSubheader>用户门店</ListSubheader>\r\n      <ListItem button onClick={() => { setOpenDaemon(true); }}>\r\n        <ListItemText primary=\"当前门店信息\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => { setOpenResetShop(true); }}>\r\n        <ListItemText primary=\"解绑当前门店\"></ListItemText>\r\n        <ListItemSecondaryAction><Typography variant=\"body1\" color=\"textSecondary\">{store.getState().daemon &&\r\n          store.getState().daemon.shop_info && store.getState().daemon.shop_info.branchName}</Typography></ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => { setOpenSelectShop(true); }}>\r\n        <ListItemText primary=\"管理/切换当前已绑定门店\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => { setOpenNewShop(true); }}>\r\n        <ListItemText primary=\"绑定并且切换到新的门店\"></ListItemText>\r\n      </ListItem>\r\n      <ListSubheader>外观</ListSubheader>\r\n      <ListItem>\r\n        <ListItemText primary=\"主题设置\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <FormControl>\r\n            {/* <InputLabel></InputLabel> */}\r\n            <Select value={themeName} onChange={e => {\r\n              setThemeName(e.target.value);\r\n              let c = store.getState().config;\r\n              c.data.theme_name = e.target.value;\r\n              c.theme = c.theme_avaliable[c.data.theme_name];\r\n              c.save();\r\n              store.dispatch(setConfig(c));\r\n              setTimeout(() => { window.location.reload(); }, 200);\r\n            }}>\r\n              {store.getState().config.data.theme_avaliable.map((v, k) => <MenuItem key={v} value={v}>{v}</MenuItem>)}\r\n            </Select>\r\n          </FormControl>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListSubheader>数据管理</ListSubheader>\r\n      <ListItem button onClick={() => {\r\n        funDownload(store.getState().config.save(), `团购杀手配置数据(${new Date().toLocaleString()}).json`);\r\n      }}>\r\n        <ListItemText primary=\"数据导出\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => {\r\n        // console.log(refConfigFileInput)\r\n        refConfigFileInput.current.click();\r\n      }}>\r\n        <ListItemText primary=\"数据导入\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <input type=\"file\" accept=\".json\" hidden name=\"file-gbk-data\" ref={refConfigFileInput} onChange={e => {\r\n            // console.log(e);\r\n            let files = e.target.files;\r\n            if (files.length === 0) {\r\n              store.dispatch(setMessage(\"未选择文件\"));\r\n              return;\r\n            }\r\n            try {\r\n              let file = files[0];\r\n              let reader = new FileReader();\r\n              reader.readAsText(file, 'UTF-8');\r\n              reader.onload = evt => {\r\n                const fileData = evt.target.result;\r\n                try {\r\n                  const js = JSON.parse(fileData);\r\n                  if (!js.version_frontend) {\r\n                    store.dispatch(setMessage(\"文件类型错误或者文件已经损坏\"));\r\n                    return;\r\n                  }\r\n                  if (js.version_frontend > store.getState().config.data.version_frontend) {\r\n                    store.dispatch(setMessage(`存档文件版本(${js.version_frontend}高于当前版本${store.getState().config.data.version_frontend})，请更新到最新版`));\r\n                    return;\r\n                  }\r\n                  let c = store.getState().config;\r\n                  c.data = js;\r\n                  store.dispatch(setConfig(c));\r\n                  store.dispatch(setMessage(\"数据导入完成\"));\r\n                } catch (e) {\r\n                  store.dispatch(setErrorInfo(e));\r\n                }\r\n              };\r\n            } catch (e) {\r\n              store.dispatch(setErrorInfo(e));\r\n            }\r\n          }}></input>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem>\r\n        <ListItemText primary=\"设置数据同步\"></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <Switch defaultChecked={store.getState().config.data.settings_async} onChange={e => {\r\n            let c = store.getState().config;\r\n            c.data.settings_async = e.target.checked;\r\n            c.save();\r\n            store.dispatch(setConfig(c));\r\n          }}></Switch>\r\n        </ListItemSecondaryAction>\r\n      </ListItem>\r\n      <ListItem button onClick={() => setResetSettingsOpen(true)}>\r\n        <ListItemText primary=\"回到默认设置\"></ListItemText>\r\n      </ListItem>\r\n      <ListItem button onClick={() => setDeleteDataOpen(true)}>\r\n        <ListItemText primary=\"删除所有数据\"></ListItemText>\r\n      </ListItem>\r\n    </List>\r\n    <ListInfo data={store.getState().user} open={openUser} keyNames={{\r\n      username: '用户名', nick: '昵称', phone: '用户手机号', profile: '详细信息', state: '用户状态', created_at: '创建于', updated_at: '更新于'\r\n    }} title=\"用户信息\" onClose={() => { setOpenUser(false); }}></ListInfo>\r\n    <ListInfo data={store.getState().daemon} open={openDaemon} keyNames={{\r\n      cookies: '远程登录凭据', shop_info: \"门店详细信息\", solution_id: \"解决方案编号\"\r\n    }} title=\"门店信息\" onClose={() => { setOpenDaemon(false); }}></ListInfo>\r\n    <Dialog open={resetSettingsOpen} onClose={() => setResetSettingsOpen(false)}>\r\n      <DialogTitle>\r\n        回到默认设置\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会清除所有设置数据，确认操作？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setResetSettingsOpen(false)}>取消</Button>\r\n        <Button onClick={() => {\r\n          resetSettings();\r\n          window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n    <Dialog open={deleteDataOpen} onClose={() => setDeleteDataOpen(false)}>\r\n      <DialogTitle>\r\n        删除所有数据\r\n      </DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会清除软件数据，确认操作？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => setDeleteDataOpen(false)}>取消</Button>\r\n        <Button onClick={() => {\r\n          resetSettings();\r\n          window.location.reload();\r\n        }}>确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n    <Dialog open={openResetShop} onClose={() => { setOpenResetShop(false); }}>\r\n      <DialogTitle>解绑当前门店</DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"body1\">此操作将会解除门店和<b>本网站</b>的数据绑定，需要<b>重新绑定</b>才能使用网站功能。是否继续？</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button onClick={() => { setOpenResetShop(false); }}>取消</Button>\r\n        <Button onClick={async () => {\r\n          // const resp2 = await api.request(\"remote_login\", \"GET\");\r\n          // console.log(resp2);\r\n          const resp = await api.request(\"remote_login\", \"DELETE\");\r\n          console.log('delete cookies:', resp);\r\n          if (resp.code !== 200) {\r\n            store.dispatch(setErrorInfo(`删除失败: ${resp.code}, ${resp.message}, ${resp.error}`));\r\n          } else {\r\n            window.location.reload();\r\n            // setOpenResetShop(false);\r\n          }\r\n        }} color=\"secondary\">确定</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n    <Dialog open={openSelectShop} onClose={() => { setOpenSelectShop(false); }}>\r\n      <DialogTitle>选择一家门店</DialogTitle>\r\n      <DialogContent>\r\n        <List>\r\n          <ListItem>\r\n            <Typography variant=\"body2\" color=\"textSecondary\">注意，切换门店之后原有门店计划将停止执行。</Typography>\r\n          </ListItem>\r\n          {store.getState().daemon.shops ?\r\n            Object.keys(store.getState().daemon.shops).map((v, k) => {\r\n              const d = store.getState().daemon.shops[v];\r\n              return <ListItem button key={v} onClick={async () => {\r\n                console.log('switching to', d);\r\n                if (!d.cookies) return;\r\n                await api.request('remote_login', \"POST\", { cookies: d.cookies });\r\n                setOpenSelectShop(false);\r\n              }}>\r\n                <Box style={{ display: 'flex', flexDirection: \"row\" }}>\r\n                  <Box style={{ display: 'flex', flexDirection: \"column\" }}>\r\n                    <Typography variant=\"body1\">{`${d.shopName} - ${d.branchName}`}</Typography>\r\n                    <Typography variant=\"body2\" color=\"textSecondary\">{`${d.shopId}`}</Typography>\r\n                  </Box>\r\n                </Box>\r\n                <ListItemSecondaryAction>\r\n                  <IconButton onClick={async () => {\r\n                    console.log('to delete:', d);\r\n                    await api.request(\"remote_login\", \"DELETE\", { shop_id: d.shopId });\r\n                    if (store.getState().daemon.shop_info && d.shopId === store.getState().daemon.shop_info.shopId) window.location.reload();\r\n                  }}>\r\n                    <DeleteIcon></DeleteIcon>\r\n                  </IconButton>\r\n                </ListItemSecondaryAction>\r\n              </ListItem>;\r\n            })\r\n            : <ListItem><ListItemText>无门店数据</ListItemText></ListItem>}\r\n        </List>\r\n      </DialogContent>\r\n    </Dialog>\r\n    <Dialog open={openNewShop} onClose={() => { setOpenNewShop(false); }}>\r\n      <DialogContent>\r\n        <RemoteLogin forceLogin onFinish={() => {\r\n          console.log('onFinish');\r\n          setTimeout(() => { window.location.reload(); }, 3000);\r\n        }}></RemoteLogin>\r\n      </DialogContent>\r\n    </Dialog>\r\n  </Container>)\r\n}\r\n\r\nexport default Settings;","import { Box, Button, Container, Divider, TextField, Typography, Zoom, Fade } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { api } from '../api/api';\r\nimport { setMessage, setUser } from '../data/action';\r\nimport store from '../data/store';\r\nimport { objectUpdate } from '../utils/utils';\r\n\r\n\r\nfunction LoginFrame(props) {\r\n  const [state, setInnerState] = React.useState({\r\n    username: \"\",\r\n    password: \"\",\r\n    captcha: \"\",\r\n    actionType: 'login'\r\n  });\r\n  const refUsername = React.useRef();\r\n  const refPassword = React.useRef();\r\n  const setState = (update) => setInnerState(objectUpdate(state, update));\r\n  // style={{ display: \"flex\", justifyContent: 'center', alignItems: \"center\", flexDirection: \"column\", }}\r\n  const actionLogin = state.actionType === 'login' ? true : false;\r\n  const handleAction = async () => {\r\n    // console.log('handle', actionLogin);\r\n    if (actionLogin) {\r\n      const res = await api.request('session', 'POST', {\r\n        username: state.username, password: state.password\r\n      });\r\n      console.log(res);\r\n      if (res.code !== 200) return;\r\n      // 获取user\r\n      const user = await api.request('user', 'GET');\r\n      if (user.code !== 200) return;\r\n      console.log('user', user.data.user);\r\n      store.dispatch(setUser(user.data.user));\r\n    } else {\r\n      // 注册，注册成功则跳转登录\r\n      const res = await api.request('user', 'POST', {\r\n        username: state.username, password: state.password\r\n      });\r\n      console.log(res);\r\n      if (res.code === 200) {\r\n        // 弹窗\r\n        store.dispatch(setMessage(\"注册成功\"));\r\n        setState({actionType: 'login'});\r\n      }\r\n    }\r\n  }\r\n\r\n  return (<Box>\r\n    <Typography variant=\"h4\">{actionLogin ? \"登录\" : \"注册\"}</Typography>\r\n    <br />\r\n    <Divider></Divider>\r\n    <br />\r\n    <TextField fullWidth ref={refUsername} label=\"用户名\" variant=\"outlined\" value={state.username} onChange={e => {\r\n      setState({ username: e.target.value });\r\n    }} onKeyDown={e => {\r\n      if (e.code === \"Enter\") {\r\n        refPassword.current.querySelector(\"input\").focus();\r\n      }\r\n    }} />\r\n    <br /><br />\r\n    <TextField fullWidth ref={refPassword} label=\"密码\" variant=\"outlined\" value={state.password} type=\"password\" onChange={e => {\r\n      setState({ password: e.target.value });\r\n    }} onKeyDown={e => {\r\n      if (e.code === \"Enter\") {\r\n        handleAction();\r\n      }\r\n    }} />\r\n    <Fade in={actionLogin} style={{ display: actionLogin ? \"block\" : \"none\" }} timeout={{ exit: 0, enter: 200 }}>\r\n      <Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"primary\" onClick={handleAction}>登录</Button>\r\n        </Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"secondary\" onClick={() => setState({ actionType: \"sign_in\" })}>注册</Button>\r\n        </Box>\r\n      </Box>\r\n    </Fade>\r\n    <Fade in={!actionLogin} style={{ display: !actionLogin ? \"block\" : \"none\" }} timeout={{ exit: 0, enter: 200 }}>\r\n      <Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" color=\"primary\" onClick={handleAction}>注册</Button>\r\n        </Box>\r\n        <Box>\r\n          <br></br>\r\n          <Button fullWidth variant=\"contained\" onClick={() => setState({ actionType: 'login' })}>返回登录</Button>\r\n        </Box>\r\n      </Box>\r\n    </Fade>\r\n  </Box >);\r\n}\r\n\r\nexport default function Login(props) {\r\n  return <Container maxWidth=\"sm\">\r\n    <LoginFrame></LoginFrame>\r\n  </Container>\r\n}","import React from \"react\"\r\nimport Container from '@material-ui/core/Container';\r\nimport { Button, MenuItem, FormControl, InputLabel, List, ListItem, ListItemSecondaryAction, ListItemText, Select, ListSubheader, Switch, Dialog, DialogTitle, DialogContent, Typography, DialogActions, FormControlLabel, Checkbox, Divider, Box, Grid, TextField, IconButton } from \"@material-ui/core\";\r\nimport { Table, TableBody, TableCell, TableRow } from \"@material-ui/core\";\r\nimport HelpOutlineIcon from '@material-ui/icons/HelpOutline';\r\nimport store from \"../data/store\";\r\nimport { setConfig, setErrorInfo, setMessage } from \"../data/action\";\r\nimport { api } from \"../api/api\";\r\n\r\nfunction Predicts(props) {\r\n  const [useSpan, setUseSpan] = React.useState(false);\r\n  const [openHelp, setOpenHelp] = React.useState(false);\r\n  const labels = ['小包最低价', '小包最高价', '中包最低价', '中包最高价', '大包最低价', '大包最高价'];\r\n  const labelShows = { '小包最低价': '小包(闲时)', '小包最高价': '小包(黄金时段)', '中包最低价': '中包(闲时)', '中包最高价': '中包(黄金时段)', '大包最低价': '大包(闲时)', '大包最高价': '大包(黄金时段)' };\r\n  const [predictsResult, setPredictsResult] = React.useState(null);\r\n  const defaultValues = [\r\n    ['66', '76'], ['76', '86'], ['86', '96'], ['96', '106'], ['116', '126'], ['126', '146']\r\n  ]\r\n  const labelsTemp = labels.map((v, k) => {\r\n    return { [v]: defaultValues[k] };\r\n  });\r\n  const labelValues = ((() => {\r\n    let temp = {};\r\n    for (const item of labelsTemp)\r\n      for (const k in item)\r\n        temp[k] = item[k];\r\n    return temp;\r\n  })());\r\n  // console.log(labelValues);\r\n  const [inputValues, setInputValues] = React.useState(labelValues);\r\n  const getTempValues = () => {\r\n    let tempValues = {};\r\n    for (const k in inputValues) tempValues[k] = inputValues[k];\r\n    return tempValues;\r\n  }\r\n\r\n  const items = labels.map((v, k) => {\r\n    return useSpan ?\r\n      <ListItem key={v}>\r\n        <ListItemText primary={labelShows[v]}></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <Box>\r\n            <TextField style={{ maxWidth: 40 }} inputProps={{ style: { textAlign: \"center\" } }} value={inputValues[v][0]} onChange={e => {\r\n              let tmp = getTempValues();\r\n              tmp[v][0] = e.target.value;\r\n              setInputValues(tmp);\r\n            }}></TextField>~\r\n            <TextField style={{ maxWidth: 40 }} inputProps={{ style: { textAlign: \"center\" } }} value={inputValues[v][1]} onChange={e => {\r\n              let tmp = getTempValues();\r\n              tmp[v][1] = e.target.value;\r\n              setInputValues(tmp);\r\n            }}></TextField>\r\n          </Box>\r\n        </ListItemSecondaryAction>\r\n      </ListItem> :\r\n      <ListItem key={v}>\r\n        <ListItemText primary={labelShows[v]}></ListItemText>\r\n        <ListItemSecondaryAction>\r\n          <TextField style={{ maxWidth: 90 }} inputProps={{ style: { textAlign: \"center\" } }} fullWidth value={inputValues[v][0]} onChange={e => {\r\n            let tmp = getTempValues();\r\n            tmp[v][0] = e.target.value;\r\n            setInputValues(tmp);\r\n          }}></TextField>\r\n        </ListItemSecondaryAction>\r\n      </ListItem >;\r\n  });\r\n  const content = <List>\r\n    {items}\r\n  </List>;\r\n  const handlePredicts = () => {\r\n    // 检查数据\r\n    let tempValues = getTempValues();\r\n    if (!useSpan)\r\n      for (const k in tempValues)\r\n        tempValues[k] = [tempValues[k][0],]\r\n    for (const k in tempValues) {\r\n      for (let i = 0; i < tempValues[k].length; i++) {\r\n        let val = null;\r\n        try {\r\n          val = parseFloat(tempValues[k][i]);\r\n        } catch (e) {\r\n          store.dispatch(setErrorInfo(`数值错误: ${tempValues[k][i]}, ${e}`));\r\n          return;\r\n        }\r\n        if (!val && val !== 0) {\r\n          store.dispatch(setErrorInfo(`数值错误: ${tempValues[k][i]}`));\r\n          return;\r\n        }\r\n        tempValues[k][i] = val;\r\n      }\r\n    }\r\n    console.log(JSON.stringify(tempValues));\r\n    // api.predicts(tempValues).then(d => {\r\n    //   console.log(d);\r\n    //   setPredictsResult(d.data);\r\n    // });\r\n    api.request(\"predicts\", 'POST', { predict_data: tempValues }).then(d => {\r\n      console.log(d);\r\n      setPredictsResult(d.data);\r\n    });\r\n  };\r\n  const result = !predictsResult ? null : <Table>\r\n    <TableBody>\r\n      {useSpan ? <TableRow>\r\n        <TableCell align=\"center\" colSpan={2}>预测曝光人数</TableCell>\r\n        <TableCell align=\"center\" colSpan={2}>预测访问人数</TableCell>\r\n        <TableCell align=\"center\" colSpan={2}>预测下单人数</TableCell>\r\n      </TableRow> : <TableRow>\r\n        <TableCell align=\"center\">预测曝光人数</TableCell>\r\n        <TableCell align=\"center\">预测访问人数</TableCell>\r\n        <TableCell align=\"center\">预测下单人数</TableCell>\r\n      </TableRow>}\r\n      {useSpan ? <TableRow>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['visible'][0])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['visible'][1])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['visit'][0])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['visit'][1])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['order'][0])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['order'][1])}</TableCell>\r\n      </TableRow> : <TableRow>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['visible'][0])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['visit'][0])}</TableCell>\r\n        <TableCell align=\"center\">{parseInt(predictsResult['order'][0])}</TableCell>\r\n      </TableRow>}\r\n    </TableBody>\r\n  </Table>;\r\n  return (<Container maxWidth=\"sm\">\r\n    <Typography variant=\"h4\">根据标准数据集预测</Typography>\r\n    <Box>\r\n      <FormControlLabel control={<Checkbox onChange={e => {\r\n        setUseSpan(e.target.checked);\r\n        setPredictsResult(null);\r\n      }} checked={useSpan} color=\"secondary\" />} label=\"使用数据区间\" />\r\n      <IconButton onClick={() => setOpenHelp(true)}>\r\n        <HelpOutlineIcon></HelpOutlineIcon>\r\n      </IconButton>\r\n    </Box>\r\n    <Divider></Divider>\r\n    {content}\r\n    <Button fullWidth variant=\"contained\" color=\"secondary\" onClick={handlePredicts}>预测</Button>\r\n    <Divider></Divider>\r\n    {result}\r\n    <Dialog open={openHelp} onClose={() => { setOpenHelp(false); }}>\r\n      <DialogTitle>帮助信息</DialogTitle>\r\n      <DialogContent>\r\n        <Typography variant=\"h6\">使用数据区间</Typography>\r\n        <Typography variant=\"body1\">使用数据区间可以输入数据上下限，并且预测出对应参数的上下限，帮助您更好地界定您的数据。</Typography>\r\n        <Typography variant=\"h6\">价格说明</Typography>\r\n        <Typography variant=\"body1\">“黄金时段”价格为节假日、夜间等适合高定价的时段，“闲时”为除此之外的时段。输入价格为不加入酒水等的基础价格。</Typography>\r\n        <Typography variant=\"h6\">预测结果说明</Typography>\r\n        <Typography variant=\"body1\">预测结果基于当前已有数据集数据，预测准确性不能百分百保证。更新数据集等功能将在后续版本上线。</Typography>\r\n      </DialogContent>\r\n      <DialogActions>\r\n        <Button color=\"primary\" onClick={() => { setOpenHelp(false); }}>了解</Button>\r\n      </DialogActions>\r\n    </Dialog>\r\n  </Container>)\r\n}\r\n\r\nexport default Predicts;","import { Box, Button, Container, Divider, TextField, Typography, Zoom, Fade, Avatar, List } from '@material-ui/core';\r\nimport React from 'react';\r\nimport { api } from '../api/api';\r\nimport { setMessage, setUser } from '../data/action';\r\nimport { makeStyles } from \"@material-ui/core/styles\";\r\nimport store from '../data/store';\r\nimport {\r\n  HashRouter as Router,\r\n  // BrowserRouter as Router,\r\n  Switch,\r\n  Route\r\n} from \"react-router-dom\";\r\nimport { isChinese, objectUpdate } from '../utils/utils';\r\nimport ListItemLink from '../components/ListItemLink';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  small: {\r\n    width: theme.spacing(3),\r\n    height: theme.spacing(3),\r\n  },\r\n  large: {\r\n    width: theme.spacing(7),\r\n    height: theme.spacing(7),\r\n  },\r\n}));\r\n\r\nexport default function User(props) {\r\n  const { onClose } = props;\r\n  const classes = useStyles();\r\n  const user = store.getState().user;\r\n  const nick = user.nick ? user.nick : user.username;\r\n  const nickHead = isChinese(nick[0]) ? null : `${nick}`.slice(0, 2);\r\n  return <Container maxWidth=\"sm\">\r\n    <Box style={{ display: 'flex', flexDirection: \"row\", minWidth: 90 }}>\r\n      <Box style={{ margin: 15 }}>\r\n        <Avatar alt={nick} className={classes.large}>{nickHead ? nickHead : nick[0]}</Avatar>\r\n      </Box>\r\n      <Box style={{ margin: 8 }}>\r\n        <Typography variant=\"h4\">{nick}</Typography>\r\n        {user.username ? <Typography variant=\"body1\">@{user.username}</Typography> : null}\r\n      </Box>\r\n      <Box style={{ margin: 10 }}>\r\n        <Typography variant=\"h5\">{`${store.getState().daemon.shop_info.shopName}`}</Typography>\r\n        <Typography variant=\"body1\" color=\"textSecondary\">{`${store.getState().daemon.shop_info.branchName}`}</Typography>\r\n      </Box>\r\n    </Box>\r\n    {/* <Button fullWidth color=\"primary\">跳转到设置</Button> */}\r\n    <Router>\r\n      <List>\r\n        <ListItemLink to=\"/settings\" primary=\"跳转到设置\" onClick={() => { onClose && onClose(); }} />\r\n      </List>\r\n    </Router>\r\n  </Container>;\r\n}","import React from 'react';\r\nimport { api } from './api/api';\r\n\r\nexport default class ErrorBoundary extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      error: null,\r\n      requesting: false,\r\n      requested: false,\r\n    };\r\n  }\r\n\r\n  componentDidCatch(error, info) {\r\n    this.setState({ error: { error, info }, requesting: true });\r\n    // logErrorToMyService(error, info);\r\n    console.error('catched error', error);\r\n    console.error('catched info', info);\r\n    api.request('error_report', 'POST', { error: { error, info } }).then(resp => {\r\n      this.setState({ requested: true });\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.state.error) {\r\n      const content = (this.state.requesting && !this.state.requested) ?\r\n        <div style={{ color: 'orange' }}>正在收集数据并且上报开发者...</div> :\r\n        <div style={{ color: 'green' }}>错误数据上报完成！<div>\r\n          {window.location.hash === '#/' ? null : <div><br />你可以选择：<a href=\"/\">回到主页</a></div>}\r\n        </div>\r\n        </div>;\r\n      return <div>\r\n        <b><h3>很抱歉</h3></b>\r\n        <p>页面崩溃了！</p>\r\n        <hr />\r\n        {content}\r\n        <p>对您造成的困扰我们表示抱歉，如果有其他需要解决的问题，请联系：</p>\r\n        <p>管理微信：<code>zhicheng1840</code> / 开发者邮箱：<a href=\"mailto:chiro2001@163.com\">chiro2001@163.com</a> / 开发者微信：chiro2001</p>\r\n        <hr></hr>\r\n        <p>详细错误：</p>\r\n        <code>{JSON.stringify(this.state.error)}</code>\r\n      </div>;\r\n    }\r\n    return this.props.children;\r\n  }\r\n}","import React from 'react';\r\nimport \"@fontsource/roboto\";\r\nimport clsx from 'clsx';\r\nimport Container from '@material-ui/core/Container';\r\nimport { makeStyles, useTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport List from '@material-ui/core/List';\r\nimport CssBaseline from '@material-ui/core/CssBaseline';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport MenuIcon from '@material-ui/icons/Menu';\r\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\r\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\r\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle';\r\nimport EqualizerIcon from '@material-ui/icons/Equalizer';\r\nimport DashboardIcon from '@material-ui/icons/Dashboard';\r\nimport AssignmentIcon from '@material-ui/icons/Assignment';\r\nimport AlarmIcon from '@material-ui/icons/Alarm';\r\nimport SettingsIcon from '@material-ui/icons/Settings';\r\nimport CloseIcon from '@material-ui/icons/Close';\r\nimport StorageIcon from '@material-ui/icons/Storage';\r\nimport VerifiedUserIcon from '@material-ui/icons/VerifiedUser';\r\nimport PhonelinkIcon from '@material-ui/icons/Phonelink';\r\nimport {\r\n  HashRouter as Router,\r\n  // BrowserRouter as Router,\r\n  Switch,\r\n  Route\r\n} from \"react-router-dom\";\r\nimport { TransitionGroup, CSSTransition } from \"react-transition-group\";\r\nimport { Provider } from 'react-redux'\r\nimport { MuiPickersUtilsProvider } from '@material-ui/pickers';\r\nimport MomentUtils from '@date-io/moment';\r\nimport moment from 'moment';\r\nimport 'moment/locale/zh-cn';\r\nimport store from './data/store';\r\nimport { setConfig, setDaemon, setErrorInfo, setMessage, setReserveTableData, setRoomStockData, setShopInfo } from \"./data/action\";\r\n\r\nimport { isIterator, isMobileDevice, sleep } from \"./utils/utils\";\r\nimport { api } from \"./api/api\";\r\n\r\nimport ListItemLink from \"./components/ListItemLink\";\r\nimport Launch from \"./pages/Launch\";\r\nimport Settings from \"./pages/Settings\";\r\nimport './App.css';\r\nimport { Box, Button, Dialog, DialogActions, DialogContent, DialogTitle, ListItem, Snackbar } from '@material-ui/core';\r\nimport RemoteLogin from './pages/RemoteLogin';\r\nimport Login from './pages/Login';\r\nimport Tasks from \"./pages/Tasks\";\r\nimport Predicts from './pages/Predicts';\r\nimport User from './pages/User';\r\nimport ErrorBoundary from './ErrorBondary';\r\n\r\nconst drawerWidth = 240;\r\nmoment.locale('zh-cn');\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    display: 'flex',\r\n    width: '100%',\r\n    // overflowX: 'auto',\r\n  },\r\n  appBar: {\r\n    zIndex: theme.zIndex.drawer + 1,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n  },\r\n  title: {\r\n    flexGrow: 1\r\n  },\r\n  appBarShift: {\r\n    marginLeft: drawerWidth,\r\n    width: `calc(100% - ${drawerWidth}px)`,\r\n    transition: theme.transitions.create(['width', 'margin'], {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  menuButton: {\r\n    marginRight: 36,\r\n  },\r\n  hide: {\r\n    display: 'none',\r\n  },\r\n  drawer: {\r\n    width: drawerWidth,\r\n    flexShrink: 0,\r\n    whiteSpace: 'nowrap',\r\n  },\r\n  drawerOpen: {\r\n    width: drawerWidth,\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.enteringScreen,\r\n    }),\r\n  },\r\n  drawerClose: {\r\n    transition: theme.transitions.create('width', {\r\n      easing: theme.transitions.easing.sharp,\r\n      duration: theme.transitions.duration.leavingScreen,\r\n    }),\r\n    overflowX: 'hidden',\r\n    width: theme.spacing(7) + 1,\r\n    [theme.breakpoints.up('sm')]: {\r\n      width: theme.spacing(9),\r\n    },\r\n  },\r\n  toolbar: {\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    justifyContent: 'flex-end',\r\n    padding: theme.spacing(0, 1),\r\n    // necessary for content to be below app bar\r\n    ...theme.mixins.toolbar,\r\n  },\r\n  content: {\r\n    flexGrow: 1,\r\n    padding: theme.spacing(3),\r\n    width: '100%',\r\n    overflowX: 'auto',\r\n  },\r\n}));\r\n\r\n// const api = new API();\r\n// const authApi = new AuthAPI();\r\n// api.get_shop_info().then(shopInfo => {\r\n//   console.log('shopInfo', shopInfo);\r\n//   if (shopInfo) store.dispatch(setShopInfo(shopInfo));\r\n// }).catch(e => {\r\n//   store.dispatch(setErrorInfo(e));\r\n// })\r\n\r\nlet subscribers = {};\r\n\r\nlet last_data = {\r\n  config: null,\r\n  user: null,\r\n  daemon: null\r\n};\r\n\r\nstore.subscribe(async () => {\r\n  let state = store.getState();\r\n  // console.log('redux update to', state);\r\n  // 保存 config\r\n  if (state.config.data) {\r\n    if (JSON.stringify(state.config.data) !== JSON.stringify(last_data.config)) {\r\n      // console.log('Config will change:', state.config.data);\r\n      state.config.save();\r\n      if (store.getState().user && store.getState().config.data.settings_async) {\r\n        await api.request('sync', 'POST', { config: state.config.data });\r\n      }\r\n    } else {\r\n      // console.log('Not change:', state.config.data);\r\n    }\r\n    last_data.config = state.config.data;\r\n  }\r\n  for (let subFunc in subscribers) {\r\n    subscribers[subFunc](state);\r\n  }\r\n});\r\n\r\nconst getShopTitle = function () {\r\n  if (!(store.getState().daemon && store.getState().daemon.shop_info && store.getState().daemon.shop_info.shopName)) return null;\r\n  // console.log('getShopTitle', store.getState().daemon.shop_info);\r\n  const title = `${store.getState().daemon.shop_info.shopName} - ${store.getState().daemon.shop_info.branchName}`;\r\n  // console.log(title);\r\n  return title;\r\n}\r\n\r\nexport default function App() {\r\n  const classes = useStyles();\r\n  const theme = useTheme();\r\n  const [open, setOpen] = React.useState(false);\r\n  const [errorDialogInfo, setErrorDialogInfo] = React.useState(false);\r\n  const [myMessage, setMyMessage] = React.useState(null);\r\n  const [hasLogin, setHasLogin] = React.useState(false);\r\n  const titleDefault = \"团购杀手 - KTV体验版\";\r\n  const [title, setTitle] = React.useState(getShopTitle() || titleDefault);\r\n  const [ignored, forceUpdate] = React.useReducer(x => x + 1, 0);\r\n  const [requestingRemote, setRequesingRemote] = React.useState(false);\r\n  const [openUser, setOpenUser] = React.useState(false);\r\n\r\n  // 拉大到800会打开，拉小到600关闭\r\n  const triggerWidthOpen = 800;\r\n  const triggerWidthClose = 600;\r\n\r\n  // 注册一个当遇到错误的时候调用的钩子吧，用来显示错误信息\r\n  subscribers['Error'] = function (state) {\r\n    if (state.errorInfo) {\r\n      console.log('Error Hook: ', state.errorInfo);\r\n      setErrorDialogInfo(state.errorInfo);\r\n      // 清空错误信息\r\n      store.dispatch(setErrorInfo(null));\r\n    }\r\n  };\r\n  // 注册一个消息钩子\r\n  subscribers['Message'] = function (state) {\r\n    if (state.message) {\r\n      console.log('message: ', state.message);\r\n      setMyMessage(state.message);\r\n      store.dispatch(setMessage(null));\r\n    }\r\n  };\r\n  subscribers['User'] = async function (state) {\r\n    if (state.user) {\r\n      if (JSON.stringify(state.user) != JSON.stringify(last_data.user)) {\r\n        forceUpdate();\r\n        // 登录信息完成，触发获取daemon\r\n        // if (!last_data.user) \r\n        if (!last_data.user) {\r\n          // store.dispatch(setDaemon(false));\r\n          // console.log('trigger');\r\n        }\r\n      }\r\n      last_data.user = state.user;\r\n    }\r\n  };\r\n  subscribers['Daemon'] = async function (state) {\r\n    if (state.daemon) {\r\n      if (JSON.stringify(state.daemon) != JSON.stringify(last_data.daemon)) {\r\n        forceUpdate();\r\n      }\r\n      last_data.daemon = state.daemon;\r\n      if (state.daemon.shop_info) {\r\n        if (title === titleDefault) {\r\n          setTitle(getShopTitle());\r\n        }\r\n      }\r\n    }\r\n    // if (state.daemon === false) {\r\n    //   store.dispatch(setDaemon(null));\r\n    //   const daemon = await api.request('daemon', 'GET');\r\n    //   if (daemon.code === 200 && daemon.data.uid) {\r\n    //     store.dispatch(setDaemon(daemon.data));\r\n    //   } else store.dispatch(setDaemon(null));\r\n    // }\r\n  };\r\n  // onMount & onUpdate\r\n  React.useEffect(() => {\r\n    const onWindowResize = () => {\r\n      let width = window.innerWidth;\r\n      // console.log(width);\r\n      if (!open && width >= triggerWidthOpen) setOpen(true);\r\n      if (open && width <= triggerWidthClose) setOpen(false);\r\n    };\r\n    window.addEventListener(\"load\", onWindowResize);\r\n    window.addEventListener('resize', onWindowResize);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"load\", onWindowResize);\r\n      window.removeEventListener(\"resize\", onWindowResize);\r\n    };\r\n  });\r\n\r\n\r\n  const handleClickAction = () => {\r\n    if (window.innerWidth < 600 || window.location.pathname === '/') {\r\n      setOpen(false);\r\n    }\r\n  };\r\n\r\n  const mainContent = <Router>\r\n    <MuiPickersUtilsProvider utils={MomentUtils} locale=\"zh-cn\">\r\n      <CssBaseline />\r\n      <AppBar\r\n        position=\"fixed\"\r\n        className={clsx(classes.appBar, {\r\n          [classes.appBarShift]: open,\r\n        })}\r\n      >\r\n        <Toolbar>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            aria-label=\"open drawer\"\r\n            onClick={() => { setOpen(true); }}\r\n            edge=\"start\"\r\n            className={clsx(classes.menuButton, {\r\n              [classes.hide]: open,\r\n            })}\r\n          >\r\n            <MenuIcon />\r\n          </IconButton>\r\n          <Typography variant=\"h6\" noWrap className={classes.title}>\r\n            {title}\r\n          </Typography>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            onClick={() => { setOpenUser(true); }}\r\n          >\r\n            <AccountCircleIcon />\r\n          </IconButton>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <Drawer\r\n        variant=\"permanent\"\r\n        className={clsx(classes.drawer, {\r\n          [classes.drawerOpen]: open,\r\n          [classes.drawerClose]: !open,\r\n        })}\r\n        classes={{\r\n          paper: clsx({\r\n            [classes.drawerOpen]: open,\r\n            [classes.drawerClose]: !open,\r\n          }),\r\n        }}\r\n      >\r\n        <div className={classes.toolbar}>\r\n          <IconButton onClick={() => { setOpen(false); }}>\r\n            {theme.direction === 'rtl' ? <ChevronRightIcon /> : <ChevronLeftIcon />}\r\n          </IconButton>\r\n        </div>\r\n        <Divider />\r\n        <List onClick={handleClickAction}>\r\n          <ListItemLink to=\"/\" primary=\"启动页\" icon={<DashboardIcon />} />\r\n          <ListItemLink to=\"/tasks\" primary=\"任务\" icon={<AssignmentIcon />} />\r\n          <ListItemLink to=\"/predicts\" primary=\"智能预测\" icon={<EqualizerIcon />} />\r\n          <ListItemLink to=\"/settings\" primary=\"设置\" icon={<SettingsIcon />} />\r\n        </List>\r\n      </Drawer>\r\n      <main className={classes.content}>\r\n        <div className={classes.toolbar} />\r\n        <Switch>\r\n          <Route path={\"/\"} exact={true}>\r\n            <Launch />\r\n          </Route>\r\n          <Route path={\"/tasks\"} exact={true}>\r\n            <Tasks />\r\n          </Route>\r\n          <Route path={\"/predicts\"} exact={true}>\r\n            <Predicts />\r\n          </Route>\r\n          <Route path={\"/settings\"} exact={false}>\r\n            <Settings />\r\n          </Route>\r\n        </Switch>\r\n      </main>\r\n    </MuiPickersUtilsProvider>\r\n  </Router>;\r\n\r\n  const user = store.getState().user;\r\n  const isNowLogining = !user && store.getState().config.data.api_token.access_token;\r\n  let content = isNowLogining ? <Box>正在登录...</Box> : (user ? mainContent : <Login></Login>);\r\n  if ((!isNowLogining && user) && !store.getState().daemon) {\r\n    content = <Typography variant=\"body1\">获取账户信息...</Typography>;\r\n    if (!requestingRemote) {\r\n      setRequesingRemote(true);\r\n      const daemon = api.request('remote_login', 'GET').then(daemon => {\r\n        if (daemon.code === 200 && daemon.data.uid) {\r\n          store.dispatch(setDaemon(daemon.data));\r\n        } else if (daemon.code === 200 && !daemon.data.uid) {\r\n          store.dispatch(setDaemon({}));\r\n        }\r\n      });\r\n    }\r\n  } else if ((!isNowLogining && user) && store.getState().daemon && !store.getState().daemon.uid) {\r\n    content = <RemoteLogin></RemoteLogin>\r\n  }\r\n  // console.log('app.js user', user, 'content', content);\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <ErrorBoundary>\r\n        <ThemeProvider theme={store.getState().config.theme}>\r\n          {content}\r\n          <Dialog fullWidth open={openUser} onClose={() => { setOpenUser(false); }}>\r\n            <DialogContent>\r\n              <User onClose={() => { setOpenUser(false); }}></User>\r\n            </DialogContent>\r\n          </Dialog>\r\n          <Dialog open={errorDialogInfo ? true : false} onClose={() => { setErrorDialogInfo(null); }}>\r\n            <DialogTitle>遇到错误</DialogTitle>\r\n            <DialogContent>\r\n              <Typography variant=\"body1\">错误信息</Typography>\r\n              <Box component=\"div\">\r\n                <Box component=\"div\">\r\n                  {() => {\r\n                    if (isIterator(errorDialogInfo) && typeof (errorDialogInfo) !== 'string') {\r\n                      return <List>\r\n                        {errorDialogInfo.map((d, i) => <ListItem key={d}>\r\n                          <code>{JSON.stringify(d) === '{}' ? d.toString() : JSON.stringify(d)}</code>\r\n                        </ListItem>)}\r\n                      </List>;\r\n                    } else {\r\n                      return <code>{JSON.stringify(errorDialogInfo) === '{}' ? errorDialogInfo.toString() : JSON.stringify(errorDialogInfo)}</code>;\r\n                    }\r\n                  }}\r\n                </Box>\r\n              </Box>\r\n            </DialogContent>\r\n            <DialogActions>\r\n              <Button color=\"primary\" onClick={() => { window.location.reload() }}>刷新</Button>\r\n              <Button color=\"primary\" onClick={() => { setErrorDialogInfo(null); }}>取消</Button>\r\n            </DialogActions>\r\n          </Dialog>\r\n          <Snackbar\r\n            anchorOrigin={{\r\n              vertical: 'bottom',\r\n              horizontal: 'right',\r\n            }}\r\n            open={myMessage !== null}\r\n            autoHideDuration={3000}\r\n            // onClose={(e) => { console.log(e); }}\r\n            message={myMessage}\r\n            action={\r\n              <React.Fragment>\r\n                <IconButton size=\"small\" aria-label=\"close\" color=\"inherit\" onClick={() => setMyMessage(null)}>\r\n                  <CloseIcon fontSize=\"small\" />\r\n                </IconButton>\r\n              </React.Fragment>\r\n            }\r\n          />\r\n        </ThemeProvider>\r\n      </ErrorBoundary>\r\n    </div >\r\n  );\r\n}\r\n","const reportWebVitals = onPerfEntry => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport store from './data/store';\r\nimport { Provider } from 'react-redux';\r\nimport { api } from './api/api';\r\nimport { setConfig, setDaemon, setErrorInfo, setRoomStockPlans, setTimetableNodes, setTimetablePeriods, setUser } from './data/action';\r\nimport { sleep } from './utils/utils';\r\n\r\n// 循环执行函数\r\nasync function cycleFunc(cycle = 1000) {\r\n  while (true) {\r\n    try {\r\n\r\n    } catch (e) {\r\n      console.error(e);\r\n    }\r\n    await sleep(cycle);\r\n  }\r\n}\r\n\r\n// 开始执行的函数\r\nasync function startFunc() {\r\n  setTimeout(async () => {\r\n    const user = store.getState().user;\r\n    const isNowLogining = !user && store.getState().config.data.api_token.access_token;\r\n    if (isNowLogining) {\r\n      api.load_from_config();\r\n      const res = await api.request('user', 'GET');\r\n      // console.log('index res', res)\r\n      if (res.code === 200) {\r\n        // console.log('saving user', res.data.user)\r\n        store.dispatch(setUser(res.data.user));\r\n        const daemon = await api.request('daemon', 'GET');\r\n        if (daemon.code === 200 && daemon.data.uid) {\r\n          store.dispatch(setDaemon(daemon.data));\r\n        } else store.dispatch(setDaemon(null));\r\n      }\r\n    }\r\n    // let c = api.download_config();\r\n    // if (!c.settings_async) return;\r\n    // const config_frontend = await api.download_config();\r\n    // if (!config_frontend) {\r\n    //   store.dispatch(setErrorInfo(\"同步设置失败\"));\r\n    // }\r\n    // else store.dispatch(setConfig(config_frontend));\r\n  }, 0);\r\n}\r\n\r\nReactDOM.render(\r\n  // <React.StrictMode>\r\n  <Provider store={store}>\r\n    <App />\r\n  </Provider>,\r\n  // </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\nstartFunc().then(() => {\r\n  cycleFunc();\r\n});\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}